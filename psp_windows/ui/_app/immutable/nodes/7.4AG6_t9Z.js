import{l as le,b as re,i as D}from"../chunks/woX702LQ.js";import{e as q,g as J,h as f,p as Q,s as ne,a as oe,z as Y,d as K,f as g,b as r,c as a,r as e,j as Z,A as R,i as u,t as O,k as i,l as ce,u as U}from"../chunks/B9aKyTE9.js";import{I as ie,b as de,L as ve,e as F,M as N,f as V,A as X,h as pe,j as ue,g as fe,k as _e,l as me,T as xe,m as be,c as ge,P as he}from"../chunks/FTlQNedl.js";import{c as ye,b as Se}from"../chunks/DPqr1Em3.js";import{g as we}from"../chunks/B7z-6CDi.js";function Pe(S,n){const t=le(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}],["circle",{cx:"9",cy:"7",r:"4"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}]];ie(S,re({name:"users"},()=>t,{get iconNode(){return E},children:(h,k)=>{var w=q(),v=J(w);de(v,n,"default",{},null),f(h,w)},$$slots:{default:!0}}))}var je=g('<div class="flex w-full"><span class="grow font-bold">World Name</span> <span class="font-bold">Players</span></div>'),$e=g('<div class="flex w-full items-center"><span class="grow"> </span> <div class="flex items-center space-x-2"><!> <span> </span></div></div>'),Ee=g('<div class="flex flex-col"><span class="font-bold"> </span> <span> </span> <span> </span></div>'),Ae=g('<div class="flex flex-col space-y-4"><h2 class="h2">Available Saves</h2> <!></div>');function Ie(S,n){Q(n,!0);let t=ne(oe([]));async function E(v){console.log("handleSelectSave",v),F(N.SELECT_GAMEPASS_SAVE,v.save_id)}Y(()=>{K(t,Object.values(n.saves),!0)});var h=Ae(),k=r(a(h),2);{var w=v=>{ve(v,{baseClass:"bg-surface-800 max-h-64 2xl:max-h-[500px]",idKey:"save_id",canSelect:!1,headerClass:"",onselect:E,get items(){return u(t)},set items(_){K(t,_,!0)},listHeader:_=>{var o=je();f(_,o)},listItem:(_,o=R)=>{var p=$e(),d=a(p),P=a(d,!0);e(d);var x=r(d,2),j=a(x);Pe(j,{size:16});var y=r(j,2),s=a(y,!0);e(y),e(x),e(p),O(()=>{i(P,o().world_name),i(s,o().player_count)}),f(_,p)},listItemPopup:(_,o=R)=>{var p=Ee(),d=a(p),P=a(d,!0);e(d);var x=r(d,2),j=a(x);e(x);var y=r(x,2),s=a(y);e(y),e(p),O(()=>{i(P,o().world_name),i(j,`Save ID: ${o().save_id??""}`),i(s,`Players: ${o().player_count??""}`)}),f(_,p)},$$slots:{listHeader:!0,listItem:!0,listItemPopup:!0}})};D(k,v=>{n.saves&&Object.keys(n.saves).length>0&&v(w)})}e(h),f(S,h),Z()}var Me=(S,n,t)=>!u(n).disabled&&t(u(n).type),Oe=g('<button type="button"><div class="flex flex-col items-center gap-2"><div class="bg-surface-900 mb-2 flex h-24 w-24 items-center justify-center rounded-full p-4 shadow"><!></div> <span class="text-xl font-semibold text-white"> </span> <p class="text-surface-300 text-center text-base"> </p></div></button>'),ke=g('<div class="grid grid-cols-[auto_1fr] gap-2"><span class="font-bold">Players:</span> <span class="text-end"> </span> <span class="font-bold">Pals:</span> <span class="text-end"> </span> <span class="font-bold">Guilds:</span> <span class="text-end"> </span> <span class="font-bold">Bases:</span> <span class="text-end"> </span></div>'),Le=g('<div class="flex flex-col space-y-2"><div class="flex justify-center"><button class="btn hover:text-secondary-500 h4"> </button></div> <!></div>'),Te=g('<div class="bg-surface-900 flex min-h-screen w-full flex-col items-center justify-center py-12"><div class="flex w-full max-w-3xl flex-col gap-12"><section class="w-full"><h1 class="text-primary-400 mb-6 text-center text-4xl font-extrabold tracking-tight">Select Save Platform</h1> <div class="grid w-full grid-cols-1 justify-center gap-8 sm:grid-cols-2"></div></section> <!></div></div>');function He(S,n){Q(n,!0);const t=fe(),E=me(),h=he==="true",k=V.loadSvg(`${X}/img/app/steam.svg`),w=V.loadSvg(`${X}/img/app/xbox.svg`),v=U(()=>Object.values(t.players).reduce((s,l)=>s+(l.pals?Object.values(l.pals).length:0),0)),G=U(()=>Object.values(t.guilds).reduce((s,l)=>s+(l.bases?Object.values(l.bases).length:0),0));async function H(s){await we("/loading"),F(N.SELECT_SAVE,{type:s,local:h})}Y(()=>{});const W=[{type:"steam",title:"Steam",icon:k,description:"Steam/Mac: Level.sav save file",disabled:!1},{type:"gamepass",title:"Xbox Game Pass",icon:w,description:"Xbox Game Pass: container.index file",disabled:!1}];async function _(){const s=await E.showModal(xe,{title:"Edit World Name",value:t.saveFile.world_name});s&&(t.saveFile.world_name=s,F(N.RENAME_WORLD,s))}var o=Te(),p=a(o),d=a(p),P=r(a(d),2);pe(P,21,()=>W,ue,(s,l)=>{var c=Oe();c.__click=[Me,l,H];var b=a(c),m=a(b),A=a(m);be(A,()=>u(l).icon),e(m);var I=r(m,2),z=a(I,!0);e(I);var $=r(I,2),M=a($,!0);e($),e(b),e(c),O(L=>{Se(c,1,L),c.disabled=u(l).disabled,i(z,u(l).title),i(M,u(l).description)},[()=>ye(ge("bg-surface-800 flex flex-col items-center justify-between rounded-xl border-2 p-8 shadow-md transition-all",u(l).disabled?"border-surface-700 cursor-not-allowed opacity-50":"hover:border-primary-500 border-surface-700 cursor-pointer"))]),f(s,c)}),e(P),e(d);var x=r(d,2);{var j=s=>{var l=Le(),c=a(l),b=a(c);b.__click=_;var m=a(b,!0);e(b),e(c);var A=r(c,2);_e(A,{class:"min-w-96",children:(I,z)=>{var $=ke(),M=r(a($),2),L=a(M,!0);e(M);var T=r(M,4),ee=a(T,!0);e(T);var C=r(T,4),ae=a(C,!0);e(C);var B=r(C,4),se=a(B,!0);e(B),e($),O(te=>{i(L,t.playerSaveFiles.length),i(ee,u(v)),i(ae,te),i(se,u(G))},[()=>Object.values(t.guilds).length]),f(I,$)},$$slots:{default:!0}}),e(l),O(()=>i(m,t.saveFile.world_name)),f(s,l)},y=s=>{var l=q(),c=J(l);{var b=m=>{Ie(m,{get saves(){return t.gamepassSaves},set saves(A){t.gamepassSaves=A}})};D(c,m=>{t.gamepassSaves&&Object.keys(t.gamepassSaves).length>0&&m(b)},!0)}f(s,l)};D(x,s=>{t.saveFile&&t.playerSaveFiles?s(j):s(y,!1)})}e(p),e(o),f(S,o),Z()}ce(["click"]);export{He as component};
