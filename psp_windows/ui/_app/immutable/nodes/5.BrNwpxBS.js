import{l as $a,b as xa,p as Za,i as le,r as hl,c as at}from"../chunks/woX702LQ.js";import{e as Ne,g as Z,h as s,f as n,c as a,r as t,t as q,k as ne,b as l,p as ga,z as zt,d,i as e,s as Be,j as ha,a as Mt,J as rs,ar as os,u as m,ap as Al,M as va,n as Qt,A as Aa,l as Ga,aa as Fa,H as ns,as as ja,ah as ma}from"../chunks/B9aKyTE9.js";import{b as st,s as B,d as Xa,a as yl,A as Jt,c as pt}from"../chunks/DPqr1Em3.js";import{I as Pa,b as ka,ap as is,s as he,al as Ta,U as bl,h as Et,j as Nt,aq as Qa,E as xt,e as Ht,M as Gt,ar as cs,k as Ua,a as nl,O as ia,f as sa,B as ds,K as ba,N as qa,g as Sa,A as ca,as as Il,at as vl,V as za,t as Na,au as el,X as tl,l as Oa,Y as Ka,H as vs,J as ul,c as Bt,aj as pl,av as us,S as Da,aw as Kl,q as W,ax as Fl,ay as Hl,az as ml,aA as _s,ag as Gl,a5 as cl,aB as fl,w as da,aC as ps,T as $l,aD as fs,aE as ms,aF as gs,aG as hs,aH as ya,aI as ys,aJ as bs,a8 as $s,aK as xs,aL as Ps,aM as ks,aN as ws,aO as Cs,aP as Ss,aQ as Rl,aR as Is,aS as il,aT as xl,ac as Pl,aU as Ha,aV as Ll,aW as Es,aX as al,a0 as Dl,C as As,W as Ml,ab as kl,_ as wl,aY as Cl,aZ as gl,a_ as Ls,a$ as El,L as Vl,b0 as Ds,Q as _l,b1 as Wl,b2 as Xl,i as Ms,F as js,y as Os,a1 as Ts}from"../chunks/FTlQNedl.js";import{g as Zl}from"../chunks/B7z-6CDi.js";import{b as es}from"../chunks/aaggoT9b.js";import{T as la}from"../chunks/B9qQQCBg.js";import{U as dl,S as jl,A as ll,c as Ol,a as sl,b as Tl,d as rl}from"../chunks/CF87TII9.js";import{I as Bl,t as Ya}from"../chunks/DORw01e3.js";import{b as Ba}from"../chunks/CHBWxhb-.js";import{N as ts}from"../chunks/BVdvzYUS.js";import{R as Bs}from"../chunks/nvkXWzLC.js";function zs(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"}]];Pa(u,xa({name:"activity"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function as(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M10 10H6"}],["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.28a1 1 0 0 0-.684-.948l-1.923-.641a1 1 0 0 1-.578-.502l-1.539-3.076A1 1 0 0 0 16.382 8H14"}],["path",{d:"M8 8v4"}],["path",{d:"M9 18h6"}],["circle",{cx:"17",cy:"18",r:"2"}],["circle",{cx:"7",cy:"18",r:"2"}]];Pa(u,xa({name:"ambulance"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function zl(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"m3 16 4 4 4-4"}],["path",{d:"M7 20V4"}],["path",{d:"M11 4h4"}],["path",{d:"M11 8h7"}],["path",{d:"M11 12h10"}]];Pa(u,xa({name:"arrow-down-narrow-wide"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function Ns(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"m3 8 4-4 4 4"}],["path",{d:"M7 4v16"}],["rect",{x:"15",y:"4",width:"4",height:"6",ry:"2"}],["path",{d:"M17 20v-6h-2"}],["path",{d:"M15 20h4"}]];Pa(u,xa({name:"arrow-up-0-1"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function ls(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M10 10.01h.01"}],["path",{d:"M10 14.01h.01"}],["path",{d:"M14 10.01h.01"}],["path",{d:"M14 14.01h.01"}],["path",{d:"M18 6v11.5"}],["path",{d:"M6 6v12"}],["rect",{x:"2",y:"6",width:"20",height:"12",rx:"2"}]];Pa(u,xa({name:"bandage"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function Us(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["circle",{cx:"11",cy:"13",r:"9"}],["path",{d:"M14.35 4.65 16.3 2.7a2.41 2.41 0 0 1 3.4 0l1.6 1.6a2.4 2.4 0 0 1 0 3.4l-1.95 1.95"}],["path",{d:"m22 2-1.5 1.5"}]];Pa(u,xa({name:"bomb"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function Nl(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M12 2a10 10 0 0 1 7.38 16.75"}],["path",{d:"M12 8v8"}],["path",{d:"M16 12H8"}],["path",{d:"M2.5 8.875a10 10 0 0 0-.5 3"}],["path",{d:"M2.83 16a10 10 0 0 0 2.43 3.4"}],["path",{d:"M4.636 5.235a10 10 0 0 1 .891-.857"}],["path",{d:"M8.644 21.42a10 10 0 0 0 7.631-.38"}]];Pa(u,xa({name:"circle-fading-plus"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function Ul(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M7 2h10"}],["path",{d:"M5 6h14"}],["rect",{width:"18",height:"12",x:"3",y:"10",rx:"2"}]];Pa(u,xa({name:"gallery-vertical-end"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function qs(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4"}],["path",{d:"m21 2-9.6 9.6"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5"}]];Pa(u,xa({name:"key"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function Ks(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["circle",{cx:"11",cy:"4",r:"2"}],["circle",{cx:"18",cy:"8",r:"2"}],["circle",{cx:"20",cy:"16",r:"2"}],["path",{d:"M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z"}]];Pa(u,xa({name:"paw-print"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function Fs(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"m12 14-1 1"}],["path",{d:"m13.75 18.25-1.25 1.42"}],["path",{d:"M17.775 5.654a15.68 15.68 0 0 0-12.121 12.12"}],["path",{d:"M18.8 9.3a1 1 0 0 0 2.1 7.7"}],["path",{d:"M21.964 20.732a1 1 0 0 1-1.232 1.232l-18-5a1 1 0 0 1-.695-1.232A19.68 19.68 0 0 1 15.732 2.037a1 1 0 0 1 1.232.695z"}]];Pa(u,xa({name:"pizza"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}function Hs(u,r){const o=$a(r,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];Pa(u,xa({name:"swords"},()=>o,{get iconNode(){return _},children:(M,g)=>{var i=Ne(),L=Z(i);ka(L,r,"default",{},null),s(M,i)},$$slots:{default:!0}}))}var Gs=n('<div><span class="px-2 text-xs font-bold 2xl:text-base"> </span></div>');function Ma(u,r){let o=Za(r,"baseClass",3,"");var _=Gs(),M=a(_),g=a(M,!0);t(M),t(_),q(()=>{st(_,1,`border-b-surface-800 2xl:border-l-surface-800 border-b-2 2xl:border-b-0 2xl:border-l-2 ${o()??""}`),ne(g,r.text)}),s(u,_)}var Rs=n('<div class="flex gap-1"><span> </span> <kbd class="kbd kbd-xs hidden items-center text-center text-xs 2xl:flex"> </kbd></div>');function Wa(u,r){var o=Rs(),_=a(o),M=a(_,!0);t(_);var g=l(_,2),i=a(g,!0);t(g),t(o),q(()=>{ne(M,r.text),ne(i,r.key)}),s(u,o)}var Vs=n('<div class="flex flex-col space-y-2"><div class="border-l-primary border-l-surface-600 bg-surface-900 relative w-full overflow-hidden rounded-none border-l-2 p-0 shadow-none"><div class="flex w-full items-center"><img alt="HP" class="mx-2 h-6 w-6"/> <div class="ml-2 h-6 w-6"></div> <span class="grow p-2 text-lg">Attack</span> <span class="p-2 text-lg font-bold"> </span></div></div> <div class="border-l-primary border-l-surface-600 bg-surface-900 relative w-full overflow-hidden rounded-none border-l-2 p-0 shadow-none"><div class="flex w-full items-center"><img alt="HP" class="mx-2 h-6 w-6"/> <div class="ml-2 h-6 w-6"></div> <span class="grow p-2 pl-2 text-lg">Defense</span> <span class="p-2 text-lg font-bold"> </span></div></div> <div class="border-l-primary border-l-surface-600 bg-surface-900 relative w-full overflow-hidden rounded-none border-l-2 p-0 shadow-none"><div class="flex w-full items-center"><img alt="HP" class="mx-2 h-6 w-6"/> <div class="ml-2 h-6 w-6"></div> <span class="grow p-2 pl-2 text-lg">Work Speed</span> <span class="p-2 text-lg font-bold"> </span></div></div></div>');function Ql(u,r){ga(r,!0);let o=Be(void 0);zt(()=>{r.pal&&r.player&&d(o,is(r.pal,r.player),!0)});var _=Vs(),M=a(_),g=a(M),i=a(g),L=l(i,6),V=a(L,!0);t(L),t(g),t(M);var v=l(M,2),se=a(v),A=a(se),Q=l(A,6),ae=a(Q,!0);t(Q),t(se),t(v);var k=l(v,2),C=a(k),H=a(C),I=l(H,6),N=a(I,!0);t(I),t(C),t(k),t(_),q((ye,Ye,Oe)=>{B(i,"src",he.attackIcon),ne(V,ye),B(A,"src",he.defenseIcon),ne(ae,Ye),B(H,"src",he.workSpeedIcon),ne(N,Oe)},[()=>Math.round(e(o)?.attack||0),()=>Math.round(e(o)?.defense||0),()=>Math.round(e(o)?.workSpeed||0)]),s(u,_),ha()}var Ws=os('<line stroke="var(--color-surface-600)" stroke-width="3"></line>'),Xs=n("<p>Select a category.</p>"),Qs=n('<div class="mb-4"><h6 class="h6 mb-1">Effect</h6> <p class="text-sm"> <!> <!></p></div>'),Js=n('<img class="h-5 w-5"/> <span> </span>',1),Ys=n('<img class="h-5 w-5"/> <span> </span>',1),Zs=n('<div class="flex items-center space-x-2 text-sm"><!> <span class="ml-auto"> </span></div>'),er=n('<h6 class="h6 mb-1">Research Cost</h6> <div class="space-y-1"><!> <div class="border-surface-600 flex items-center space-x-2 border-t pt-2 text-sm"><img alt="Workload" class="h-5 w-5"/> <span>Workload</span> <span class="ml-auto"> </span></div></div>',1),tr=n('<h5 class="h5 mb-2"> </h5> <!> <!>',1),ar=n('<p class="text-surface-500 text-center">Select a research node to see details.</p>'),lr=n('<div class="grid grid-cols-[1fr_400px] gap-4"><div class="research-tree-container relative h-[calc(100vh-160px)] overflow-y-auto p-4 svelte-1sjn2zw"><svg class="pointer-events-none absolute left-0 top-0 z-0 w-full overflow-visible"></svg> <div class="relative z-10 flex min-w-max flex-col items-center space-y-6 p-4"><!></div></div> <!></div>');function sr(u,r){ga(r,!0);let o=Za(r,"guild",15),_=Za(r,"selectedCategory",11,"Handiwork");const M=nl();let g=Be(null),i=Be(Mt({})),L=Be(Mt([])),V=Be(Mt({})),v=Be(Mt({}));function se(G){if(!o()||!o().lab_research_data)return 0;const D=o().lab_research_data.find(b=>b.research_id===G);return D?D.work_amount:0}function A(G,D){const b=Object.values(G).filter(te=>te.details.category===D),O={},R=[];b.forEach(te=>{const y=se(te.id),P=te.details.work_amount||0,X=y>=P&&P>0;O[te.id]={id:te.id,research:te,children:[],isUnlocked:!1,isCompleted:X,workAmount:y,totalWorkAmount:P}});const ee=te=>{const y=te.research.details.require_research_id;y&&O[y]?te.isUnlocked=O[y].isCompleted:te.isUnlocked=!0,te.children.forEach(ee)};return b.forEach(te=>{const y=O[te.id],P=te.details.require_research_id;P&&O[P]?O[P].children.push(y):R.push(y)}),R.forEach(ee),Object.values(O).forEach(te=>te.children.sort((y,P)=>y.id.localeCompare(P.id))),R}function Q(G){return Ta.getByKey(G)?.details.work_amount??0}function ae(G,D){if(!G)return null;for(const b of G){if(b.id===D)return b;const O=ae(b.children,D);if(O)return O}return null}async function k(G){if(!o()?.lab_research_data||!e(i)[G])return;const D=Object.values(Ta.research).filter(ee=>ee.details.category===G),b=Qa(o().lab_research_data||[]),O=new Set;D.forEach(ee=>{O.add(ee.id)}),O.forEach(ee=>{const te=Q(ee);let y=b.find(X=>X.research_id===ee);y?y.work_amount=te:b.push({research_id:ee,work_amount:te});const P=ae(e(i)[G],ee);P&&(P.workAmount=te,P.isCompleted=!0,P.isUnlocked=!0)});const R=ee=>{const te=ee.research.details.require_research_id;if(te&&ae(e(i)[G],te)){const y=ae(e(i)[G],te);ee.isUnlocked=y?y.isCompleted:!0}else ee.isUnlocked=!0;ee.children.forEach(R)};e(i)[G].forEach(R),d(i,{...e(i)},!0),o(o().lab_research_data=b,!0),o(o().state=xt.MODIFIED,!0),Ht(Gt.UPDATE_LAB_RESEARCH,{guild_id:o().id,research_updates:b})}async function C(G){if(G.isCompleted)return;if(!G.isUnlocked){M.add(`Unlock prerequisite first: ${Ta.getByKey(G.research.details.require_research_id)?.localized_name||"Unknown"}`,"Locked","warning");return}const D=Qa(o().lab_research_data||[]),b=[],O=ee=>{const te=Ta.getByKey(ee);if(!te)return;const y=te.details.require_research_id;if(y){const P=ae(e(i)[_()],y);P&&!P.isCompleted&&(b.push(y),O(y))}};O(G.id),new Set([...b.reverse(),G.id]).forEach(ee=>{const te=Q(ee);let y=D.find(X=>X.research_id===ee);y?y.work_amount=te:D.push({research_id:ee,work_amount:te});const P=ae(e(i)[_()],ee);P&&(P.workAmount=te,P.isCompleted=!0,P.isUnlocked=!0,P.children.forEach(X=>{X.isUnlocked=!0,X.isCompleted=X.workAmount>=X.totalWorkAmount&&X.totalWorkAmount>0}))}),d(i,{...e(i)},!0),o(o().lab_research_data=D,!0),o(o().state=xt.MODIFIED,!0),Ht(Gt.UPDATE_LAB_RESEARCH,{guild_id:o().id,research_updates:D}),d(g,G,!0)}function H(G){d(g,G,!0)}function I(G,D){if(!G||!D)return null;const b=G.getBoundingClientRect(),O=D.getBoundingClientRect(),R=G.closest(".research-tree-container");if(!R)return null;const ee=R.getBoundingClientRect(),te=b.left+b.width/2-ee.left+R.scrollLeft,y=b.bottom-ee.top+R.scrollTop,P=O.left+O.width/2-ee.left+R.scrollLeft,X=O.top-ee.top+R.scrollTop;return{x1:te,y1:y,x2:P,y2:X}}function N(){if(!e(i)[_()]||!e(V)||Object.keys(e(V)).length===0){d(v,{},!0);return}const G={},D=[...e(i)[_()]];for(;D.length>0;){const b=D.shift();if(!b)continue;const O=e(V)[b.id];O&&b.children.forEach(R=>{const ee=e(V)[R.id];if(ee){const te=I(O,ee);te&&(G[`${b.id}->${R.id}`]=te)}D.push(R)})}d(v,G,!0)}const ye=bl(N,150);zt(()=>{if(Ta.research&&Object.keys(Ta.research).length>0){const G=[...new Set(Object.values(Ta.research).map(b=>b.details.category))].filter(Boolean);d(L,G.sort(),!0);const D={};G.forEach(b=>{b&&(D[b]=A(Ta.research,b))}),d(i,D,!0)}}),zt(()=>{_()&&e(i)[_()]&&setTimeout(()=>{requestAnimationFrame(N)},50)}),zt(()=>{e(V),ye()}),rs(()=>{window.addEventListener("resize",ye);const G=document.querySelector(".research-tree-container");return G&&G.addEventListener("scroll",ye),()=>{window.removeEventListener("resize",ye),G&&G.removeEventListener("scroll",ye)}});var Ye=lr(),Oe=a(Ye),dt=a(Oe);Et(dt,21,()=>Object.entries(e(v)),Nt,(G,D)=>{var b=m(()=>Al(e(D),2));let O=()=>e(b)[1];var R=Ws();q(()=>{B(R,"x1",O().x1),B(R,"y1",O().y1),B(R,"x2",O().x2),B(R,"y2",O().y2)}),s(G,R)}),t(dt);var lt=l(dt,2),Ke=a(lt);{var Fe=G=>{var D=Ne(),b=Z(D);Et(b,17,()=>e(i)[_()],O=>O.id,(O,R)=>{cs(O,{get node(){return e(R)},get selectedNode(){return e(g)},unlockResearch:C,selectNode:H,get nodeElements(){return e(V)},set nodeElements(ee){d(V,ee,!0)}})}),s(G,D)},St=G=>{var D=Xs();s(G,D)};le(Ke,G=>{e(i)[_()]?G(Fe):G(St,!1)})}t(lt),t(Oe);var it=l(Oe,2);{var ft=G=>{Ua(G,{class:"m-4 h-auto rounded-lg",children:(D,b)=>{var O=Ne(),R=Z(O);{var ee=y=>{const P=m(()=>e(g).research);var X=tr(),ie=Z(X),Je=a(ie,!0);t(ie);var We=l(ie,2);{var Ue=$=>{var F=Qs(),J=l(a(F),2),ve=a(J),be=l(ve);{var $e=qe=>{var Ge=va();q(()=>ne(Ge,`for ${e(P).details.effect_work_suitability??""}`)),s(qe,Ge)};le(be,qe=>{e(P).details.effect_work_suitability&&e(P).details.effect_work_suitability!=="None"&&qe($e)})}var rt=l(be,2);{var Ze=qe=>{var Ge=va();q(()=>ne(Ge,`for ${e(P).details.effect_item_type??""}`)),s(qe,Ge)};le(rt,qe=>{e(P).details.effect_item_type&&e(P).details.effect_item_type!=="None"&&qe(Ze)})}t(J),t(F),q(()=>ne(ve,`${e(P).details.effect_type??""}: ${e(P).details.effect_value&&e(P).details.effect_value>0?"+":""}${e(P).details.effect_value??0??""}% `)),s($,F)};le(We,$=>{e(P).details.effect_type&&e(P).details.effect_type!=="None"&&$(Ue)})}var Pe=l(We,2);{var je=$=>{var F=er(),J=l(Z(F),2),ve=a(J);Et(ve,17,()=>e(P).details.materials,Nt,(qe,Ge)=>{const de=m(()=>ia.getByKey(e(Ge).id));var Re=Zs(),Pt=a(Re);{var vt=c=>{const f=m(()=>sa.loadImage(`${ds}/img/${e(de).details.icon}.webp`));var E=Js(),Y=Z(E),Le=l(Y,2),mt=a(Le,!0);t(Le),q(()=>{B(Y,"src",e(f)||he.unknownIcon),B(Y,"alt",e(de).info.localized_name),ne(mt,e(de).info.localized_name)}),s(c,E)},Ut=c=>{var f=Ys(),E=Z(f),Y=l(E,2),Le=a(Y,!0);t(Y),q(()=>{B(E,"src",he.unknownIcon),B(E,"alt",e(Ge).id),ne(Le,e(Ge).id)}),s(c,f)};le(Pt,c=>{e(de)?c(vt):c(Ut,!1)})}var Rt=l(Pt,2),x=a(Rt,!0);t(Rt),t(Re),q(()=>ne(x,e(Ge).count)),s(qe,Re)});var be=l(ve,2),$e=a(be),rt=l($e,4),Ze=a(rt,!0);t(rt),t(be),t(J),q(()=>{B($e,"src",he.workSpeedIcon),ne(Ze,e(P).details.work_amount)}),s($,F)};le(Pe,$=>{e(P).details.materials&&e(P).details.materials.length>0&&$(je)})}q(()=>ne(Je,e(P).localized_name)),s(y,X)},te=y=>{var P=ar();s(y,P)};le(R,y=>{e(g)?y(ee):y(te,!1)})}s(D,O)},$$slots:{default:!0}})};le(it,G=>{e(g)&&G(ft)})}return t(Ye),s(u,Ye),ha({unlockAllForCategory:k})}var rr=n('<div class="flex items-center"><img class="pal-element-badge mr-2 svelte-olzjqy"/> <div class="grow"><span class="text-xs 2xl:text-base"> </span></div> <span> </span></div>'),or=n('<div class="flex flex-col space-y-3"><div class="flex space-x-2"><span class="grow font-bold">Total Pals</span> <span> </span></div> <div><h5 class="mb-1 font-bold">Elemental Distribution</h5> <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-sm"></div></div> <div><h5 class="mb-1 font-bold">Special Categories</h5> <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-sm"><div class="flex items-center"><img alt="Alpha" class="pal-element-badge mr-2 svelte-olzjqy"/> <div class="grow"><span class="text-xs 2xl:text-base">Alpha</span></div> <span> </span></div> <div class="flex items-center"><img alt="Lucky" class="pal-element-badge mr-2 svelte-olzjqy"/> <div class="grow"><span class="text-xs 2xl:text-base">Lucky</span></div> <span> </span></div> <div class="flex items-center"><!> <div class="grow"><span class="text-xs 2xl:text-base">Human</span></div> <span> </span></div> <div class="flex items-center"><img alt="Predator" class="pal-element-badge mr-2 svelte-olzjqy"/> <div class="grow"><span class="text-xs 2xl:text-base">Predator</span></div> <span> </span></div> <div class="flex items-center"><img alt="Oil Rig" class="pal-element-badge mr-2 svelte-olzjqy"/> <div class="grow"><span class="text-xs 2xl:text-base">Oil Rig</span></div> <span> </span></div> <div class="flex items-center"><img alt="Summoned" class="pal-element-badge mr-2 svelte-olzjqy"/> <div class="grow"><span class="text-xs 2xl:text-base">Summoned</span></div> <span> </span></div></div></div> <div><h5 class="mb-1 font-bold">Level Distribution</h5> <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-sm"><div class="flex space-x-2"><div class="grow"><span class="text-xs 2xl:text-base">Avg Level</span></div> <span> </span></div> <div class="flex space-x-2"><div class="grow"><span class="text-xs 2xl:text-base">Max Level</span></div> <span> </span></div> <div class="flex space-x-2"><div class="grow"><span class="text-xs 2xl:text-base">Min Level</span></div> <span> </span></div> <div class="flex space-x-2"><div class="grow"><span class="text-xs 2xl:text-base">Max Level Pals</span></div> <span> </span></div></div></div></div>');function ol(u,r){ga(r,!0);let o=Za(r,"elementsData",7);o(o()||ba);const _=Sa();let M=m(()=>{let de={};for(const Re of r.elementTypes){const Pt=o().elements[Re];Pt&&(de[Re]=sa.loadImage(`${ca}/img/${Pt.icon}.webp`))}return de}),g=m(()=>{if(!r.pals||r.pals.length===0)return{};const de={};return r.elementTypes.forEach(Re=>{de[Re]=0}),r.pals.forEach(({palData:Re})=>{Re&&Re.element_types&&Re.element_types.forEach(Pt=>{const vt=Pt.toString();de[vt]=(de[vt]||0)+1})}),de}),i=m(()=>!r.pals||r.pals.length===0?{alpha:0,lucky:0,human:0,predator:0,oilrig:0,summon:0}:{alpha:r.pals.filter(({pal:de})=>de.is_boss).length,lucky:r.pals.filter(({pal:de})=>de.is_lucky).length,human:r.pals.filter(({palData:de})=>de&&!de.is_pal).length,predator:r.pals.filter(({pal:de})=>de.character_id.toLowerCase().includes("predator_")).length,oilrig:r.pals.filter(({pal:de})=>de.character_id.toLowerCase().includes("_oilrig")).length,summon:r.pals.filter(({pal:de})=>de.character_id.toLowerCase().includes("summon_")).length}),L=m(()=>{if(!r.pals||r.pals.length===0)return{average:0,max:0,min:0,maxCount:0};const de=r.pals.map(({pal:vt})=>vt.level||0).filter(vt=>vt>0);if(de.length===0)return{average:0,max:0,min:0,maxCount:0};const Re=Math.max(...de),Pt=_.settings.cheat_mode?255:60;return{average:de.reduce((vt,Ut)=>vt+Ut,0)/de.length,max:Re,min:Math.min(...de),maxCount:de.filter(vt=>vt===Pt).length}}),V=m(()=>r.pals.length);var v=or(),se=a(v),A=l(a(se),2),Q=a(A,!0);t(A),t(se);var ae=l(se,2),k=l(a(ae),2);Et(k,21,()=>r.elementTypes,Nt,(de,Re)=>{const Pt=m(()=>e(g)[e(Re)]||0);var vt=rr(),Ut=a(vt),Rt=l(Ut,2),x=a(Rt),c=a(x,!0);t(x),t(Rt);var f=l(Rt,2),E=a(f,!0);t(f),t(vt),q(()=>{B(Ut,"src",e(M)[e(Re)]),B(Ut,"alt",e(Re)),ne(c,o().elements[e(Re)]?.localized_name||e(Re)),ne(E,e(Pt))}),s(de,vt)}),t(k),t(ae);var C=l(ae,2),H=l(a(C),2),I=a(H),N=a(I),ye=l(N,4),Ye=a(ye,!0);t(ye),t(I);var Oe=l(I,2),dt=a(Oe),lt=l(dt,4),Ke=a(lt,!0);t(lt),t(Oe);var Fe=l(Oe,2),St=a(Fe);dl(St,{class:"pal-element-badge mr-2"});var it=l(St,4),ft=a(it,!0);t(it),t(Fe);var G=l(Fe,2),D=a(G),b=l(D,4),O=a(b,!0);t(b),t(G);var R=l(G,2),ee=a(R),te=l(ee,4),y=a(te,!0);t(te),t(R);var P=l(R,2),X=a(P),ie=l(X,4),Je=a(ie,!0);t(ie),t(P),t(H),t(C);var We=l(C,2),Ue=l(a(We),2),Pe=a(Ue),je=l(a(Pe),2),$=a(je,!0);t(je),t(Pe);var F=l(Pe,2),J=l(a(F),2),ve=a(J,!0);t(J),t(F);var be=l(F,2),$e=l(a(be),2),rt=a($e,!0);t($e),t(be);var Ze=l(be,2),qe=l(a(Ze),2),Ge=a(qe,!0);t(qe),t(Ze),t(Ue),t(We),t(v),q((de,Re)=>{ne(Q,e(V)),B(N,"src",he.alphaIcon),ne(Ye,e(i).alpha),B(dt,"src",he.luckyIcon),ne(Ke,e(i).lucky),ne(ft,e(i).human),B(D,"src",he.predatorIcon),Xa(D,`filter: ${de??""}`),ne(O,e(i).predator),B(ee,"src",he.oilrigIcon),ne(y,e(i).oilrig),B(X,"src",he.altarIcon),ne(Je,e(i).summon),ne($,Re),ne(ve,e(L).max),ne(rt,e(L).min),ne(Ge,e(L).maxCount)},[()=>qa("#FF0000"),()=>e(L).average.toFixed(1)]),s(u,v),ha()}var nr=n("<div><!></div>");function ir(u,r){ga(r,!0);let o=Sa(),_=Za(r,"selected",7),M=hl(r,["$$slots","$$events","$$legacy","selected","onselect"]);const g=m(()=>Object.entries(o.players).map(([V,v])=>({value:V,label:v.nickname||`Player ${V}`})));if(Object.keys(o.players).length===1){const V=Object.keys(o.players)[0];_(V),r.onselect(o.players[V])}var i=nr();yl(i,()=>({class:"w-full",...M}));var L=a(i);Il(L,{get value(){return _()},get options(){return e(g)},placeholder:"Select Player",onChange:V=>r.onselect(o.players[V])}),t(i),s(u,i),ha()}var cr=n('<div class="grid grid-cols-[80px_1fr_auto] items-center gap-2"><span>Health</span> <!> <!> <span>Attack</span> <!> <!> <span>Defense</span> <!> <!> <span>Workspeed</span> <!> <!></div>');function Jl(u,r){ga(r,!0);let o=Za(r,"pal",15),_=Sa();const M=m(()=>_.settings.cheat_mode?255:20),g=m(()=>_.settings.cheat_mode?[50,100,150,200]:[5,10,15]),i=m(()=>[o().rank_hp??0]),L=m(()=>[o().rank_attack??0]),V=m(()=>[o().rank_defense??0]),v=m(()=>[o().rank_craftspeed??0]);function se(lt){o(o().rank_hp=lt.value[0],!0),o(o().state=xt.MODIFIED,!0)}function A(lt){o(o().rank_attack=lt.value[0],!0),o(o().state=xt.MODIFIED,!0)}function Q(lt){o(o().rank_craftspeed=lt.value[0],!0),o(o().state=xt.MODIFIED,!0)}function ae(lt){o(o().rank_defense=lt.value[0],!0),o(o().state=xt.MODIFIED,!0)}var k=cr(),C=l(a(k),2);vl(C,{classes:"grow",height:"h-2",meterBg:"bg-green-500",thumbRingColor:"ring-green-500",min:0,get max(){return e(M)},get markers(){return e(g)},step:1,get value(){return e(i)},onValueChange:se});var H=l(C,2);za(H,{type:"number",inputClass:"h-8 p-1",get value(){return e(i)[0]},onchange:se,min:0,get max(){return e(M)}});var I=l(H,4);vl(I,{height:"h-2",meterBg:"bg-red-500",thumbRingColor:"ring-red-500",min:0,get max(){return e(M)},get markers(){return e(g)},step:1,get value(){return e(L)},onValueChange:A});var N=l(I,2);za(N,{type:"number",inputClass:"h-8 p-1",get value(){return e(L)[0]},onchange:A,min:0,get max(){return e(M)}});var ye=l(N,4);vl(ye,{height:"h-2",meterBg:"bg-primary-500",thumbRingColor:"ring-primary-500",min:0,get max(){return e(M)},get markers(){return e(g)},step:1,get value(){return e(V)},onValueChange:ae});var Ye=l(ye,2);za(Ye,{type:"number",inputClass:"h-8 p-1",get value(){return e(V)[0]},onchange:ae,min:0,get max(){return e(M)}});var Oe=l(Ye,4);vl(Oe,{height:"h-2",meterBg:"bg-secondary-500",thumbRingColor:"ring-secondary-500",min:0,get max(){return e(M)},get markers(){return e(g)},step:1,get value(){return e(v)},onValueChange:Q});var dt=l(Oe,2);za(dt,{type:"number",inputClass:"h-8 p-1",get value(){return e(v)[0]},onchange:Q,min:0,get max(){return e(M)}}),t(k),s(u,k),ha()}var dr=n('<div class="text-surface-400 border-surface-600 r rounded-xs flex items-center space-x-1 border p-0.5"><img class="h-4 w-4"/> <span class="grow text-xs"> </span> <span class=" text-xs font-bold"> </span></div>'),vr=n('<div class="flex flex-col"><span> </span> <div class="grid grid-cols-3 gap-2"></div></div>'),ur=n('<div class="flex flex-col"><!> <div class="flex justify-end"><!> <!></div></div>'),_r=n('<div><div class="absolute inset-0 bg-cover bg-center opacity-25"></div> <span class="grow text-xs"> </span> <img class="h-4 w-4"/></div>'),pr=n('<div class="flex flex-col"><span> </span> <div class="grid grid-cols-4 gap-2"></div></div>'),fr=n('<div class="flex flex-col"><!> <div class="flex justify-end"><!> <!></div></div>'),mr=n("<!> <!>",1);function Yl(u,r){ga(r,!0);const o=Oa(),_=sa.loadImage(`${ca}/img/bg.webp`);let M=Be(Mt(["passive"])),g=m(()=>Object.entries(Ka.presetProfiles).filter(([I,N])=>N.type==="active_skills").map(([I,N])=>({...N,id:I}))),i=m(()=>e(g).map(I=>({value:I.id,label:I.name}))),L=Be(""),V=m(()=>Object.entries(Ka.presetProfiles).filter(([I,N])=>N.type==="passive_skills").map(([I,N])=>({...N,id:I}))),v=m(()=>e(V).map(I=>({value:I.id,label:I.name}))),se=Be(""),A=m(()=>{const I={};for(const N of Object.keys(ba.elements)){const ye=ba.elements[N];ye&&(I[N]=sa.loadImage(`${ca}/img/${ye.badge_icon}.webp`))}return I}),Q=m(()=>{const I={};for(const N of Object.values(ul.passiveSkills))I[N.details.rank]||(I[N.details.rank]=sa.loadImage(`${ca}/img/rank_${N.details.rank}.webp`));return I});async function ae(I){const N=I==="active"?e(g).find(ye=>ye.id===e(L)):e(V).find(ye=>ye.id===e(se));N&&(d(L,""),d(se,""),r.onSelect(I,Qa(N.skills)))}async function k(I){const N=I==="active"?e(L):e(se);!N||!await o.showConfirmModal({title:"Delete Preset",message:"Are you sure you want to delete the selected preset?",confirmText:"Delete",cancelText:"Cancel"})||await Ka.removePresetProfiles([N])}function C(I){const N=ul.getByKey(I);if(!N||N.localized_name==="None")return"";switch(N.details.rank){case 1:return"";case 2:case 3:return qa("#fcdf19");case 4:return qa("#68ffd8");default:return qa("#FF0000")}}function H(I){const N=ul.getByKey(I);if(!N)return"";switch(N.details.rank){case 1:return"border-l-surface-600";case 2:case 3:return"border-l-[#fcdf19]";case 4:return"border-l-[#68ffd8]";default:return"border-l-[#FF0000]"}}Jt(u,{get value(){return e(M)},onValueChange:I=>d(M,I.value,!0),collapsible:!0,children:(I,N)=>{var ye=mr(),Ye=Z(ye);{const dt=Ke=>{Qt();var Fe=va("Active Skills");s(Ke,Fe)},lt=Ke=>{var Fe=ur(),St=a(Fe);Il(St,{get options(){return e(i)},showHorizontalRule:!0,get value(){return e(L)},set value(b){d(L,b,!0)},selectOption:(b,O=Aa)=>{const R=m(()=>e(g).find(P=>P.id===O().value));var ee=Ne(),te=Z(ee);{var y=P=>{var X=vr(),ie=a(X),Je=a(ie,!0);t(ie);var We=l(ie,2);Et(We,21,()=>e(R).skills,Nt,(Ue,Pe)=>{const je=m(()=>vs.getByKey(e(Pe)));var $=Ne(),F=Z($);{var J=ve=>{const be=m(()=>e(A)[e(je).details.element]);var $e=dr(),rt=a($e),Ze=l(rt,2),qe=a(Ze,!0);t(Ze);var Ge=l(Ze,2),de=a(Ge,!0);t(Ge),t($e),q(()=>{B(rt,"src",e(be)),B(rt,"alt",e(je).details.element),ne(qe,e(je).localized_name),ne(de,e(je).details.power)}),s(ve,$e)};le(F,ve=>{e(je)&&ve(J)})}s(Ue,$)}),t(We),t(X),q(()=>ne(Je,O().label)),s(P,X)};le(te,P=>{e(R)&&e(R).skills&&P(y)})}s(b,ee)},$$slots:{selectOption:!0}});var it=l(St,2),ft=a(it);{let D=m(()=>!e(L));Na(ft,{popupLabel:"Apply selected preset",onclick:()=>ae("active"),get disabled(){return e(D)},children:(b,O)=>{el(b,{class:"text-primary-500",size:"24"})},$$slots:{default:!0}})}var G=l(ft,2);{let D=m(()=>!e(L));Na(G,{popupLabel:"Delete selected preset",onclick:()=>k("active"),get disabled(){return e(D)},children:(b,O)=>{tl(b,{class:"text-primary-500",size:"24"})},$$slots:{default:!0}})}t(it),t(Fe),s(Ke,Fe)};at(Ye,()=>Jt.Item,(Ke,Fe)=>{Fe(Ke,{value:"active",controlHover:"hover:bg-secondary-500/25",control:dt,panel:lt,$$slots:{control:!0,panel:!0}})})}var Oe=l(Ye,2);{const dt=Ke=>{Qt();var Fe=va("Passive Skills");s(Ke,Fe)},lt=Ke=>{var Fe=fr(),St=a(Fe);Il(St,{get options(){return e(v)},get value(){return e(se)},set value(b){d(se,b,!0)},selectOption:(b,O=Aa)=>{const R=m(()=>e(V).find(P=>P.id===O().value));var ee=Ne(),te=Z(ee);{var y=P=>{var X=pr(),ie=a(X),Je=a(ie,!0);t(ie);var We=l(ie,2);Et(We,21,()=>e(R).skills,Nt,(Ue,Pe)=>{const je=m(()=>ul.getByKey(e(Pe)));var $=Ne(),F=Z($);{var J=ve=>{const be=m(()=>e(Q)[e(je).details.rank]);var $e=_r(),rt=a($e),Ze=l(rt,2),qe=a(Ze,!0);t(Ze);var Ge=l(Ze,2);t($e),q((de,Re,Pt,vt)=>{st($e,1,de),Xa(rt,`background-image: url('${_??""}'); filter: ${Re??""};`),ne(qe,e(je).localized_name),B(Ge,"src",e(be)),B(Ge,"alt",Pt),Xa(Ge,`filter: ${vt??""};`)},[()=>pt(Bt("relative flex items-center space-x-1 border-l-2 p-0.5",H(e(Pe)))),()=>C(e(Pe)),()=>e(je).details.rank.toString(),()=>C(e(Pe))]),s(ve,$e)};le(F,ve=>{e(je)&&ve(J)})}s(Ue,$)}),t(We),t(X),q(()=>ne(Je,O().label)),s(P,X)};le(te,P=>{e(R)&&e(R).skills&&P(y)})}s(b,ee)},$$slots:{selectOption:!0}});var it=l(St,2),ft=a(it);{let D=m(()=>!e(se));Na(ft,{popupLabel:"Apply selected preset",onclick:()=>ae("passive"),get disabled(){return e(D)},children:(b,O)=>{el(b,{class:"text-primary-500",size:"24"})},$$slots:{default:!0}})}var G=l(ft,2);{let D=m(()=>!e(se));Na(G,{popupLabel:"Delete selected preset",onclick:()=>k("passive"),get disabled(){return e(D)},children:(b,O)=>{tl(b,{class:"text-primary-500",size:"24"})},$$slots:{default:!0}})}t(it),t(Fe),s(Ke,Fe)};at(Oe,()=>Jt.Item,(Ke,Fe)=>{Fe(Ke,{value:"passive",controlHover:"hover:bg-secondary-500/25",control:dt,panel:lt,$$slots:{control:!0,panel:!0}})})}s(I,ye)},$$slots:{default:!0}}),ha()}var gr=(u,r)=>{u.stopPropagation(),r()},hr=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),yr=(u,r)=>{u.stopPropagation(),r("active")},br=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),$r=(u,r)=>{u.stopPropagation(),r("active")},xr=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),Pr=n('<div class="flex"><!> <!> <!></div>'),kr=n('<div class="flex max-h-36 flex-col space-y-2 overflow-y-auto"></div>'),wr=(u,r)=>{u.stopPropagation(),r("passive")},Cr=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),Sr=(u,r)=>{u.stopPropagation(),r("passive")},Ir=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),Er=n('<div class="flex"><!> <!></div>'),Ar=n('<div class="grid max-h-24 grid-cols-2 gap-2 overflow-y-auto"></div>'),Lr=(u,r)=>{u.stopPropagation(),r()},Dr=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),Mr=n('<div class="flex"><!></div>'),jr=(u,r)=>{u.stopPropagation(),r()},Or=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),Tr=n('<div class="flex"><!></div>'),Br=(u,r)=>{u.stopPropagation(),r()},zr=n('<button class="btn hover:bg-secondary-500/25 ml-2 p-2"><!></button>'),Nr=n('<div class="flex"><!></div>'),Ur=n("<!> <!> <!> <!>",1),qr=n('<div class="flex max-w-96 flex-col"><p class="text-center"> </p></div>'),Kr=n('<img alt="Predator" class="absolute bottom-0 right-0 h-12 w-12"/>'),Fr=n('<div class="relative"><img class="max-h-[350px] max-w-full 2xl:max-h-[600px]"/> <!></div>'),Hr=n("<!> <!> <!>",1),Gr=n('<div class="flex h-full overflow-auto p-2"><div class="flex grow flex-col"><div class="w-2/3 shrink-0"><!></div> <div class="flex grow"><div class="hidden flex-1 overflow-auto p-2 2xl:block"><div class="flex flex-col space-y-2"><!> <!> <!> <!> <!> <!> <!> <!></div></div> <div class="mt-4 2xl:hidden"><!></div> <div class="flex-1 overflow-auto p-2"><div class="flex h-full flex-col items-center justify-center"><div class="pal"><!></div></div></div></div></div> <div class="w-1/3 overflow-auto p-2"><div class="hidden flex-col space-y-2 2xl:flex"><!> <!> <!> <!> <!> <!> <!></div> <div class="flex flex-col space-y-2 2xl:hidden"><!> <!></div></div></div>'),Rr=n(`<div class="flex w-full flex-col items-center justify-center"><h2 class="h2">Select a Pal to edit ðŸš€</h2> <p>Pals can be selected in a Players Pal Box, Guild Bases, Global Pal Storage, Dimensional Pal
			Storage, or Universal Pal Storage</p></div>`);function Vr(u,r){ga(r,!0);const o=y=>{Da(y,{text:"Active Skills",action:X=>{var ie=Pr(),Je=a(ie);W(Je,{label:"Edit Learned Skills",children:(Pe,je)=>{var $=hr();$.__click=[gr,lt];var F=a($);_s(F,{size:20}),t($),s(Pe,$)},$$slots:{default:!0}});var We=l(Je,2);W(We,{label:"Save as preset",children:(Pe,je)=>{var $=br();$.__click=[yr,it];var F=a($);Gl(F,{size:20}),t($),s(Pe,$)},$$slots:{default:!0}});var Ue=l(We,2);W(Ue,{label:"Add Active Skills",children:(Pe,je)=>{var $=xr();$.__click=[$r,b];var F=a($);cl(F,{size:20}),t($),s(Pe,$)},$$slots:{default:!0}}),t(ie),s(X,ie)}})},_=y=>{var P=kr();Et(P,21,()=>e(ye),Nt,(X,ie)=>{ms(X,{get skill(){return e(ie)},onSkillUpdate:Ke})}),t(P),s(y,P)},M=y=>{Da(y,{text:"Passive Skills",action:X=>{var ie=Er(),Je=a(ie);W(Je,{label:"Save as preset",children:(Ue,Pe)=>{var je=Cr();je.__click=[wr,it];var $=a(je);Gl($,{size:20}),t(je),s(Ue,je)},$$slots:{default:!0}});var We=l(Je,2);W(We,{label:"Add Passive Skill",children:(Ue,Pe)=>{var je=Ir();je.__click=[Sr,b];var $=a(je);cl($,{size:20}),t(je),s(Ue,je)},$$slots:{default:!0}}),t(ie),s(X,ie)}})},g=y=>{var P=Ar();Et(P,21,()=>e(Ye),Nt,(X,ie)=>{gs(X,{get skill(){return e(ie)},onSkillUpdate:Fe})}),t(P),s(y,P)},i=y=>{Da(y,{text:"Work Suitability",action:X=>{var ie=Mr(),Je=a(ie);W(Je,{label:"Max out Work Suitability",children:(We,Ue)=>{var Pe=Dr();Pe.__click=[Lr,D];var je=a(Pe);fl(je,{}),t(Pe),s(We,Pe)},$$slots:{default:!0}}),t(ie),s(X,ie)}})},L=y=>{Da(y,{text:"Talents (IVs)",action:X=>{var ie=Tr(),Je=a(ie);W(Je,{label:"Max out IVs",children:(We,Ue)=>{var Pe=Or();Pe.__click=[jr,ft];var je=a(Pe);fl(je,{}),t(Pe),s(We,Pe)},$$slots:{default:!0}}),t(ie),s(X,ie)}})},V=y=>{Da(y,{text:"Souls",action:X=>{var ie=Nr(),Je=a(ie);W(Je,{label:"Max out Souls",children:(We,Ue)=>{var Pe=zr();Pe.__click=[Br,G];var je=a(Pe);fl(je,{}),t(Pe),s(We,Pe)},$$slots:{default:!0}}),t(ie),s(X,ie)}})},v=Sa(),se=Oa();let A=Be(0),Q=Be(0),ae=Be(1),k=Be(Mt(["active_skills"])),C=Be(Mt(["stats"]));const H=m(()=>v.settings.cheat_mode?255:100),I=m(()=>v.settings.cheat_mode?255:20),N=m(()=>{if(v.selectedPal){const{character_key:y}=v.selectedPal,P=da.getByKey(y);return sa.loadPalImage(y,P?.is_pal||!1)}}),ye=m(()=>{if(v.selectedPal){let y=[...v.selectedPal.active_skills];for(;y.length<3;)y.push("Empty");return y}else return[]}),Ye=m(()=>{if(v.selectedPal){let y=[...v.selectedPal.passive_skills];for(;y.length<4;)y.push("Empty");return y}else return[]});async function Oe(){if(v.selectedPal){if(v.selectedPal.level===60){d(A,0),d(Q,0),d(ae,1);return}const y=await pl.getExpDataByLevel(v.selectedPal.level+1);d(A,y.PalTotalEXP-v.selectedPal.exp),d(Q,y.PalNextEXP-e(A)),d(ae,y.PalNextEXP,!0)}}async function dt(y){const P=da.getByKey(y);if(P)return P.description}async function lt(){if(!v.selectedPal)return;const y=await se.showModal(ps,{pal:v.selectedPal});y&&(v.selectedPal.learned_skills=y,v.selectedPal.state=xt.MODIFIED)}function Ke(y,P){if(v.selectedPal){const X=v.selectedPal.active_skills.findIndex(ie=>ie===P);y==="Empty"?X>=0&&v.selectedPal.active_skills.splice(X,1):X>=0?v.selectedPal.active_skills[X]=y:v.selectedPal.active_skills.push(y),v.selectedPal.state=xt.MODIFIED}}function Fe(y,P){if(v.selectedPal){const X=v.selectedPal.passive_skills.findIndex(ie=>ie===P);y==="Empty"?X>=0&&v.selectedPal.passive_skills.splice(X,1):X>=0?v.selectedPal.passive_skills[X]=y:v.selectedPal.passive_skills.push(y),v.selectedPal.state=xt.MODIFIED}}async function St(y,P){v.selectedPal&&(y==="active"?v.selectedPal.active_skills=P||[]:v.selectedPal.passive_skills=P||[],v.selectedPal.state=xt.MODIFIED)}async function it(y){if(!v.selectedPal)return;const P=await se.showModal($l,{title:`Add ${y} skills preset`,value:"",inputLabel:"Preset name"});if(!P)return;const X=y==="active"?v.selectedPal.active_skills:v.selectedPal.passive_skills,ie={name:P,type:y==="active"?"active_skills":"passive_skills",skills:X};await Ka.addPresetProfile(ie)}function ft(){v.selectedPal&&(v.selectedPal.talent_hp=e(H),v.selectedPal.talent_shot=e(H),v.selectedPal.talent_defense=e(H),v.selectedPal.state=xt.MODIFIED)}function G(){v.selectedPal&&(v.selectedPal.rank_hp=e(I),v.selectedPal.rank_attack=e(I),v.selectedPal.rank_defense=e(I),v.selectedPal.rank_craftspeed=e(I),v.selectedPal.state=xt.MODIFIED)}function D(){if(!v.selectedPal)return;const y=da.getByKey(v.selectedPal.character_key);if(y){for(const[P,X]of Object.entries(y.work_suitability))X!==0&&(v.selectedPal.work_suitability[P]=Math.min(5-X,4));v.selectedPal.state=xt.MODIFIED}}async function b(y){const P=await se.showModal(fs,{type:y==="active"?"Active":"Passive",title:`Select ${y==="active"?"Active":"Passive"} Skill`,pal:v.selectedPal});P&&(y==="active"?v.selectedPal.active_skills.push(...P):v.selectedPal.passive_skills.push(...P))}zt(()=>{Oe()});var O=Ne(),R=Z(O);{var ee=y=>{var P=Gr(),X=a(P),ie=a(X),Je=a(ie);us(Je,{get pal(){return v.selectedPal},set pal(gt){v.selectedPal=gt}}),t(ie);var We=l(ie,2),Ue=a(We),Pe=a(Ue),je=a(Pe);o(je);var $=l(je,2);_($);var F=l($,2);M(F);var J=l(F,2);g(J);var ve=l(J,2);Da(ve,{text:"Presets"});var be=l(ve,2);Yl(be,{onSelect:St});var $e=l(be,2);i($e);var rt=l($e,2);Kl(rt,{get pal(){return v.selectedPal},set pal(gt){v.selectedPal=gt}}),t(Pe),t(Ue);var Ze=l(Ue,2),qe=a(Ze);Jt(qe,{classes:"min-w-96 max-w-96",get value(){return e(k)},onValueChange:gt=>d(k,gt.value,!0),collapsible:!0,children:(gt,h)=>{var K=Ur(),ce=Z(K);{const w=j=>{o(j)},S=j=>{_(j)};at(ce,()=>Jt.Item,(j,Ie)=>{Ie(j,{value:"active_skills",controlHover:"hover:bg-secondary-500/25",control:w,panel:S,$$slots:{control:!0,panel:!0}})})}var De=l(ce,2);{const w=j=>{M(j)},S=j=>{g(j)};at(De,()=>Jt.Item,(j,Ie)=>{Ie(j,{value:"passive_skills",controlHover:"hover:bg-secondary-500/25",control:w,panel:S,$$slots:{control:!0,panel:!0}})})}var Te=l(De,2);{const w=j=>{Da(j,{text:"Presets"})},S=j=>{Yl(j,{onSelect:St})};at(Te,()=>Jt.Item,(j,Ie)=>{Ie(j,{value:"presets",controlHover:"hover:bg-secondary-500/25",control:w,panel:S,$$slots:{control:!0,panel:!0}})})}var p=l(Te,2);{const w=j=>{i(j)},S=j=>{Kl(j,{get pal(){return v.selectedPal},set pal(Ie){v.selectedPal=Ie}})};at(p,()=>Jt.Item,(j,Ie)=>{Ie(j,{value:"work_suitability",controlHover:"hover:bg-secondary-500/25",control:w,panel:S,$$slots:{control:!0,panel:!0}})})}s(gt,K)},$$slots:{default:!0}}),t(Ze);var Ge=l(Ze,2),de=a(Ge),Re=a(de),Pt=a(Re);W(Pt,{popupClass:"p-4 bg-surface-800",rounded:"rounded-none",position:"top-start",useArrow:!1,popup:h=>{var K=Ne(),ce=Z(K);ml(ce,()=>dt(v.selectedPal.character_key),null,(De,Te)=>{var p=Ne(),w=Z(p);{var S=j=>{var Ie=qr(),ht=a(Ie),kt=a(ht,!0);t(ht),t(Ie),q(()=>ne(kt,e(Te))),s(j,Ie)};le(w,j=>{e(Te)&&j(S)})}s(De,p)}),s(h,K)},children:(h,K)=>{var ce=Fr(),De=a(ce),Te=l(De,2);{var p=w=>{var S=Kr();q(j=>{B(S,"src",he.predatorIcon),Xa(S,`filter: ${j??""};`)},[()=>qa("#FF0000")]),s(w,S)};le(Te,w=>{v.selectedPal.is_predator&&w(p)})}t(ce),q(()=>{B(De,"src",e(N)),B(De,"alt",`${v.selectedPal?.name} icon`)}),s(h,ce)},$$slots:{popup:!0,default:!0}}),t(Re),t(de),t(Ge),t(We),t(X);var vt=l(X,2),Ut=a(vt),Rt=a(Ut);Fl(Rt,{get pal(){return v.selectedPal},set pal(gt){v.selectedPal=gt}});var x=l(Rt,2);Da(x,{text:"Stats"});var c=l(x,2);Ql(c,{get pal(){return v.selectedPal},set pal(gt){v.selectedPal=gt},get player(){return v.selectedPlayer},set player(gt){v.selectedPlayer=gt}});var f=l(c,2);L(f);var E=l(f,2);Hl(E,{get pal(){return v.selectedPal},set pal(gt){v.selectedPal=gt}});var Y=l(E,2);V(Y);var Le=l(Y,2);Jl(Le,{get pal(){return v.selectedPal},set pal(gt){v.selectedPal=gt}}),t(Ut);var mt=l(Ut,2),ta=a(mt);Fl(ta,{get pal(){return v.selectedPal},set pal(gt){v.selectedPal=gt}});var ua=l(ta,2);Jt(ua,{classes:"min-w-96",get value(){return e(C)},onValueChange:gt=>d(C,gt.value,!0),collapsible:!0,children:(gt,h)=>{var K=Hr(),ce=Z(K);{const p=S=>{Da(S,{text:"Stats"})},w=S=>{Ql(S,{get pal(){return v.selectedPal},set pal(j){v.selectedPal=j},get player(){return v.selectedPlayer},set player(j){v.selectedPlayer=j}})};at(ce,()=>Jt.Item,(S,j)=>{j(S,{value:"stats",controlHover:"hover:bg-secondary-500/25",control:p,panel:w,$$slots:{control:!0,panel:!0}})})}var De=l(ce,2);{const p=S=>{L(S)},w=S=>{Hl(S,{get pal(){return v.selectedPal},set pal(j){v.selectedPal=j}})};at(De,()=>Jt.Item,(S,j)=>{j(S,{value:"talents",controlHover:"hover:bg-secondary-500/25",control:p,panel:w,$$slots:{control:!0,panel:!0}})})}var Te=l(De,2);{const p=S=>{V(S)},w=S=>{Jl(S,{get pal(){return v.selectedPal},set pal(j){v.selectedPal=j}})};at(Te,()=>Jt.Item,(S,j)=>{j(S,{value:"souls",controlHover:"hover:bg-secondary-500/25",control:p,panel:w,$$slots:{control:!0,panel:!0}})})}s(gt,K)},$$slots:{default:!0}}),t(mt),t(vt),t(P),s(y,P)},te=y=>{var P=Rr();s(y,P)};le(R,y=>{v.selectedPal?y(ee):y(te,!1)})}s(u,O),ha()}Ga(["click"]);function Wr(u,r,o,_,M,g){r(),o(),_(),M(),g()}var Xr=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),Qr=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),Jr=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),Yr=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),Zr=n("<!> <!> <!> <!>",1),eo=(u,r)=>r("gear"),to=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),ao=(u,r)=>r("implants"),lo=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),so=(u,r)=>r("misc"),ro=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),oo=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),no=n("<!> <!> <!> <!>",1),io=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),co=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),vo=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),uo=n('<button class="hover:bg-secondary-500/50 btn rounded-sm"><!></button>'),_o=n("<!> <!>",1),po=n('<div class="max-h-[500px] overflow-y-auto 2xl:max-h-[800px]"><div class="m-1 grid grid-cols-6 gap-2"></div></div>'),fo=n('<div class="max-h-[500px] overflow-y-auto 2xl:max-h-[800px]"><div class="m-1 grid grid-cols-6 gap-2"></div></div>'),mo=n("<!> <!>",1),go=n('<img class="hidden 2xl:block 2xl:h-16 2xl:w-16 svelte-im27zm"/>'),ho=n('<img class="hidden 2xl:block 2xl:h-64 2xl:w-64 svelte-im27zm"/>'),yo=n('<div class="flex items-center space-x-2"><div class="h-6 w-6"><img alt="Control" class="h-full w-full svelte-im27zm"/></div> <div class="h-6 w-6"><img alt="Left Click" class="h-full w-full svelte-im27zm"/></div> <span class="text-xs font-bold">-5</span></div> <div class="flex items-center space-x-2"><div class="h-6 w-6"><img alt="Control" class="h-full w-full svelte-im27zm"/></div> <div class="h-6 w-6"><img alt="Right Click" class="h-full w-full svelte-im27zm"/></div> <span class="text-xs font-bold">-10</span></div> <div class="flex items-center space-x-2"><div class="h-6 w-6"><img alt="Right Click" class="h-full w-full svelte-im27zm"/></div> <div class="h-6 w-6"><img alt="Middle Click" class="h-full w-full svelte-im27zm"/></div> <span class="text-xs font-bold">Level 1</span></div>',1),bo=u=>u.preventDefault(),$o=(u,r)=>r(u),xo=n('<button class="btn hover:bg-secondary-500/25 mr-4 px-2"><!></button>'),Po=n('<div class="flex items-center space-x-2"><div class="h-6 w-6"><img alt="Control" class="h-full w-full svelte-im27zm"/></div> <div class="h-6 w-6"><img alt="Left Click" class="h-full w-full svelte-im27zm"/></div> <span class="text-xs font-bold">+5</span></div> <div class="flex items-center space-x-2"><div class="h-6 w-6"><img alt="Control" class="h-full w-full svelte-im27zm"/></div> <div class="h-6 w-6"><img alt="Right Click" class="h-full w-full svelte-im27zm"/></div> <span class="text-xs font-bold">+10</span></div> <div class="flex items-center space-x-2"><div class="h-6 w-6"><img alt="Right Click" class="h-full w-full svelte-im27zm"/></div> <div class="h-6 w-6"><img alt="Middle Click" class="h-full w-full svelte-im27zm"/></div> <span class="text-xs font-bold"> </span></div>',1),ko=u=>u.preventDefault(),wo=(u,r)=>r(u),Co=n('<button class="btn hover:bg-secondary-500/25 ml-4 px-2"><!></button>'),So=n("<span> </span>"),Io=n('<!> <hr class="hr"/> <!>',1),Eo=n('<div class="flex h-full flex-col overflow-auto"><div class="ml-2 flex"><nav class="btn-group preset-outlined-surface-200-800 mr-2 flex-col items-center rounded-sm"><!> <!> <!> <!> <!> <!></nav> <div class="grid w-full grid-cols-[auto_1fr] gap-4 pr-[420px]"><div class="flex flex-col space-y-2"><!></div> <div class="flex h-[600px] flex-col 2xl:grid 2xl:grid-cols-[auto_1fr_auto]"><div class="flex flex-col space-y-2"><div class="flex flex-col space-y-2"><!> <div class="flex space-x-2 2xl:flex-col 2xl:space-y-2"></div></div> <div class="flex flex-col space-y-2"><!> <div class="2xl:ml-2"><div class="flex max-h-36 max-w-36 gap-2 2xl:grid 2xl:grid-cols-2"></div></div></div></div> <div class="hidden flex-col items-center justify-center 2xl:flex"><span class="flex h-1/3 items-end"><!></span> <span class="h-2/3"><!></span></div> <div class="mt-2 flex space-x-2 space-y-2 2xl:flex-col"><div class="flex flex-col space-y-2"><!> <!></div> <div class="flex flex-col space-y-2"><!> <!></div> <div class="flex flex-col space-y-2"><!> <!></div> <div class="flex flex-col space-y-2"><!> <!></div> <div class="flex flex-col space-y-2"><!> <!> <!></div></div> <div class="col-span-3 space-y-2 2xl:ml-12 2xl:mt-2"><!> <div class="2xl:ml-2"><div class="flex flex-row space-x-2"></div></div></div></div></div> <div class="fixed right-2 w-96 flex-none"><div class="border-l-surface-600 preset-filled-surface-100-900 mb-2 mr-2 flex rounded-none border-l-2 p-4"><div class="mr-4 flex flex-col items-center justify-center rounded-none"><div class="flex items-center"><!> <div class="flex flex-col items-center justify-center"><span class="text-surface-400 text-sm font-bold">LEVEL</span> <span class="text-xl font-bold xl:text-2xl"><!></span></div> <!></div></div> <div class="grow"><div class="flex flex-col"><div class="flex space-x-2"><button class="hover:bg-secondary-500/50 hover:ring-offset-surface-900 text-start font-bold hover:ring hover:ring-offset-4"><!></button> <!></div> <div class="flex flex-col space-y-2"><div class="flex"><span class="text-on-surface grow">NEXT</span> <span class="text-on-surface"> </span></div> <!></div></div></div></div> <!> <!></div></div></div>'),Ao=n('<div class="flex w-full items-center justify-center"><h2 class="h2">Select a Player to edit ðŸš€</h2></div>');function Lo(u,r){ga(r,!0);const o=Sa(),_=nl(),M=Oa(),g=m(()=>o.settings.cheat_mode?99:65),i={id:"",type:"",slots:[],key:"",slot_num:0},L={id:"",static_id:"",slot_index:0,type:"",count:0};let V=Mt(i),v=Mt(i),se=Mt(i),A=Mt(i),Q=Mt(i),ae=Be(Mt(L)),k=Be(Mt(L)),C=Be(Mt(L)),H=Be(Mt(L)),I=Be(Mt(L)),N=Be(Mt([])),ye=Be("inventory"),Ye=Be(Mt(["stats"])),Oe=Be(null),dt=Be(500),lt=m(()=>{let x=0;return Object.values(v.slots).forEach(c=>{if(c.static_id.includes("AutoMealPouch_Tier")){const f=parseInt(c.static_id.slice(-1));x=f>x?f:x}}),x}),Ke=m(()=>{let x=0;return Object.values(v.slots).forEach(c=>{c.static_id.includes("AdditionalInventory_")&&(x+=3)}),Math.min(42+x,54)}),Fe=m(()=>{if(o.selectedPlayer){if(o.selectedPlayer.level>=e(g))return{levelProgressToNext:0,levelProgressValue:0,levelProgressMax:1};const x=pl.expData[o.selectedPlayer.level+1];return{levelProgressToNext:x.TotalEXP-o.selectedPlayer.exp||0,levelProgressValue:x.NextEXP-(x.TotalEXP-o.selectedPlayer.exp),levelProgressMax:x.NextEXP}}return{levelProgressToNext:0,levelProgressValue:0,levelProgressMax:1}}),St=m(()=>e(Fe).levelProgressToNext),it=m(()=>e(Fe).levelProgressValue),ft=m(()=>e(Fe).levelProgressMax);const G=m(()=>Object.values(ia.items).filter(x=>x.details.type_b==="Essential_PalGear"&&!x.details.disabled).sort((x,c)=>(x.details.sort_id||1/0)-(c.details.sort_id||1/0))),D=m(()=>Object.values(ia.items).filter(x=>x.id.includes("PalPassiveSkillChange")).sort((x,c)=>(x.details.sort_id||1/0)-(c.details.sort_id||1/0))),b=m(()=>Object.values(ia.items).filter(x=>!x.id.includes("PalPassiveSkillChange")&&x.details.type_b!=="Essential_PalGear"&&x.details.type_a==="Essential"&&!x.id.includes("BossDefeatReward")&&x.id!=="Relic").sort((x,c)=>(x.details.sort_id||1/0)-(c.details.sort_id||1/0)));async function O(x){if(!x||x==="None")return;const c=ia.getByKey(x);if(!c){console.error(`Item data not found for static id: ${x}`);return}return sa.loadImage(`${ca}/img/${c.details.icon}.webp`)}function R(x){Object.values(x.slots).forEach(c=>{c.dynamic_item=void 0,c.static_id="None",c.count=0,c.local_id="00000000-0000-0000-0000-000000000000"}),o.selectedPlayer&&(o.selectedPlayer.state=xt.MODIFIED)}function ee(){R(V)}function te(){R(v)}function y(){R(se)}function P(){R(A)}function X(){R(Q)}async function ie(){if(!o.selectedPlayer)return;const x=await M.showModal(il,{title:"Enter Item Count",value:"",min:0,max:9999});x&&(Object.values(V.slots).forEach(c=>{c.static_id!=="None"&&(c.count=x)}),o.selectedPlayer&&(o.selectedPlayer.state=xt.MODIFIED))}async function Je(){const x=await M.showModal(Is,{group:"Common",itemId:"",title:"Select Item"});if(!x)return;let[c,f]=x;const E=ia.getByKey(c);E&&(f=f>E.details.max_stack_count?E.details.max_stack_count:f,Object.values(V.slots).forEach(Y=>{Y.static_id=c,Y.count=f,E.details.dynamic?Y.dynamic_item={local_id:"00000000-0000-0000-0000-000000000000",durability:E.details.dynamic.durability||0,remaining_bullets:E.details.dynamic.magazine_size||0,type:E.details.dynamic.type}:Y.dynamic_item=void 0}),o.selectedPlayer&&(o.selectedPlayer.state=xt.MODIFIED))}function We(x){x==="gear"?Ue(e(G)):x==="implants"?Ue(e(D)):x==="misc"?Ue(e(b)):_.add("Invalid option selected",void 0,"error")}function Ue(x){const c=new Set(Object.values(v.slots).filter(E=>E.static_id!=="None").map(E=>E.static_id));let f=0;for(const E of Object.values(v.slots)){if(E.static_id!=="None")continue;for(;f<x.length&&c.has(x[f].id);)f++;if(f>=x.length)break;const Y=x[f];E.static_id=Y.id,E.count=1;const Le=ia.getByKey(E.static_id);Le&&Le.details.dynamic?E.dynamic_item={local_id:"00000000-0000-0000-0000-000000000000",durability:Le.details.dynamic.durability||0,remaining_bullets:Le.details.dynamic.magazine_size||0,type:Le.details.dynamic.type}:E.dynamic_item=void 0,c.add(E.static_id),f++}o.selectedPlayer&&(o.selectedPlayer.state=xt.MODIFIED)}async function Pe(x){if(x.static_id!=="None"){o.clipboardItem=x;let c=x.static_id;const f=ia.getByKey(x.static_id);f&&(c=f.info.localized_name),_.add(`${c} copied to clipboard`)}else o.clipboardItem=null,_.add("Clipboard cleared")}function je(x){x.static_id="None",x.count=0,x.dynamic_item=void 0,o.selectedPlayer&&(o.selectedPlayer.state=xt.MODIFIED)}function $(x){o.clipboardItem?(x.static_id=o.clipboardItem.static_id,x.count=o.clipboardItem.count,x.dynamic_item=o.clipboardItem.dynamic_item,x.dynamic_item&&(x.dynamic_item.local_id="00000000-0000-0000-0000-000000000000"),o.selectedPlayer&&(o.selectedPlayer.state=xt.MODIFIED)):je(x)}async function F(x,c,f=!0){x.button!==0&&(x.preventDefault(),x.ctrlKey&&x.button===2&&f?$(c):x.ctrlKey&&x.button===1?je(c):!x.ctrlKey&&x.button===2?await Pe(c):_.add("Cannot paste here (yetâ„¢)",void 0,"warning"))}function J(){o.selectedPlayer&&(o.selectedPlayer.state=xt.MODIFIED)}function ve(){if(o.selectedPlayer){V.slots=[];const x=o.selectedPlayer.common_container;x.slots.sort((f,E)=>f.slot_index-E.slot_index);let c=[];for(let f=0;f<e(Ke);f++){const E=x.slots.find(Y=>Y.slot_index===f);if(E)c.push(E);else{const Y={static_id:"None",slot_index:f,count:0,dynamic_item:void 0};c.push(Y),o.selectedPlayer.common_container.slots.push(Y)}}V.slots=c}}function be(){if(o.selectedPlayer){const x=o.selectedPlayer.essential_container;x.slots.sort((f,E)=>f.slot_index-E.slot_index);let c=[];for(let f=0;f<200;f++){const E=x.slots.find(Y=>Y.slot_index===f);if(E)c.push(E);else{const Y={static_id:"None",slot_index:f,count:0,dynamic_item:void 0};c.push(Y),o.selectedPlayer.essential_container.slots.push(Y)}}v.slots=c}}function $e(){if(o.selectedPlayer){const x=o.selectedPlayer.food_equip_container;let c=[];for(let f=0;f<e(lt);f++){const E=x.slots.find(Y=>Y.slot_index===f);if(E)c.push(E);else{const Y={static_id:"None",slot_index:f,count:0,dynamic_item:void 0};c.push(Y),o.selectedPlayer.food_equip_container.slots.push(Y)}}Q.slots=c}}function rt(){if(o.selectedPlayer){const x=o.selectedPlayer.weapon_load_out_container;x.slots.sort((f,E)=>f.slot_index-E.slot_index);let c=[];for(let f=0;f<4;f++){const E=x.slots.find(Y=>Y.slot_index===f);if(E)c.push(E);else{const Y={static_id:"None",slot_index:f,count:0,dynamic_item:void 0};c.push(Y),o.selectedPlayer.weapon_load_out_container.slots.push(Y)}}se.slots=c}}function Ze(){if(o.selectedPlayer){const x=o.selectedPlayer.player_equipment_armor_container;x.slots.sort((f,E)=>f.slot_index-E.slot_index);let c=[];for(let f=0;f<9;f++){const E=x.slots.find(Y=>Y.slot_index===f);if(E)c.push(E);else{const Y={static_id:"None",slot_index:f,count:0,dynamic_item:void 0};c.push(Y),o.selectedPlayer.player_equipment_armor_container.slots.push(Y)}}d(ae,c[0],!0),d(k,c[1],!0),d(C,c[4],!0),d(H,c[5],!0),d(I,c[8],!0),d(N,c.slice(2,4).concat(c.slice(6,8)),!0),A.slots=c}}async function qe(){if(o.selectedPlayer){const x=V.slots.map(c=>{if(c.static_id!=="None"){const f=ia.getByKey(c.static_id);return{...c,sort_id:f?.details.sort_id??1/0}}return{...c,sort_id:1/0}});x.sort((c,f)=>c.sort_id-f.sort_id),V.slots=x.map((c,f)=>({...c,slot_index:f})),o.selectedPlayer.common_container.slots=V.slots,o.selectedPlayer.state=xt.MODIFIED}}async function Ge(x){if(!o.selectedPlayer||!o.selectedPlayer||!o.selectedPlayer.pals)return;let c=o.selectedPlayer.level;if(x.ctrlKey?x.button===0?c=Math.min(o.selectedPlayer.level+5,e(g)):x.button===1?c=e(g):x.button===2&&(c=Math.min(o.selectedPlayer.level+10,e(g))):c=Math.min(o.selectedPlayer.level+1,e(g)),c===o.selectedPlayer.level)return;const f=await pl.getExpDataByLevel(c+1);o.selectedPlayer.level=c,o.selectedPlayer.exp=f.TotalEXP-f.NextEXP,o.selectedPlayer.state=xt.MODIFIED}async function de(x){if(!o.selectedPlayer||!o.selectedPlayer||!o.selectedPlayer.pals)return;let c=o.selectedPlayer.level;if(x.ctrlKey?x.button===0?c=Math.max(o.selectedPlayer.level-5,1):x.button===1?c=1:x.button===2&&(c=Math.max(o.selectedPlayer.level-10,1)):c=Math.max(o.selectedPlayer.level-1,1),c===o.selectedPlayer.level)return;const f=await pl.getExpDataByLevel(c+1);o.selectedPlayer.level=c,o.selectedPlayer.exp=f.TotalEXP-f.NextEXP,o.selectedPlayer.state=xt.MODIFIED}zt(()=>{o.selectedPlayer&&(ve(),be(),$e(),rt(),Ze(),d(dt,500+o.selectedPlayer.status_point_list.max_hp*100))});async function Re(){if(!o.selectedPlayer)return;const x=await M.showModal($l,{title:"Change Player Name",value:o.selectedPlayer.nickname});x&&(o.selectedPlayer.nickname=x,o.selectedPlayer.state=xt.MODIFIED)}var Pt=Ne(),vt=Z(Pt);{var Ut=x=>{var c=Eo(),f=a(c),E=a(f),Y=a(E);{var Le=me=>{var $t=Zr(),Ce=Z($t);W(Ce,{label:"Sort Inventory",children:(nt,At)=>{var Se=Xr();Se.__click=qe;var Kt=a(Se);Ns(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}});var ge=l(Ce,2);W(ge,{label:"Fill Inventory",children:(nt,At)=>{var Se=Qr();Se.__click=Je;var Kt=a(Se);Cs(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}});var It=l(ge,2);W(It,{label:"Set Inventory Count",children:(nt,At)=>{var Se=Jr();Se.__click=ie;var Kt=a(Se);Ss(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}});var Xt=l(It,2);W(Xt,{label:"Clear Inventory",children:(nt,At)=>{var Se=Yr();Se.__click=ee;var Kt=a(Se);Rl(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}}),s(me,$t)};le(Y,me=>{e(ye)==="inventory"&&me(Le)})}var mt=l(Y,2);{var ta=me=>{var $t=no(),Ce=Z($t);W(Ce,{label:"Add All Pal Gear",children:(nt,At)=>{var Se=to();Se.__click=[eo,We];var Kt=a(Se);Ks(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}});var ge=l(Ce,2);W(ge,{label:"Add All Implants",children:(nt,At)=>{var Se=lo();Se.__click=[ao,We];var Kt=a(Se);zs(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}});var It=l(ge,2);W(It,{label:"Add Other Key Items",children:(nt,At)=>{var Se=ro();Se.__click=[so,We];var Kt=a(Se);qs(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}});var Xt=l(It,2);W(Xt,{label:"Clear Key Items",children:(nt,At)=>{var Se=oo();Se.__click=te;var Kt=a(Se);Rl(Kt,{class:"h-6 w-6"}),t(Se),s(nt,Se)},$$slots:{default:!0}}),s(me,$t)};le(mt,me=>{e(ye)==="key_items"&&me(ta)})}var ua=l(mt,2);W(ua,{label:"Clear Weapons",children:(me,$t)=>{var Ce=io();Ce.__click=y;var ge=a(Ce);Hs(ge,{class:"h-6 w-6"}),t(Ce),s(me,Ce)},$$slots:{default:!0}});var gt=l(ua,2);W(gt,{label:"Clear Armor",children:(me,$t)=>{var Ce=co();Ce.__click=P;var ge=a(Ce);hs(ge,{class:"h-6 w-6"}),t(Ce),s(me,Ce)},$$slots:{default:!0}});var h=l(gt,2);W(h,{label:"Clear Food",children:(me,$t)=>{var Ce=vo();Ce.__click=X;var ge=a(Ce);Fs(ge,{class:"h-6 w-6"}),t(Ce),s(me,Ce)},$$slots:{default:!0}});var K=l(h,2);W(K,{label:"Clear All",children:(me,$t)=>{var Ce=uo();Ce.__click=[Wr,ee,te,y,P,X];var ge=a(Ce);Us(ge,{class:"h-6 w-6"}),t(Ce),s(me,Ce)},$$slots:{default:!0}}),t(E);var ce=l(E,2),De=a(ce),Te=a(De);la(Te,{listBorder:"preset-outlined-surface-200-800",listClasses:"btn-group preset-outlined-surface-200-800 w-full flex-col md:flex-row rounded-sm",get value(){return e(ye)},onValueChange:Ce=>d(ye,Ce.value,!0),list:Ce=>{var ge=_o(),It=Z(ge);at(It,()=>la.Control,(nt,At)=>{At(nt,{value:"inventory",classes:"w-full",base:"border-none hover:bg-secondary-500/50 rounded-sm",labelBase:"btn",stateActive:"bg-secondary-800",padding:"p-0",children:(Se,Kt)=>{Qt();var pa=va("Inventory");s(Se,pa)},$$slots:{default:!0}})});var Xt=l(It,2);at(Xt,()=>la.Control,(nt,At)=>{At(nt,{value:"key_items",classes:"w-full",base:"border-none hover:bg-secondary-500/50 rounded-sm",labelBase:"btn",stateActive:"bg-secondary-800",padding:"p-0",children:(Se,Kt)=>{Qt();var pa=va("Key Items");s(Se,pa)},$$slots:{default:!0}})}),s(Ce,ge)},content:Ce=>{var ge=mo(),It=Z(ge);at(It,()=>la.Panel,(nt,At)=>{At(nt,{value:"inventory",children:(Se,Kt)=>{var pa=po(),wa=a(pa);Et(wa,21,()=>Object.values(V.slots),Nt,(Ra,Va,fa)=>{ya(Ra,{itemGroup:"Common",onCopyPaste:Ca=>F(Ca,V.slots[fa]),onUpdate:J,get slot(){return V.slots[fa]},set slot(Ca){V.slots[fa]=Ca}})}),t(wa),t(pa),s(Se,pa)},$$slots:{default:!0}})});var Xt=l(It,2);at(Xt,()=>la.Panel,(nt,At)=>{At(nt,{value:"key_items",children:(Se,Kt)=>{var pa=fo(),wa=a(pa);Et(wa,21,()=>Object.values(v.slots),Nt,(Ra,Va,fa)=>{ya(Ra,{itemGroup:"KeyItem",onUpdate:J,onCopyPaste:Ca=>F(Ca,v.slots[fa],!1),get slot(){return v.slots[fa]},set slot(Ca){v.slots[fa]=Ca}})}),t(wa),t(pa),s(Se,pa)},$$slots:{default:!0}})}),s(Ce,ge)},$$slots:{list:!0,content:!0}}),t(De);var p=l(De,2),w=a(p),S=a(w),j=a(S);Ma(j,{text:"Weapon"});var Ie=l(j,2);Et(Ie,21,()=>Object.values(se.slots),Nt,(me,$t,Ce)=>{ya(me,{itemGroup:"Weapon",onCopyPaste:ge=>F(ge,se.slots[Ce],!1),onUpdate:J,get slot(){return se.slots[Ce]},set slot(ge){se.slots[Ce]=ge}})}),t(Ie),t(S);var ht=l(S,2),kt=a(ht);Ma(kt,{text:"Accessory"});var et=l(kt,2),ue=a(et);Et(ue,21,()=>e(N),Nt,(me,$t,Ce)=>{ya(me,{itemGroup:"Accessory",onCopyPaste:ge=>F(ge,e(N)[Ce],!1),onUpdate:J,get slot(){return e(N)[Ce]},set slot(ge){e(N)[Ce]=ge}})}),t(ue),t(et),t(ht),t(w);var ze=l(w,2),ut=a(ze),jt=a(ut);ml(jt,()=>O(e(ae).static_id),null,(me,$t)=>{var Ce=Ne(),ge=Z(Ce);{var It=Xt=>{var nt=go();q(()=>{B(nt,"src",e($t)),B(nt,"alt",e(ae).static_id)}),s(Xt,nt)};le(ge,Xt=>{e($t)&&Xt(It)})}s(me,Ce)}),t(ut);var Vt=l(ut,2),yt=a(Vt);ml(yt,()=>O(e(k).static_id),null,(me,$t)=>{var Ce=Ne(),ge=Z(Ce);{var It=Xt=>{var nt=ho();q(()=>{B(nt,"src",e($t)),B(nt,"alt",e(k).static_id)}),s(Xt,nt)};le(ge,Xt=>{e($t)&&Xt(It)})}s(me,Ce)}),t(Vt),t(ze);var Ft=l(ze,2),tt=a(Ft),ke=a(tt);Ma(ke,{text:"Head"});var _t=l(ke,2);ya(_t,{itemGroup:"Head",onCopyPaste:me=>F(me,e(ae),!1),onUpdate:J,get slot(){return e(ae)},set slot(me){d(ae,me,!0)}}),t(tt);var ct=l(tt,2),Lt=a(ct);Ma(Lt,{text:"Body"});var wt=l(Lt,2);ya(wt,{itemGroup:"Body",onCopyPaste:me=>F(me,e(k),!1),onUpdate:J,get slot(){return e(k)},set slot(me){d(k,me,!0)}}),t(ct);var Ee=l(ct,2),He=a(Ee);Ma(He,{text:"Shield"});var we=l(He,2);ya(we,{itemGroup:"Shield",onCopyPaste:me=>F(me,e(C),!1),onUpdate:J,get slot(){return e(C)},set slot(me){d(C,me,!0)}}),t(Ee);var Ae=l(Ee,2),Ve=a(Ae);Ma(Ve,{text:"Glider"});var oe=l(Ve,2);ya(oe,{itemGroup:"Glider",onCopyPaste:me=>F(me,e(H),!1),onUpdate:J,get slot(){return e(H)},set slot(me){d(H,me,!0)}}),t(Ae);var _e=l(Ae,2),U=a(_e);Ma(U,{text:"Sphere Module",baseClass:"hidden 2xl:block"});var re=l(U,2);Ma(re,{text:"Module",baseClass:"block 2xl:hidden"});var pe=l(re,2);ya(pe,{itemGroup:"SphereModule",onCopyPaste:me=>F(me,e(I),!1),onUpdate:J,get slot(){return e(I)},set slot(me){d(I,me,!0)}}),t(_e),t(Ft);var T=l(Ft,2),ot=a(T);Ma(ot,{text:"Food"});var Me=l(ot,2),Xe=a(Me);Et(Xe,21,()=>Object.values(Q.slots),Nt,(me,$t,Ce)=>{ya(me,{itemGroup:"Food",onCopyPaste:ge=>F(ge,Q.slots[Ce],!1),onUpdate:J,get slot(){return Q.slots[Ce]},set slot(ge){Q.slots[Ce]=ge}})}),t(Xe),t(Me),t(T),t(p),t(ce);var z=l(ce,2),xe=a(z),Qe=a(xe),bt=a(Qe),Zt=a(bt);W(Zt,{position:"bottom",popup:$t=>{var Ce=yo(),ge=Z(Ce),It=a(ge),Xt=a(It);t(It);var nt=l(It,2),At=a(nt);t(nt),Qt(2),t(ge);var Se=l(ge,2),Kt=a(Se),pa=a(Kt);t(Kt);var wa=l(Kt,2),Ra=a(wa);t(wa),Qt(2),t(Se);var Va=l(Se,2),fa=a(Va),Ca=a(fa);t(fa);var Ja=l(fa,2),Sl=a(Ja);t(Ja),Qt(2),t(Va),q(()=>{B(Xt,"src",he.ctrlIcon),B(At,"src",he.leftClickIcon),B(pa,"src",he.ctrlIcon),B(Ra,"src",he.rightClickIcon),B(Ca,"src",he.ctrlIcon),B(Sl,"src",he.middleClickIcon)}),s($t,Ce)},children:($t,Ce)=>{var ge=xo();ge.__contextmenu=[bo],ge.__mousedown=[$o,de];var It=a(ge);ys(It,{class:"text-primary-500",size:16}),t(ge),s($t,ge)},$$slots:{popup:!0,default:!0}});var Wt=l(Zt,2),ra=l(a(Wt),2),Ot=a(ra);bs(Ot,{get value(){return o.selectedPlayer.level}}),t(ra),t(Wt);var qt=l(Wt,2);W(qt,{position:"bottom",popup:$t=>{var Ce=Po(),ge=Z(Ce),It=a(ge),Xt=a(It);t(It);var nt=l(It,2),At=a(nt);t(nt),Qt(2),t(ge);var Se=l(ge,2),Kt=a(Se),pa=a(Kt);t(Kt);var wa=l(Kt,2),Ra=a(wa);t(wa),Qt(2),t(Se);var Va=l(Se,2),fa=a(Va),Ca=a(fa);t(fa);var Ja=l(fa,2),Sl=a(Ja);t(Ja);var ql=l(Ja,2),ss=a(ql);t(ql),t(Va),q(()=>{B(Xt,"src",he.ctrlIcon),B(At,"src",he.leftClickIcon),B(pa,"src",he.ctrlIcon),B(Ra,"src",he.rightClickIcon),B(Ca,"src",he.ctrlIcon),B(Sl,"src",he.middleClickIcon),ne(ss,`Level ${e(g)??""}`)}),s($t,Ce)},children:($t,Ce)=>{var ge=Co();ge.__contextmenu=[ko],ge.__mousedown=[wo,Ge];var It=a(ge);cl(It,{class:"text-primary-500",size:16}),t(ge),s($t,ge)},$$slots:{popup:!0,default:!0}}),t(bt),t(Qe);var aa=l(Qe,2),oa=a(aa),na=a(oa),_a=a(na);_a.__click=Re;var Tt=a(_a);$s(Tt,{class:"h-4 w-4"}),t(_a);var Yt=l(_a,2);{let me=m(()=>new Date(o.selectedPlayer.last_online_time).toLocaleString());W(Yt,{get label(){return e(me)},children:($t,Ce)=>{var ge=So(),It=a(ge,!0);t(ge),q(()=>ne(It,o.selectedPlayer.nickname)),s($t,ge)},$$slots:{default:!0}})}t(na);var fe=l(na,2),Ct=a(fe),Dt=l(a(Ct),2),ea=a(Dt,!0);t(Dt),t(Ct);var Ia=l(Ct,2);xs(Ia,{get value(){return e(it)},get max(){return e(ft)},height:"h-2",width:"w-full",rounded:"rounded-none",showLabel:!1}),t(fe),t(oa),t(aa),t(xe);var Ea=l(xe,2);Ps(Ea,{get player(){return o.selectedPlayer},set player(me){o.selectedPlayer=me},get maxHp(){return e(dt)},set maxHp(me){d(dt,me,!0)}});var La=l(Ea,2);Jt(La,{get value(){return e(Ye)},onValueChange:me=>d(Ye,me.value,!0),collapsible:!0,children:(me,$t)=>{var Ce=Io(),ge=Z(Ce);{const Xt=At=>{Qt();var Se=va("Stats");s(At,Se)},nt=At=>{ks(At,{get player(){return o.selectedPlayer}})};at(ge,()=>Jt.Item,(At,Se)=>{Se(At,{value:"stats",controlHover:"hover:bg-secondary-500/25",control:Xt,panel:nt,$$slots:{control:!0,panel:!0}})})}var It=l(ge,4);{const Xt=At=>{Qt();var Se=va("Presets");s(At,Se)},nt=At=>{ws(At,{get containerRef(){return e(Oe)},get player(){return o.selectedPlayer},set player(Se){o.selectedPlayer=Se}})};at(It,()=>Jt.Item,(At,Se)=>{Se(At,{value:"presets",controlHover:"hover:bg-secondary-500/25",control:Xt,panel:nt,$$slots:{control:!0,panel:!0}})})}s(me,Ce)},$$slots:{default:!0}}),t(z),es(z,me=>d(Oe,me),()=>e(Oe)),t(f),t(c),q(()=>ne(ea,e(St))),s(x,c)},Rt=x=>{var c=Ao();s(x,c)};le(vt,x=>{o.selectedPlayer?x(Ut):x(Rt,!1)})}s(u,Pt),ha()}Ga(["click","contextmenu","mousedown"]);var Do=n('<div class="flex flex-col space-y-2"></div>'),Mo=(u,r)=>r("palbox"),jo=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Oo=(u,r)=>r(),To=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Bo=n('<div class="flex flex-col"><span>Select all in</span> <div class="grid grid-cols-[auto_1fr] gap-1"><img alt="Left Click" class="h-6 w-6"/> <span class="text-sm">pal box</span> <div class="flex"><img alt="Ctrl" class="h-6 w-6"/> <img alt="Left Click" class="h-6 w-6"/></div> <span class="text-sm">pal box + party</span></div></div>'),zo=(u,r)=>r(u),No=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Uo=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),qo=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Ko=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Fo=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Ho=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Go=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Ro=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Vo=(u,r)=>d(r,[],!0),Wo=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Xo=n("<!> <!> <!> <!> <!> <!>",1),Qo=n('<span class="font-bold">Filter & Sort</span>'),Jo=(u,r)=>r("level"),Yo=n('<button type="button"><!></button>'),Zo=(u,r)=>r("name"),en=n('<button type="button"><!></button>'),tn=(u,r)=>r("paldeck-index"),an=n('<button type="button"><!></button>'),ln=(u,r)=>d(r,"All"),sn=n("<button><!></button>"),rn=(u,r,o)=>d(r,e(o),!0),on=n('<button><img class="pal-element-badge svelte-olzjqy"/></button>'),nn=(u,r)=>d(r,"alpha"),cn=n('<button type="button"><img alt="Alpha" class="pal-element-badge svelte-olzjqy"/></button>'),dn=(u,r)=>d(r,"lucky"),vn=n('<button type="button"><img alt="Alpha" class="pal-element-badge svelte-olzjqy"/></button>'),un=(u,r)=>d(r,"human"),_n=n('<button type="button"><!></button>'),pn=(u,r)=>d(r,"predator"),fn=n('<button type="button"><img alt="Predator" class="pal-element-badge svelte-olzjqy"/></button>'),mn=(u,r)=>d(r,"oilrig"),gn=n('<button type="button"><img alt="Oil Rig" class="pal-element-badge svelte-olzjqy"/></button>'),hn=(u,r)=>d(r,"summon"),yn=n('<button type="button"><img alt="Summoned" class="pal-element-badge svelte-olzjqy"/></button>'),bn=n('<!> <div><legend class="font-bold">Sort</legend> <hr/> <div class="grid grid-cols-6"><!> <!> <!></div></div> <div><legend class="font-bold">Element & Type</legend> <hr/> <div class="mt-2 grid grid-cols-4 2xl:grid-cols-6"><!> <!> <!> <!> <!> <!> <!> <!></div></div>',1),$n=n('<span class="font-bold">Stats</span>'),xn=n("<div>No pals data available</div>"),Pn=n('<span class="font-bold">Party</span>'),kn=n("<!> <!> <!>",1),wn=n('<h4 class="h4 mb-2">Party</h4> <!>',1),Cn=n("<div>No pals data available</div>"),Sn=n('<div><div class="shrink-0 p-4"><nav class="btn-group bg-surface-900 mb-2 w-full items-center overflow-x-auto rounded-sm p-1"><!> <!> <!> <!> <!> <!></nav> <!> <!></div> <div><div class="mb-4 flex items-center justify-center space-x-4"><button class="rounded-sm px-4 py-2 font-bold"><img alt="Previous" class="h-10 w-10"/></button> <div class="flex space-x-2"></div> <button class="rounded-sm px-4 py-2 font-bold"><img alt="Next" class="h-10 w-10"/></button></div> <div class="overflow-hidden"><div class="grid grid-cols-6 place-items-center gap-4 p-4"></div></div></div> <!></div>'),In=n('<div class="flex w-full items-center justify-center"><h2 class="h2">Select a Player to view Pal Box</h2></div>');function En(u,r){ga(r,!0);const o=h=>{var K=Do();Et(K,21,()=>Object.values(e(ye)),Nt,(ce,De,Te)=>{Es(ce,{get pal(){return e(ye)[e(De).instance_id]},onSelect:vt,onMove:()=>je(e(De)),onDelete:()=>c(e(De)),onAdd:()=>ve("party",Te),onClone:()=>de(e(De)),onCloneToUps:()=>Re(e(De)),showCloneToUps:!0,get selected(){return e(C)},set selected(p){d(C,p,!0)}})}),t(K),s(h,K)},_=30,M=960,g=16,i=Sa(),L=Oa(),V=nl(),v=Dl();let se=hl(r,["$$slots","$$events","$$legacy"]),A=Be(""),Q=Be("All"),ae=Be(1),k=Be(Mt([])),C=Be(Mt([])),H=Be("slot-index"),I=Be("asc"),N=Be(Mt([""]));const ye=m(()=>{if(i.selectedPlayer&&i.selectedPlayer.pals){const h=i.selectedPlayer.otomo_container_id,K=Object.entries(i.selectedPlayer.pals).filter(([De,Te])=>Te.storage_id===h),ce=Array(5).fill(null).map((De,Te)=>{const p=K.find(([w,S])=>S.storage_slot===Te);return p||[`empty-${Te}`,{character_key:"None"}]});return Object.fromEntries(ce)}}),Ye=m(()=>Math.ceil(e(A)||e(Q)!=="All"||e(H)!=="slot-index"?e(k).length:M)/_),Oe=m(()=>Math.max(1,Math.min(e(ae)-Math.floor(g/2),e(Ye)-g+1))),dt=m(()=>Math.min(e(Oe)+g-1,e(Ye))),lt=m(()=>Array.from({length:e(dt)-e(Oe)+1},(h,K)=>e(Oe)+K)),Ke=m(()=>{const h=(e(ae)-1)*_,K=h+_;return e(A)||e(Q)!=="All"||e(H)!=="slot-index"?e(k).slice(h,K):Array(M).fill(void 0).map((De,Te)=>{const p=e(k).find(w=>w.pal.storage_slot===Te);return p||{id:`empty-${Te}`,pal:{character_id:"None",character_key:"None",storage_slot:Te,instance_id:`empty-${Te}`,storage_id:i.selectedPlayer?.pal_box_id}}}).slice(h,K)}),Fe=m(()=>Bt("btn",e(Q)==="lucky"?"bg-secondary-500/25":"")),St=m(()=>Bt("btn",e(Q)==="alpha"?"bg-secondary-500/25":"")),it=m(()=>Bt("btn",e(Q)==="human"?"bg-secondary-500/25":"")),ft=m(()=>Bt("btn",e(Q)==="predator"?"bg-secondary-500/25":"")),G=m(()=>Bt("btn",e(Q)==="oilrig"?"bg-secondary-500/25":"")),D=m(()=>Bt("btn",e(Q)==="summon"?"bg-secondary-500/25":"")),b=h=>Bt("btn",e(H)===h?"bg-secondary-500/25":""),O=h=>Bt("btn",e(Q)===h?"bg-secondary-500/25":""),R=m(()=>{if(!i.selectedPlayer||!i.selectedPlayer.pals)return;const h=Object.entries(i.selectedPlayer.pals),K=i.selectedPlayer.pal_box_id;return h.filter(([ce,De])=>De.storage_id===K).map(([ce,De])=>{const Te=da.getByKey(De.character_key);return{id:ce,pal:De,palData:Te}})}),ee=m(()=>Object.keys(ba.elements)),te=m(()=>{let h={};for(const K of e(ee)){const ce=ba.elements[K];ce&&(h[K]=sa.loadImage(`${ca}/img/${ce.icon}.webp`))}return h}),y=m(()=>e(H)!=="level"?ll:e(I)==="asc"?ll:Ol),P=m(()=>e(H)!=="name"?sl:e(I)==="asc"?sl:Tl),X=m(()=>e(H)!=="paldeck-index"?rl:e(I)==="asc"?rl:zl);function ie(h){h.target instanceof HTMLInputElement||(h.key==="ArrowLeft"||h.key==="q"||h.key==="Q"?Je():(h.key==="ArrowRight"||h.key==="e"||h.key==="E")&&We())}function Je(){e(ae)>1?Fa(ae,-1):d(ae,e(Ye),!0)}function We(){e(ae)<e(Ye)?Fa(ae):d(ae,1)}const Ue=bl($,300);function Pe(h){i.selectedPlayer&&Ht(Gt.MOVE_PAL,{player_id:i.selectedPlayer.uid,pal_id:h.instance_id,container_id:i.selectedPlayer.otomo_container_id})}function je(h){i.selectedPlayer&&Ht(Gt.MOVE_PAL,{player_id:i.selectedPlayer.uid,pal_id:h.instance_id,container_id:i.selectedPlayer.pal_box_id})}async function $(){e(R)&&(d(k,e(R).filter(({pal:h,palData:K})=>{if(!K)return!1;const ce=h.name.toLowerCase().includes(e(A).toLowerCase())||h.nickname?.toLowerCase().includes(e(A).toLowerCase())||h.character_id.toLowerCase().includes(e(A).toLowerCase()),De=e(ee).includes(e(Q))?K.element_types.map(ht=>ht.toString().toLowerCase()).includes(e(Q).toLowerCase()):!0,Te=e(Q)==="alpha"?h.is_boss:!0,p=e(Q)==="lucky"?h.is_lucky:!0,w=e(Q)==="human"?!K?.is_pal:!0,S=e(Q)==="predator"?h.character_id.toLowerCase().includes("predator_"):!0,j=e(Q)==="oilrig"?h.character_id.toLowerCase().includes("_oilrig"):!0,Ie=e(Q)==="summon"?h.character_id.toLowerCase().includes("summon_"):!0;return ce&&De&&Te&&p&&w&&S&&j&&Ie}),!0),J())}function F(h){e(H)===h?e(I)==="desc"?(d(H,"slot-index"),d(I,"asc")):d(I,e(I)==="asc"?"desc":"asc",!0):(d(H,h,!0),d(I,"asc")),J()}function J(){switch(e(H)){case"name":be();break;case"level":$e();break;case"paldeck-index":Ze();break;default:rt();break}}async function ve(h,K=void 0){if(!i.selectedPlayer)return;const ce=await L.showModal(Pl,{title:`Add a new Pal to your ${h==="party"?"Party":"Pal Box"}`});if(!ce)return;const[De,Te]=ce,p=da.getByKey(De),w=h==="party"?i.selectedPlayer.otomo_container_id:i.selectedPlayer.pal_box_id;Ht(Gt.ADD_PAL,{player_id:i.selectedPlayer.uid,character_id:De,nickname:Te||Ha(p?.localized_name||De,i.settings.new_pal_prefix),container_id:w,storage_slot:K})}function be(){d(k,e(k).sort((h,K)=>e(I)==="asc"?h.pal.name.localeCompare(K.pal.name):K.pal.name.localeCompare(h.pal.name)),!0)}function $e(){d(k,e(k).sort((h,K)=>e(I)==="asc"?h.pal.level-K.pal.level:K.pal.level-h.pal.level),!0)}function rt(){d(k,e(k).sort((h,K)=>e(I)==="asc"?h.pal.storage_slot-K.pal.storage_slot:K.pal.storage_slot-h.pal.storage_slot),!0)}async function Ze(){const h=e(k).map(ce=>da.getByKey(ce.pal.character_key)),K=e(k).map((ce,De)=>[ce,h[De]]);K.sort((ce,De)=>{const Te=ce[1]?.pal_deck_index??1/0,p=De[1]?.pal_deck_index??1/0;return e(I)==="asc"?Te-p:p-Te}),d(k,K.map(ce=>ce[0]),!0)}async function qe(h){const K=i.selectedPlayer.pals?965-Object.values(i.selectedPlayer.pals).length:0;if(K===0){V.add("There are no slots available in your Pal box.","Error","error");return}const ce=await L.showModal(il,{title:"How many clones?",message:`There are ${K} slots available in your Pal box.`,value:1,min:0,max:K});if(ce)for(let De=0;De<ce;De++){const Te=Qa(h);Te.nickname=Ha(Te.nickname||Te.name||Te.character_id,i.settings.clone_prefix),Ht(Gt.CLONE_PAL,{pal:Te})}}async function Ge(){if(i.selectedPlayer&&i.selectedPlayer.pals){const h=i.selectedPlayer.pals[e(C)[0]];if(!h)return;await qe(h)}}async function de(h){await qe(h)}async function Re(h){const K=await L.showModal(al,{title:"Clone to UPS",message:"Clone this Pal to your Universal Pal Storage.",pals:[h]});if(!K)return;const{collectionId:ce,tags:De,notes:Te}=K;try{await v.cloneToUps([h.instance_id],"pal_box",i.selectedPlayer?.uid,ce,De.length>0?De:void 0,Te||void 0),V.add(`Successfully cloned ${h.nickname||h.name} to UPS`,"Success","success")}catch(p){console.error("Clone to UPS failed:",p),V.add("Clone to UPS failed. Please try again.","Error","error")}}async function Pt(){if(e(C).length===0)return;const h=e(C).map(p=>i.selectedPlayer?.pals?.[p]).filter(Boolean);if(h.length===0)return;const K=await L.showModal(al,{title:"Clone to UPS",message:`Clone ${h.length} selected Pals to your Universal Pal Storage.`,pals:h});if(!K)return;const{collectionId:ce,tags:De,notes:Te}=K;try{await v.cloneToUps(e(C),"pal_box",i.selectedPlayer?.uid,ce,De.length>0?De:void 0,Te||void 0),V.add(`Successfully cloned ${h.length} Pals to UPS`,"Success","success"),d(C,[],!0)}catch(p){console.error("Bulk clone to UPS failed:",p),V.add("Bulk clone to UPS failed. Please try again.","Error","error")}}function vt(h,K){!h||h.character_id==="None"||(K.ctrlKey||K.metaKey)&&(e(C).includes(h.instance_id)?d(C,e(C).filter(ce=>ce!==h.instance_id),!0):d(C,[...e(C),h.instance_id],!0))}async function Ut(){!i.selectedPlayer||!i.selectedPlayer.pals||e(C).length!==0&&(Ht(Gt.HEAL_PALS,[...e(C)]),Object.values(i.selectedPlayer.pals).forEach(async h=>{if(e(C).includes(h.instance_id)){h.hp=h.max_hp,h.sanity=100;const K=da.getByKey(h.character_key);K&&(h.stomach=K.max_full_stomach)}}),d(C,[],!0))}async function Rt(){if(!(!i.selectedPlayer||!i.selectedPlayer.pals)&&e(C).length!==0){for(const h of e(C)){const K=i.selectedPlayer.pals[h];Ls(K,i.selectedPlayer)}await i.saveState()}}async function x(){if(e(C).length===0)return;const h=await L.showConfirmModal({title:`Delete Pal${e(C).length>1?"s":""}`,message:`Are you sure you want to delete the ${e(C).length} selected pal${e(C).length==1?"":"s"}?`,confirmText:"Delete",cancelText:"Cancel"});i.selectedPlayer&&i.selectedPlayer.pals&&h&&(Ht(Gt.DELETE_PALS,{player_id:i.selectedPlayer.uid,pal_ids:[...e(C)]}),i.selectedPlayer.pals=Object.fromEntries(Object.entries(i.selectedPlayer.pals).filter(([K])=>!e(C).includes(K)))),d(C,[],!0)}async function c(h){const K=await L.showConfirmModal({title:"Delete Pal",message:`Are you sure you want to delete ${h.nickname||h.name}?`,confirmText:"Delete",cancelText:"Cancel"});i.selectedPlayer&&i.selectedPlayer.pals&&K&&(Ht(Gt.DELETE_PALS,{player_id:i.selectedPlayer.uid,pal_ids:[h.instance_id]}),i.selectedPlayer.pals=Object.fromEntries(Object.entries(i.selectedPlayer.pals).filter(([ce])=>ce!==h.instance_id)))}function f(h){if(h.ctrlKey||h.metaKey){const K=Object.values(e(ye)).filter(ce=>ce.character_id!=="None").map(ce=>ce.instance_id);e(C).length===e(k).length+K.length?d(C,[],!0):d(C,[...e(k).map(ce=>ce.id),...K],!0)}else e(C).length===e(k).length?d(C,[],!0):d(C,e(k).map(K=>K.id),!0)}zt(()=>{i.selectedPlayer&&i.selectedPlayer.pals&&Ue()}),zt(()=>{(e(A)||e(Q))&&Ue()}),zt(()=>{(i.selectedPal&&i.selectedPal.level||i.selectedPal&&i.selectedPal.nickname)&&Ue()}),zt(()=>(window.addEventListener("keydown",ie),()=>{window.removeEventListener("keydown",ie)})),zt(()=>{e(ae)>e(Ye)&&d(ae,1)}),zt(()=>{e(R)&&Ue()});function E(){!i.selectedPlayer||!i.selectedPlayer.pals||(Ht(Gt.HEAL_ALL_PALS,{player_id:i.selectedPlayer.uid}),Object.values(i.selectedPlayer.pals).forEach(h=>{h.hp=h.max_hp,h.sanity=100,h.is_sick=!1;const K=da.getByKey(h.character_key);K&&(h.stomach=K.max_full_stomach)}))}async function Y(){const h=e(C).map(p=>{const w=e(R)?.find(S=>S.id===p);return{character_id:w?.pal.character_id,character_key:w?.pal.character_key}}),K=e(C).map(p=>{const w=e(ye)[p];return{character_id:w?.character_id,character_key:w?.character_key}}),ce=[...h,...K],De=await L.showModal(Cl,{title:"Select preset",selectedPals:ce});if(!De)return;const Te=Ka.presetProfiles[De];e(C).forEach(p=>{const w=e(R)?.find(j=>j.id===p);w&&gl(w.pal,Te,i.selectedPlayer);const S=e(ye)[p];S&&gl(S,Te,i.selectedPlayer)})}async function Le(){i.selectedPlayer&&await L.showModal(Ll,{title:"Fill Pal Box",player:i.selectedPlayer,target:"pal-box"})}var mt=Ne(),ta=Z(mt);{var ua=h=>{var K=Sn();yl(K,()=>({class:"grid h-full w-full grid-cols-[25%_1fr] 2xl:grid-cols-[25%_1fr_20%]",...se}),void 0,void 0,"svelte-olzjqy");var ce=a(K),De=a(ce),Te=a(De);W(Te,{position:"right",label:"Add a new pal to your Pal Box",children:(Ee,He)=>{var we=jo();we.__click=[Mo,ve];var Ae=a(we);cl(Ae,{class:"h-4 w-4"}),t(we),s(Ee,we)},$$slots:{default:!0}});var p=l(Te,2);W(p,{position:"right",label:"Add all pals to your Pal Box",children:(Ee,He)=>{var we=To();we.__click=[Oo,Le];var Ae=a(we);Nl(Ae,{class:"h-4 w-4"}),t(we),s(Ee,we)},$$slots:{default:!0}});var w=l(p,2);W(w,{popup:He=>{var we=Bo(),Ae=l(a(we),2),Ve=a(Ae),oe=l(Ve,4),_e=a(oe),U=l(_e,2);t(oe),Qt(2),t(Ae),t(we),q(()=>{B(Ve,"src",he.leftClickIcon),B(_e,"src",he.ctrlIcon),B(U,"src",he.leftClickIcon)}),s(He,we)},children:(He,we)=>{var Ae=No();Ae.__click=[zo,f];var Ve=a(Ae);xl(Ve,{class:"h-4 w-4"}),t(Ae),s(He,Ae)},$$slots:{popup:!0,default:!0}});var S=l(w,2);W(S,{label:"Heal all in pal box",children:(Ee,He)=>{var we=Uo();we.__click=E;var Ae=a(we);ls(Ae,{class:"h-4 w-4"}),t(we),s(Ee,we)},$$slots:{default:!0}});var j=l(S,2);{var Ie=Ee=>{W(Ee,{label:"Clone selected pal",children:(He,we)=>{var Ae=qo();Ae.__click=Ge;var Ve=a(Ae);As(Ve,{class:"h-4 w-4"}),t(Ae),s(He,Ae)},$$slots:{default:!0}})};le(j,Ee=>{e(C).length===1&&Ee(Ie)})}var ht=l(j,2);{var kt=Ee=>{var He=Xo(),we=Z(He);W(we,{label:"Apply preset to selected pal(s)",children:(re,pe)=>{var T=Ko();T.__click=Y;var ot=a(T);el(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var Ae=l(we,2);W(Ae,{label:"Clone selected pal(s) to UPS",children:(re,pe)=>{var T=Fo();T.__click=Pt;var ot=a(T);Ml(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var Ve=l(Ae,2);W(Ve,{label:"Heal selected pal(s)",children:(re,pe)=>{var T=Ho();T.__click=Ut;var ot=a(T);as(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var oe=l(Ve,2);W(oe,{label:"Max out selected pal(s)",children:(re,pe)=>{var T=Go();T.__click=Rt;var ot=a(T);fl(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var _e=l(oe,2);W(_e,{label:"Delete selected pal(s)",children:(re,pe)=>{var T=Ro();T.__click=x;var ot=a(T);tl(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var U=l(_e,2);W(U,{label:"Clear selected pal(s)",children:(re,pe)=>{var T=Wo();T.__click=[Vo,C];var ot=a(T);kl(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}}),s(Ee,He)};le(ht,Ee=>{e(C).length>=1&&Ee(kt)})}t(De);var et=l(De,2);Jt(et,{get value(){return e(N)},onValueChange:Ee=>d(N,Ee.value,!0),collapsible:!0,children:(Ee,He)=>{var we=kn(),Ae=Z(we);{const _e=pe=>{jl(pe,{})},U=pe=>{var T=Qo();s(pe,T)},re=pe=>{var T=bn(),ot=Z(T);za(ot,{type:"text",inputClass:"w-full",placeholder:"Search by name or nickname",get value(){return e(A)},set value(Tt){d(A,Tt,!0)}});var Me=l(ot,2),Xe=l(a(Me),4),z=a(Xe);W(z,{label:"Sort by level",children:(Tt,Yt)=>{var fe=Yo();fe.__click=[Jo,F];var Ct=a(fe);at(Ct,()=>e(y),(Dt,ea)=>{ea(Dt,{})}),t(fe),q(Dt=>st(fe,1,Dt,"svelte-olzjqy"),[()=>pt(b("level"))]),s(Tt,fe)},$$slots:{default:!0}});var xe=l(z,2);W(xe,{label:"Sort by name",children:(Tt,Yt)=>{var fe=en();fe.__click=[Zo,F];var Ct=a(fe);at(Ct,()=>e(P),(Dt,ea)=>{ea(Dt,{})}),t(fe),q(Dt=>st(fe,1,Dt,"svelte-olzjqy"),[()=>pt(b("name"))]),s(Tt,fe)},$$slots:{default:!0}});var Qe=l(xe,2);W(Qe,{label:"Sort by Paldeck #",children:(Tt,Yt)=>{var fe=an();fe.__click=[tn,F];var Ct=a(fe);at(Ct,()=>e(X),(Dt,ea)=>{ea(Dt,{})}),t(fe),q(Dt=>st(fe,1,Dt,"svelte-olzjqy"),[()=>pt(b("paldeck-index"))]),s(Tt,fe)},$$slots:{default:!0}}),t(Xe),t(Me);var bt=l(Me,2),Zt=l(a(bt),4),Wt=a(Zt);W(Wt,{popup:Yt=>{Qt();var fe=va("All pals");s(Yt,fe)},children:(Yt,fe)=>{var Ct=sn();Ct.__click=[ln,Q];var Dt=a(Ct);Ul(Dt,{}),t(Ct),q(ea=>st(Ct,1,ea,"svelte-olzjqy"),[()=>pt(O("All"))]),s(Yt,Ct)},$$slots:{popup:!0,default:!0}});var ra=l(Wt,2);Et(ra,17,()=>[...e(ee)],Nt,(Tt,Yt)=>{const fe=m(()=>ba.getByKey(e(Yt))?.localized_name);W(Tt,{get label(){return e(fe)},children:(Ct,Dt)=>{var ea=on();ea.__click=[rn,Q,Yt];var Ia=a(ea);t(ea),q(Ea=>{st(ea,1,Ea,"svelte-olzjqy"),B(ea,"aria-label",e(fe)),B(Ia,"src",e(te)[e(Yt)]),B(Ia,"alt",e(fe))},[()=>pt(O(e(Yt)))]),s(Ct,ea)},$$slots:{default:!0}})});var Ot=l(ra,2);W(Ot,{label:"Alpha Pals",children:(Tt,Yt)=>{var fe=cn();fe.__click=[nn,Q];var Ct=a(fe);t(fe),q(()=>{st(fe,1,pt(e(St)),"svelte-olzjqy"),B(Ct,"src",he.alphaIcon)}),s(Tt,fe)},$$slots:{default:!0}});var qt=l(Ot,2);W(qt,{label:"Lucky Pals",children:(Tt,Yt)=>{var fe=vn();fe.__click=[dn,Q];var Ct=a(fe);t(fe),q(()=>{st(fe,1,pt(e(Fe)),"svelte-olzjqy"),B(Ct,"src",he.luckyIcon)}),s(Tt,fe)},$$slots:{default:!0}});var aa=l(qt,2);W(aa,{label:"Humans",children:(Tt,Yt)=>{var fe=_n();fe.__click=[un,Q];var Ct=a(fe);dl(Ct,{}),t(fe),q(()=>st(fe,1,pt(e(it)),"svelte-olzjqy")),s(Tt,fe)},$$slots:{default:!0}});var oa=l(aa,2);W(oa,{label:"Predator Pals",children:(Tt,Yt)=>{var fe=fn();fe.__click=[pn,Q];var Ct=a(fe);t(fe),q(Dt=>{st(fe,1,pt(e(ft)),"svelte-olzjqy"),B(Ct,"src",he.predatorIcon),Xa(Ct,`filter: ${Dt??""};`)},[()=>qa("#FF0000")]),s(Tt,fe)},$$slots:{default:!0}});var na=l(oa,2);W(na,{label:"Oil Rig Pals",children:(Tt,Yt)=>{var fe=gn();fe.__click=[mn,Q];var Ct=a(fe);t(fe),q(()=>{st(fe,1,pt(e(G)),"svelte-olzjqy"),B(Ct,"src",he.oilrigIcon)}),s(Tt,fe)},$$slots:{default:!0}});var _a=l(na,2);W(_a,{label:"Summoned Pals",children:(Tt,Yt)=>{var fe=yn();fe.__click=[hn,Q];var Ct=a(fe);t(fe),q(()=>{st(fe,1,pt(e(D)),"svelte-olzjqy"),B(Ct,"src",he.altarIcon)}),s(Tt,fe)},$$slots:{default:!0}}),t(Zt),t(bt),s(pe,T)};at(Ae,()=>Jt.Item,(pe,T)=>{T(pe,{value:"filter",base:"rounded-sm bg-surface-900",controlHover:"hover:bg-secondary-500/25",lead:_e,control:U,panel:re,$$slots:{lead:!0,control:!0,panel:!0}})})}var Ve=l(Ae,2);{const _e=pe=>{Bl(pe,{})},U=pe=>{var T=$n();s(pe,T)},re=pe=>{var T=Ne(),ot=Z(T);{var Me=z=>{ol(z,{get pals(){return e(R)},get elementTypes(){return e(ee)}})},Xe=z=>{var xe=xn();s(z,xe)};le(ot,z=>{e(R)&&e(R).length>0?z(Me):z(Xe,!1)})}s(pe,T)};at(Ve,()=>Jt.Item,(pe,T)=>{T(pe,{value:"stats",base:"block 2xl:hidden rounded-sm bg-surface-900",controlHover:"hover:bg-secondary-500/25",lead:_e,control:U,panel:re,$$slots:{lead:!0,control:!0,panel:!0}})})}var oe=l(Ve,2);{const _e=pe=>{dl(pe,{})},U=pe=>{var T=Pn();s(pe,T)},re=pe=>{o(pe)};at(oe,()=>Jt.Item,(pe,T)=>{T(pe,{value:"party",base:"block 2xl:hidden rounded-sm bg-surface-900",controlHover:"hover:bg-secondary-500/25",lead:_e,control:U,panel:re,$$slots:{lead:!0,control:!0,panel:!0}})})}s(Ee,we)},$$slots:{default:!0}});var ue=l(et,2);Ua(ue,{rounded:"rounded-sm",class:"mt-2 hidden 2xl:block",children:(Ee,He)=>{var we=wn(),Ae=l(Z(we),2);o(Ae),s(Ee,we)},$$slots:{default:!0}}),t(ce);var ze=l(ce,2),ut=a(ze),jt=a(ut);jt.__click=Je;var Vt=a(jt);t(jt);var yt=l(jt,2);Et(yt,21,()=>e(lt),Nt,(Ee,He)=>{{let we=m(()=>e(He)===e(ae)?"bg-primary-500 text-white":"bg-surface-800 hover:bg-gray-300"),Ae=m(()=>`Box ${e(He)}`);Na(Ee,{get class(){return`h-8 w-8 rounded-full ${e(we)??""}`},onclick:()=>d(ae,e(He),!0),get popupLabel(){return e(Ae)},children:(Ve,oe)=>{Qt();var _e=va();q(U=>ne(_e,U),[()=>Math.floor(e(He))]),s(Ve,_e)},$$slots:{default:!0}})}}),t(yt);var Ft=l(yt,2);Ft.__click=We;var tt=a(Ft);t(Ft),t(ut);var ke=l(ut,2),_t=a(ke);Et(_t,21,()=>e(Ke),Ee=>Ee.pal.instance_id,(Ee,He)=>{var we=Ne(),Ae=Z(we);{var Ve=oe=>{wl(oe,{get pal(){return e(He).pal},onSelect:vt,onMove:()=>Pe(e(He).pal),onDelete:()=>c(e(He).pal),onAdd:()=>ve("palbox",e(He).pal.storage_slot),onClone:()=>de(e(He).pal),onCloneToUps:()=>Re(e(He).pal),get selected(){return e(C)},set selected(_e){d(C,_e,!0)}})};le(Ae,oe=>{(e(He).pal.character_id!=="None"||!e(A)&&e(Q)==="All"&&e(H)==="slot-index")&&oe(Ve)})}s(Ee,we)}),t(_t),t(ke),t(ze);var ct=l(ze,2);{var Lt=Ee=>{Ua(Ee,{class:"mr-2 hidden h-[430px] 2xl:block",children:(He,we)=>{ol(He,{get pals(){return e(R)},get elementTypes(){return e(ee)}})},$$slots:{default:!0}})},wt=Ee=>{Ua(Ee,{class:"mr-2 hidden h-[430px] 2xl:block",children:(He,we)=>{var Ae=Cn();s(He,Ae)},$$slots:{default:!0}})};le(ct,Ee=>{e(R)&&e(R).length>0?Ee(Lt):Ee(wt,!1)})}t(K),q(()=>{B(Vt,"src",he.qIcon),B(tt,"src",he.eIcon)}),s(h,K)},gt=h=>{var K=In();s(h,K)};le(ta,h=>{i.selectedPlayer?h(ua):h(gt,!1)})}s(u,mt),ha()}Ga(["click"]);async function An(u,r,o,_,M){if(e(r).length===0)return;if(await o.showConfirmModal({title:`Delete Pal${e(r).length>1?"s":""}`,message:`Are you sure you want to delete the ${e(r).length} selected pal${e(r).length==1?"":"s"}?`,confirmText:"Delete",cancelText:"Cancel"})){const i=e(_)?e(_)[0]:"";Ht(Gt.DELETE_PALS,{guild_id:e(M)?.id,base_id:i,pal_ids:e(r)}),e(M).bases[i].pals=Object.fromEntries(Object.entries(e(M).bases[i].pals).filter(([L])=>!e(r).includes(L)))}d(r,[],!0)}function Ln(u,r,o){if(!e(r))return;const[_,M]=e(r),g=Object.values(M.pals).map(i=>i.instance_id);e(o).length===g.length?d(o,[],!0):d(o,[...g],!0)}async function Dn(u,r,o){!e(r)||e(o).length===0||(Ht(Gt.HEAL_PALS,[...e(o)]),Object.values(e(r)).forEach(_=>{Object.values(_.pals).forEach(M=>{if(e(o).includes(M.instance_id)){M.hp=M.max_hp,M.sanity=100;const g=da.getByKey(M.character_key);g&&(M.stomach=g.max_full_stomach)}})}),d(o,[],!0))}function Mn(u,r,o,_){!e(r)||!e(o)||!e(_)||(Ht(Gt.HEAL_ALL_PALS,{guild_id:e(o).id,base_id:e(_)[0]}),Object.values(e(r)).forEach(M=>{Object.values(M.pals).forEach(g=>{g.hp=g.max_hp,g.sanity=100,g.is_sick=!1;const i=da.getByKey(g.character_key);i&&(g.stomach=i.max_full_stomach)})}))}async function jn(u,r,o,_){const M=e(r).map(L=>{const V=Object.values(e(o)[1].pals).find(v=>v.instance_id===L);return{character_id:V?.character_id,character_key:V?.character_key}}),g=await _.showModal(Cl,{title:"Select preset",selectedPals:M});if(!g)return;const i=Ka.presetProfiles[g];e(r).forEach(L=>{const V=Object.values(e(o)[1].pals).find(v=>v.instance_id===L);if(V){for(const[v,se]of Object.entries(i.pal_preset))v!=="character_id"&&(v==="lock"&&se?V.character_id=i.pal_preset?.character_id:se&&(V[v]=se));V.state=xt.MODIFIED}})}async function On(u,r,o,_){if(!e(r))return;const M=await o.showModal($l,{title:"Edit Base Name",value:e(r)[1].name||""});M&&(e(r)[1].name=M,e(_).state=xt.MODIFIED)}async function Tn(u,r,o){const _=await r.showModal($l,{title:"Edit Guild Name",value:e(o).name});_&&(e(o).name=_,e(o).state=xt.MODIFIED)}async function Bn(u,r,o){await r.showConfirmModal({title:"Delete Guild",message:"Are you sure you want to delete this guild? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel"})&&(Ht(Gt.DELETE_GUILD,{guild_id:e(o)?.id,origin:"edit"}),Zl("/loading"))}var zn=n('<div class="flex w-full items-center justify-center"><h2 class="h2">No Guild found</h2></div>'),Nn=n('<div class="flex w-full items-center justify-center space-x-4"><h2 class="h2">No Guild Bases found</h2> <img alt="Sad" class="h-18 w-18"/></div>'),Un=n('<button class="btn ml-4 h-8 w-8 p-2 hover:bg-red-500/50"><!></button>'),qn=(u,r,o,_)=>{d(r,"pals"),d(o,""),d(_,"")},Kn=(u,r,o,_)=>{d(r,"storage"),d(o,""),d(_,"")},Fn=(u,r,o,_)=>{d(r,""),d(o,""),_()},Hn=(u,r,o,_)=>{d(r,""),d(o,""),d(_,"lab")},Gn=(u,r,o)=>e(r)&&o(e(r)[0]),Rn=n('<button class="btn hover:bg-secondary-500/50 p-2"><!></button>'),Vn=n('<button class="btn hover:bg-secondary-500/50 p-2"><!></button>'),Wn=n('<button class="btn hover:bg-secondary-500/50 p-2"><!></button>'),Xn=n('<button class="btn hover:bg-secondary-500/50 p-2"><!></button>'),Qn=n('<button class="btn hover:bg-secondary-500/50 p-2"><!></button>'),Jn=n('<button class="btn hover:bg-secondary-500/50 p-2"><!></button>'),Yn=(u,r)=>d(r,[],!0),Zn=n('<button class="btn hover:bg-secondary-500/50 p-2"><!></button>'),ei=n("<!> <!> <!> <!>",1),ti=n('<div class="btn-group bg-surface-900 w-full items-center rounded-sm p-1"><!> <!> <!> <!></div>'),ai=(u,r,o)=>{d(r,""),d(o,"")},li=n('<div class="h-8 w-8"></div> <span class="font-bold">Inventory</span> <span class="font-bold">Total</span>',1),si=n('<div class="grid w-full grid-cols-[auto_1fr_auto] gap-2"><div><img class="h-8 w-8"/></div> <span> </span> <span> </span></div>'),ri=n('<div class="grid w-full grid-cols-[auto_1fr_auto] gap-2"><img class="h-8 w-8"/> <span> </span> <span> </span></div>'),oi=n('<div class="grid w-full grid-cols-[auto_1fr_auto] gap-2"><img class="h-8 w-8"/> <span> </span> <span> </span></div>'),ni=n('<div class="grid w-full grid-cols-2 gap-2"><span class="font-bold"> </span> <span> </span></div>'),ii=n('<div class="flex flex-col"><span class="font-bold"> </span> <span class="text-sm"> </span> <hr class="border-surface-500 my-2"/> <span class="font-bold"> </span> <!></div>'),ci=n('<div class="flex items-center"><!> <button class="btn"><!></button></div> <!>',1),di=n('<div class="mb-4 flex items-center justify-center space-x-4"><button class="rounded-sm px-4 py-2 font-bold"><img alt="Previous" class="h-10 w-10"/></button> <div class="flex space-x-2"></div> <button class="rounded-sm px-4 py-2 font-bold"><img alt="Next" class="h-10 w-10"/></button></div>'),vi=n('<div class="overflow-hidden"><div class="grid grid-cols-6 place-items-center gap-4 p-4"></div></div>'),ui=n('<div class="grid grid-cols-[auto_1fr] gap-2"><img class="h-8 w-8"/> <span> </span></div>'),_i=n('<div class="grid grid-cols-[auto_1fr] gap-2"><img class="h-8 w-8"/> <span> </span></div>'),pi=n('<div class="flex flex-col"><h4 class="h4"> </h4> <div class="grid w-full grid-cols-2 gap-2"><span class="font-bold">Available Slots:</span> <span> </span></div> <div class="grid w-full grid-cols-2 gap-2"><span class="font-bold">Used Slots:</span> <span> </span></div></div>'),fi=n('<div class="ml-2 flex flex-col"><img alt="Storage Container Icon" class="h-48 w-48 2xl:h-64 2xl:w-64"/> <!></div>'),mi=n('<div class="flex items-start space-x-4"><div class="m-1 grid grid-cols-6 gap-2"></div> <!></div>'),gi=n('<div class="flex w-full items-center justify-center"><h2 class="h2">Select a Storage Container</h2></div>'),hi=n('<div class="flex space-x-4"><!> <div class="max-h-[550px] overflow-y-auto 2xl:max-h-[800px]"><!></div></div>'),yi=n('<div class="flex w-full items-center justify-center"><h2 class="h2">No Storage Containers</h2></div>'),bi=n('<div class="ml-4 flex flex-col"><img alt="Storage Container Icon" class="ml-8 h-48 w-48 2xl:h-64 2xl:w-64"/> <!></div>'),$i=n('<div class="max-h-[550px] overflow-y-auto 2xl:max-h-[800px]"><div class="flex items-start space-x-4"><div class="m-1 grid grid-cols-6 gap-2"></div> <!></div></div>'),xi=n('<div class="h-full w-full"><!></div>'),Pi=n('<div class="grid h-full w-full grid-cols-[25%_1fr]"><div class="shrink-0 space-y-2 p-4"><div class="flex"><button class="btn px-0 text-start"><h4 class="h4 hover:text-secondary-500"> </h4></button> <!> <!></div> <div class="flex flex-col"><div class="flex"><h5 class="h5 font-light"> </h5> <!></div> <div class="flex"><button class="btn px-0"><h5 class="h5 hover:text-secondary-500 font-light"> </h5></button></div></div> <nav class="btn-group preset-outlined-surface-200-800 w-full flex-col rounded-sm p-2 md:flex-row"><button><span>Pals</span></button> <button><span>Storage</span></button> <button><span>Chest</span></button> <button><span>Lab</span></button></nav> <!> <!> <!></div> <div><!> <!></div></div>'),ki=n('<div class="flex w-full items-center justify-center"><h2 class="h2">Select a Player to view Guilds</h2></div>');function wi(u,r){ga(r,!0);const o=Sa(),_=Oa(),M=nl(),g=16;let i=Be(Mt([])),L=Be(1);Be(Mt([]));let V=Be("pals"),v=Be(void 0),se=Be(""),A=Be(""),Q=Be("Handcraft"),ae=Be(null);const k=m(()=>{if(o.selectedPlayer?.guild_id)return o.guilds[o.selectedPlayer.guild_id]}),C=m(()=>{if(!e(k)?.guild_chest)return null;const $=Ba.getByKey("GuildChest");return $?sa.loadImage(`${ca}/img/${$.icon}.webp`):he.unknownIcon}),H=m(()=>{if(e(k))return e(k).bases}),I=m(()=>Object.keys(e(H)||{}).length),N=m(()=>Math.max(1,Math.min(e(L)-Math.floor(g/2),e(I)-g+1))),ye=m(()=>Math.min(e(N)+g-1,e(I))),Ye=m(()=>Array.from({length:e(ye)-e(N)+1},($,F)=>e(N)+F)),Oe=m(()=>e(H)&&Object.entries(e(H))[e(L)-1]||null),dt=["None","Empty","TreasureBox","PalEgg","CommonDropItem"],lt=m(()=>{if(!e(Oe))return null;const[$,F]=e(Oe);return Object.values(F.storage_containers).filter(J=>J.slot_num!==0&&!dt.some(ve=>J.key.includes(ve))).filter(J=>J.slots.some(ve=>{const be=ia.getByKey(ve.static_id);return ve.static_id.toLowerCase().includes(e(se).toLowerCase())||be&&be.info.localized_name.toLowerCase().includes(e(se).toLowerCase())})&&J.slots.some(ve=>{const be=ia.getByKey(ve.static_id);return ve.static_id.toLowerCase().includes(e(A).toLowerCase())||be&&be.info.localized_name.toLowerCase().includes(e(A).toLowerCase())})||J.slots.every(ve=>ve.static_id==="None")).sort((J,ve)=>J.key.localeCompare(ve.key))}),Ke=m(()=>{if(!e(Oe))return{current:[]};const[$,F]=e(Oe);let J={};for(const be of Object.values(e(lt)||{}))for(const $e of be.slots)$e.static_id!=="None"&&(J[$e.static_id]||(J[$e.static_id]={containers:{},total_count:0}),J[$e.static_id].containers[be.key]=(J[$e.static_id].containers[be.key]||0)+$e.count,J[$e.static_id].total_count+=$e.count);return{current:Object.entries(J).filter(([be,$e])=>{const rt=ia.getByKey(be);return be.toLowerCase().includes(e(A).toLowerCase())||rt&&rt.info.localized_name.toLowerCase().includes(e(A).toLowerCase())}).map(([be,$e])=>({static_id:be,containers:$e.containers,total_count:$e.total_count})).sort((be,$e)=>{const rt=ia.getByKey(be.static_id),Ze=ia.getByKey($e.static_id);return rt&&Ze?rt.info.localized_name.localeCompare(Ze.info.localized_name):be.static_id.localeCompare($e.static_id)})}}),Fe=m(()=>{if(!e(v))return null;const $=Ba.getByKey(e(v).key);return $?sa.loadImage(`${ca}/img/${$.icon}.webp`):he.unknownIcon}),St=m(()=>{if(!e(Oe))return[];const[$,F]=e(Oe);return Array(F.slot_count).fill(void 0).map((J,ve)=>{const be=Object.values(F.pals).find($e=>$e.storage_slot===ve);return be?{pal:be,baseId:$}:{pal:{character_id:"None",character_key:"None",storage_slot:ve,instance_id:`empty-${ve}`,storage_id:F.container_id},baseId:$}})});function it($){$.target instanceof HTMLInputElement||($.key==="ArrowLeft"||$.key==="q"||$.key==="Q"?ft():($.key==="ArrowRight"||$.key==="e"||$.key==="E")&&G())}function ft(){e(L)>1?Fa(L,-1):d(L,e(I),!0),d(v,void 0),d(A,""),d(se,"")}function G(){e(L)<e(I)?Fa(L):d(L,1),d(v,void 0),d(A,""),d(se,"")}function D($,F){!$||$.character_id==="None"||(F.ctrlKey||F.metaKey)&&(e(i).includes($.instance_id)?d(i,e(i).filter(J=>J!==$.instance_id),!0):d(i,[...e(i),$.instance_id],!0))}async function b($,F){if(!o.selectedPlayer||!e(H))return;const J=e(H)[$];if(!J)return;const ve=await _.showModal(Pl,{title:`Add a new Pal to Base ${e(L)}`});if(!ve)return;const[be,$e]=ve,rt=da.getByKey(be);Ht(Gt.ADD_PAL,{guild_id:e(k)?.id,base_id:$,character_id:be,nickname:$e||Ha(rt?.localized_name??be,o.settings.new_pal_prefix),container_id:J.container_id,storage_slot:F})}async function O($){if(!e(H))return;const F=e(H)[$.baseId];if(!F)return;const J=F.slot_count-Object.keys(F.pals).length;if(J===0){M.add("There are no slots available in this base.","Error","error");return}const ve=await _.showModal(il,{title:"How many clones?",message:`There are ${J} slots available in this base.`,value:1,min:0,max:J});if(ve)for(let be=0;be<ve;be++){const $e=Qa($.pal);$e.nickname=Ha($e.nickname||$e.name||$e.character_id,o.settings.clone_prefix),Ht(Gt.CLONE_PAL,{guild_id:e(k).id,base_id:$.baseId,pal:$e})}}async function R($,F){const J=await _.showConfirmModal({title:"Delete Pal",message:`Are you sure you want to delete ${F.nickname||F.name}?`,confirmText:"Delete",cancelText:"Cancel"});o.selectedPlayer&&J&&Ht(Gt.DELETE_PALS,{guild_id:e(k)?.id,base_id:$,pal_ids:[F.instance_id]}),e(k).bases[$].pals=Object.fromEntries(Object.entries(e(k).bases[$].pals).filter(([ve,be])=>be.instance_id!==F.instance_id))}zt(()=>{}),zt(()=>(window.addEventListener("keydown",it),()=>{window.removeEventListener("keydown",it)})),zt(()=>{e(L)>e(I)&&e(I)>0&&d(L,e(I),!0)}),zt(()=>{e(A)!==""&&d(se,"")});function ee($){let F=[];for(let J=0;J<$.slot_num;J++){const ve=$.slots.find(be=>be.slot_index===J);if(ve)F.push(ve);else{const be={static_id:"None",slot_index:J,count:0,dynamic_item:void 0};F.push(be)}}$.slots=F,d(v,$,!0)}async function te($){if($.static_id!=="None"){o.clipboardItem=$;let F=$.static_id;const J=ia.getByKey($.static_id);J&&(F=J.info.localized_name),M.add(`${F} copied to clipboard`)}else o.clipboardItem=null,M.add("Clipboard cleared")}function y($){$.static_id="None",$.count=0,$.dynamic_item=void 0}function P($){o.clipboardItem?($.static_id=o.clipboardItem.static_id,$.count=o.clipboardItem.count,$.dynamic_item=o.clipboardItem.dynamic_item,$.dynamic_item&&($.dynamic_item.local_id="00000000-0000-0000-0000-000000000000")):y($)}async function X($,F,J=!0){$.button!==0&&($.preventDefault(),$.ctrlKey&&$.button===2&&J?P(F):$.ctrlKey&&$.button===1?y(F):!$.ctrlKey&&$.button===2?await te(F):M.add("Cannot paste here (yetâ„¢)",void 0,"warning"))}function ie(){if(e(k)?.guild_chest){let $=[];for(let F=0;F<e(k).guild_chest.slot_num;F++){const J=e(k).guild_chest.slots.find(ve=>ve.slot_index===F);if(J)$.push(J);else{const ve={static_id:"None",slot_index:F,count:0,dynamic_item:void 0};$.push(ve)}}e(k).guild_chest.slots=$}d(V,"guildChest")}function Je($){switch($){case _l.Uncommon:return"bg-linear-to-tl from-green-500/50";case _l.Rare:return"bg-linear-to-tl from-blue-500/50";case _l.Epic:return"bg-linear-to-tl from-purple-500/50";case _l.Legendary:return"bg-linear-to-tl from-yellow-500/50";default:return""}}var We=Ne(),Ue=Z(We);{var Pe=$=>{var F=Ne(),J=Z(F);{var ve=$e=>{var rt=zn();s($e,rt)},be=$e=>{var rt=Ne(),Ze=Z(rt);{var qe=de=>{var Re=Nn(),Pt=l(a(Re),2);t(Re),q(()=>B(Pt,"src",he.sadIcon)),s(de,Re)},Ge=de=>{var Re=Pi(),Pt=a(Re),vt=a(Pt),Ut=a(vt);Ut.__click=[Tn,_,k];var Rt=a(Ut),x=a(Rt,!0);t(Rt),t(Ut);var c=l(Ut,2);{var f=ke=>{{let _t=m(()=>`/debug?guildId=${e(k).id}`);El(ke,{get href(){return e(_t)}})}};le(c,ke=>{e(k)&&o.settings.debug_mode&&ke(f)})}var E=l(c,2);W(E,{label:"Delete entire guild",children:(ke,_t)=>{var ct=Un();ct.__click=[Bn,_,k];var Lt=a(ct);ts(Lt,{size:24}),t(ct),s(ke,ct)},$$slots:{default:!0}}),t(vt);var Y=l(vt,2),Le=a(Y),mt=a(Le),ta=a(mt);t(mt);var ua=l(mt,2);{var gt=ke=>{{let _t=m(()=>`/debug?guildId=${e(k).id}&baseId=${e(Oe)[1].id}`);El(ke,{iconClass:"h-4 w-4",get href(){return e(_t)}})}};le(ua,ke=>{e(k)&&e(Oe)&&o.settings.debug_mode&&ke(gt)})}t(Le);var h=l(Le,2),K=a(h);K.__click=[On,Oe,_,k];var ce=a(K),De=a(ce,!0);t(ce),t(K),t(h),t(Y);var Te=l(Y,2),p=a(Te);p.__click=[qn,V,A,se];var w=l(p,2);w.__click=[Kn,V,A,se];var S=l(w,2);S.__click=[Fn,A,se,ie];var j=l(S,2);j.__click=[Hn,A,se,V],t(Te);var Ie=l(Te,2);{var ht=ke=>{var _t=ti(),ct=a(_t);W(ct,{position:"right",label:"Add Pal to Base",children:(we,Ae)=>{var Ve=Rn();Ve.__click=[Gn,Oe,b];var oe=a(Ve);cl(oe,{class:"h-4 w-4"}),t(Ve),s(we,Ve)},$$slots:{default:!0}});var Lt=l(ct,2);W(Lt,{label:"Select all in current base",children:(we,Ae)=>{var Ve=Vn();Ve.__click=[Ln,Oe,i];var oe=a(Ve);xl(oe,{class:"h-4 w-4"}),t(Ve),s(we,Ve)},$$slots:{default:!0}});var wt=l(Lt,2);W(wt,{label:"Heal all in current base",children:(we,Ae)=>{var Ve=Wn();Ve.__click=[Mn,H,k,Oe];var oe=a(Ve);ls(oe,{class:"h-4 w-4"}),t(Ve),s(we,Ve)},$$slots:{default:!0}});var Ee=l(wt,2);{var He=we=>{var Ae=ei(),Ve=Z(Ae);W(Ve,{label:"Apply preset to selected pal(s)",children:(re,pe)=>{var T=Xn();T.__click=[jn,i,Oe,_];var ot=a(T);el(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var oe=l(Ve,2);W(oe,{label:"Heal selected pal(s)",children:(re,pe)=>{var T=Qn();T.__click=[Dn,H,i];var ot=a(T);as(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var _e=l(oe,2);W(_e,{label:"Delete selected pal(s)",children:(re,pe)=>{var T=Jn();T.__click=[An,i,_,Oe,k];var ot=a(T);tl(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}});var U=l(_e,2);W(U,{label:"Clear selected",children:(re,pe)=>{var T=Zn();T.__click=[Yn,i];var ot=a(T);kl(ot,{class:"h-4 w-4"}),t(T),s(re,T)},$$slots:{default:!0}}),s(we,Ae)};le(Ee,we=>{e(i).length>0&&we(He)})}t(_t),s(ke,_t)};le(Ie,ke=>{e(V)==="pals"&&ke(ht)})}var kt=l(Ie,2);{var et=ke=>{var _t=ci(),ct=Z(_t),Lt=a(ct);za(Lt,{placeholder:"Search Inventory",get value(){return e(A)},set value(we){d(A,we,!0)}});var wt=l(Lt,2);wt.__click=[ai,A,se];var Ee=a(wt);Bs(Ee,{class:"h-6 w-6"}),t(wt),t(ct);var He=l(ct,2);Vl(He,{baseClass:"w-full",listClass:"h-[calc(100vh-350px)]",canSelect:!1,idKey:"static_id",headerClass:"grid w-full grid-cols-[auto_1fr_auto] gap-2 rounded-sm",onselect:oe=>{d(se,oe.static_id,!0),d(A,"")},multiple:!1,get items(){return e(Ke).current},set items(oe){e(Ke).current=oe},listHeader:oe=>{var _e=li();Qt(4),s(oe,_e)},listItem:(oe,_e=Aa)=>{const U=m(()=>ia.getByKey(_e().static_id));var re=Ne(),pe=Z(re);{var T=Me=>{const Xe=m(()=>sa.loadImage(`${ca}/img/${e(U).details.icon}.webp`));var z=si(),xe=a(z),Qe=a(xe);t(xe);var bt=l(xe,2),Zt=a(bt,!0);t(bt);var Wt=l(bt,2),ra=a(Wt,!0);t(Wt),t(z),q((Ot,qt)=>{st(xe,1,Ot),B(Qe,"src",e(Xe)||he.unknownIcon),B(Qe,"alt",e(U).info.localized_name),ne(Zt,e(U).info.localized_name),ne(ra,qt)},[()=>pt(Je(e(U).details.rarity)),()=>_e().total_count.toLocaleString()]),s(Me,z)},ot=Me=>{var Xe=ri(),z=a(Xe),xe=l(z,2),Qe=a(xe,!0);t(xe);var bt=l(xe,2),Zt=a(bt,!0);t(bt),t(Xe),q(Wt=>{B(z,"src",he.unknownIcon),B(z,"alt",_e().static_id),ne(Qe,_e().static_id),ne(Zt,Wt)},[()=>_e().total_count.toLocaleString()]),s(Me,Xe)};le(pe,Me=>{e(U)?Me(T):Me(ot,!1)})}s(oe,re)},listItemPopup:(oe,_e=Aa)=>{const U=m(()=>ia.getByKey(_e().static_id));var re=Ne(),pe=Z(re);{var T=Me=>{var Xe=ii(),z=a(Xe),xe=a(z,!0);t(z);var Qe=l(z,2),bt=a(Qe,!0);t(Qe);var Zt=l(Qe,4),Wt=a(Zt);t(Zt);var ra=l(Zt,2);Et(ra,17,()=>Object.entries(_e().containers),Nt,(Ot,qt)=>{var aa=m(()=>Al(e(qt),2));let oa=()=>e(aa)[0],na=()=>e(aa)[1];const _a=m(()=>Ba.getByKey(oa()));var Tt=Ne(),Yt=Z(Tt);{var fe=Dt=>{const ea=m(()=>sa.loadImage(`${ca}/img/${e(_a).icon}.webp`));var Ia=oi(),Ea=a(Ia),La=l(Ea,2),me=a(La,!0);t(La);var $t=l(La,2),Ce=a($t,!0);t($t),t(Ia),q(ge=>{B(Ea,"src",e(ea)||he.unknownIcon),B(Ea,"alt",e(_a).localized_name),ne(me,e(_a).localized_name),ne(Ce,ge)},[()=>na().toLocaleString()]),s(Dt,Ia)},Ct=Dt=>{var ea=Ne(),Ia=Z(ea);{var Ea=La=>{var me=ni(),$t=a(me),Ce=a($t);t($t);var ge=l($t,2),It=a(ge,!0);t(ge),t(me),q(Xt=>{ne(Ce,`${oa()??""}:`),ne(It,Xt)},[()=>na().toLocaleString()]),s(La,me)};le(Ia,La=>{dt.some(me=>oa().includes(me))||La(Ea)},!0)}s(Dt,ea)};le(Yt,Dt=>{e(_a)?Dt(fe):Dt(Ct,!1)})}s(Ot,Tt)}),t(Xe),q(()=>{ne(xe,e(U).info.localized_name),ne(bt,e(U).info.description),ne(Wt,`Total Count: ${_e().total_count??""}`)}),s(Me,Xe)},ot=Me=>{var Xe=va();q(()=>ne(Xe,_e().static_id)),s(Me,Xe)};le(pe,Me=>{e(U)?Me(T):Me(ot,!1)})}s(oe,re)},$$slots:{listHeader:!0,listItem:!0,listItemPopup:!0}}),s(ke,_t)};le(kt,ke=>{e(V)=="storage"&&ke(et)})}var ue=l(kt,2);{var ze=ke=>{{let _t=m(()=>e(ae)?.unlockAllForCategory);Ds(ke,{get guild(){return e(k)},get unlockAllForCategory(){return e(_t)},get selectedCategory(){return e(Q)},set selectedCategory(ct){d(Q,ct,!0)}})}};le(ue,ke=>{e(V)==="lab"&&ke(ze)})}t(Pt);var ut=l(Pt,2),jt=a(ut);{var Vt=ke=>{var _t=di(),ct=a(_t);ct.__click=ft;var Lt=a(ct);t(ct);var wt=l(ct,2);Et(wt,21,()=>e(Ye),Nt,(we,Ae)=>{{let Ve=m(()=>e(Ae)===e(L)?"bg-primary-500 text-white":"bg-surface-800 hover:bg-gray-300"),oe=m(()=>`Base ${Object.entries(e(H))[e(Ae)-1]?.[0]}`);Na(we,{get class(){return`h-8 w-8 rounded-full ${e(Ve)??""}`},onclick:()=>d(L,e(Ae),!0),get popupLabel(){return e(oe)},children:(_e,U)=>{Qt();var re=va();q(()=>ne(re,e(Ae))),s(_e,re)},$$slots:{default:!0}})}}),t(wt);var Ee=l(wt,2);Ee.__click=G;var He=a(Ee);t(Ee),t(_t),q(()=>{B(Lt,"src",he.qIcon),B(He,"src",he.eIcon)}),s(ke,_t)};le(jt,ke=>{e(V)!=="lab"&&ke(Vt)})}var yt=l(jt,2);{var Ft=ke=>{var _t=vi(),ct=a(_t);Et(ct,21,()=>e(St),Lt=>Lt.pal.instance_id,(Lt,wt)=>{var Ee=Ne(),He=Z(Ee);{var we=Ae=>{wl(Ae,{get pal(){return e(wt).pal},onSelect:D,onDelete:()=>R(e(Oe)[0],e(wt).pal),onAdd:()=>b(e(Oe)[0],e(wt).pal.storage_slot),onClone:()=>O(e(wt)),onMove:()=>{},get selected(){return e(i)},set selected(Ve){d(i,Ve,!0)}})};le(He,Ae=>{e(wt).pal.character_id,Ae(we)})}s(Lt,Ee)}),t(ct),t(_t),s(ke,_t)},tt=ke=>{var _t=Ne(),ct=Z(_t);{var Lt=Ee=>{var He=Ne(),we=Z(He);{var Ae=oe=>{var _e=hi(),U=a(_e);Vl(U,{get items(){return e(lt)},baseClass:"w-1/4",listClass:"h-[calc(100vh-175px)]",canSelect:!1,onselect:z=>ee(z),multiple:!1,listItem:(z,xe=Aa)=>{const Qe=m(()=>Ba.getByKey(xe().key));var bt=Ne(),Zt=Z(bt);{var Wt=Ot=>{const qt=m(()=>sa.loadImage(`${ca}/img/${e(Qe).icon}.webp`));var aa=ui(),oa=a(aa),na=l(oa,2),_a=a(na,!0);t(na),t(aa),q(()=>{B(oa,"src",e(qt)||he.unknownIcon),B(oa,"alt",e(Qe).localized_name),ne(_a,e(Qe).localized_name)}),s(Ot,aa)},ra=Ot=>{var qt=_i(),aa=a(qt),oa=l(aa,2),na=a(oa,!0);t(oa),t(qt),q(()=>{B(aa,"src",he.unknownIcon),B(aa,"alt",xe().key),ne(na,xe().key)}),s(Ot,qt)};le(Zt,Ot=>{e(Qe)?Ot(Wt):Ot(ra,!1)})}s(z,bt)},listItemPopup:(z,xe=Aa)=>{const Qe=m(()=>Ba.getByKey(xe().key));var bt=Ne(),Zt=Z(bt);{var Wt=Ot=>{var qt=pi(),aa=a(qt),oa=a(aa,!0);t(aa);var na=l(aa,2),_a=l(a(na),2),Tt=a(_a,!0);t(_a),t(na);var Yt=l(na,2),fe=l(a(Yt),2),Ct=a(fe,!0);t(fe),t(Yt),t(qt),q(Dt=>{ne(oa,e(Qe).localized_name),ne(Tt,xe().slot_num),ne(Ct,Dt)},[()=>xe()?.slots?.filter(Dt=>Dt.static_id!=="None").length]),s(Ot,qt)},ra=Ot=>{var qt=va();q(()=>ne(qt,xe().key)),s(Ot,qt)};le(Zt,Ot=>{e(Qe)?Ot(Wt):Ot(ra,!1)})}s(z,bt)},$$slots:{listItem:!0,listItemPopup:!0}});var re=l(U,2),pe=a(re);{var T=Me=>{const Xe=m(()=>Ba.getByKey(e(v).key)),z=m(()=>e(Xe)?.type_a==Wl.Food?"Food":"Common");var xe=mi(),Qe=a(xe);Et(Qe,21,()=>Object.values(e(v).slots),Nt,(Wt,ra,Ot)=>{ya(Wt,{get itemGroup(){return e(z)},onUpdate:()=>{e(v).state=xt.MODIFIED},onCopyPaste:qt=>{X(qt,e(v).slots[Ot],!0),e(v).state=xt.MODIFIED},get slot(){return e(v).slots[Ot]},set slot(qt){e(v).slots[Ot]=qt}})}),t(Qe);var bt=l(Qe,2);{var Zt=Wt=>{var ra=fi(),Ot=a(ra),qt=l(Ot,2);Xl(qt,{get container(){return e(v)},onUpdate:()=>{e(v).state=xt.MODIFIED}}),t(ra),q(()=>B(Ot,"src",e(Fe))),s(Wt,ra)};le(bt,Wt=>{e(Fe)&&Wt(Zt)})}t(xe),s(Me,xe)},ot=Me=>{var Xe=gi();s(Me,Xe)};le(pe,Me=>{e(v)?Me(T):Me(ot,!1)})}t(re),t(_e),s(oe,_e)},Ve=oe=>{var _e=yi();s(oe,_e)};le(we,oe=>{e(lt)&&e(lt).length>0?oe(Ae):oe(Ve,!1)})}s(Ee,He)},wt=Ee=>{var He=Ne(),we=Z(He);{var Ae=oe=>{const _e=m(()=>Ba.getByKey("GuildChest")),U=m(()=>e(_e)?.type_a==Wl.Food?"Food":"Common");var re=$i(),pe=a(re),T=a(pe);Et(T,21,()=>Object.values(e(k).guild_chest.slots),Nt,(Xe,z,xe)=>{ya(Xe,{get itemGroup(){return e(U)},onUpdate:()=>{e(k).guild_chest.state=xt.MODIFIED},onCopyPaste:Qe=>{X(Qe,e(k).guild_chest.slots[xe],!0),e(k).guild_chest.state=xt.MODIFIED},get slot(){return e(k).guild_chest.slots[xe]},set slot(Qe){e(k).guild_chest.slots[xe]=Qe}})}),t(T);var ot=l(T,2);{var Me=Xe=>{var z=bi(),xe=a(z),Qe=l(xe,2);Xl(Qe,{get container(){return e(k).guild_chest},onUpdate:()=>{e(k).guild_chest.state=xt.MODIFIED}}),t(z),q(()=>B(xe,"src",e(C))),s(Xe,z)};le(ot,Xe=>{e(C)&&Xe(Me)})}t(pe),t(re),s(oe,re)},Ve=oe=>{var _e=Ne(),U=Z(_e);{var re=pe=>{var T=xi(),ot=a(T);es(sr(ot,{get guild(){return e(k)},get selectedCategory(){return e(Q)},set selectedCategory(Me){d(Q,Me,!0)}}),Me=>d(ae,Me,!0),()=>e(ae)),t(T),s(pe,T)};le(U,pe=>{e(V)=="lab"&&pe(re)},!0)}s(oe,_e)};le(we,oe=>{e(V)=="guildChest"&&e(k)?.guild_chest?oe(Ae):oe(Ve,!1)},!0)}s(Ee,He)};le(ct,Ee=>{e(V)=="storage"?Ee(Lt):Ee(wt,!1)},!0)}s(ke,_t)};le(yt,ke=>{e(V)=="pals"?ke(Ft):ke(tt,!1)})}t(ut),t(Re),q((ke,_t,ct,Lt)=>{ne(x,e(k).name),ne(ta,`Base ${e(L)??""}`),ne(De,e(Oe)?.[1]?.name||""),st(p,1,ke),st(w,1,_t),st(S,1,ct),st(j,1,Lt)},[()=>pt(Bt("btn hover:bg-secondary-500/50 w-1/4 rounded-sm",e(V)=="pals"?"bg-secondary-800":"")),()=>pt(Bt("btn hover:bg-secondary-500/50 w-1/4 rounded-sm",e(V)=="storage"?"bg-secondary-800":"")),()=>pt(Bt("btn hover:bg-secondary-500/50 w-1/4 rounded-sm",e(V)=="guildChest"?"bg-secondary-800":"")),()=>pt(Bt("btn hover:bg-secondary-500/50 w-1/4 rounded-sm",e(V)=="lab"?"bg-secondary-800":""))]),s(de,Re)};le(Ze,de=>{!e(H)||Object.values(e(H)).length===0?de(qe):de(Ge,!1)},!0)}s($e,rt)};le(J,$e=>{e(k)?$e(be,!1):$e(ve)})}s($,F)},je=$=>{var F=ki();s($,F)};le(Ue,$=>{o.selectedPlayer?$(Pe):$(je,!1)})}s(u,We),ha()}Ga(["click"]);function Ci(u,r){e(r).selectedPlayer&&(ja(r,e(r).selectedPlayer.technologies=[]),ja(r,e(r).selectedPlayer.state=xt.MODIFIED))}function Si(u,r){e(r).selectedPlayer&&(ja(r,e(r).selectedPlayer.technologies=Object.keys(Ya.technologies)),ja(r,e(r).selectedPlayer.state=xt.MODIFIED))}var Ii=(u,r,o)=>r(o()),Ei=n('<div class="text-start"> </div>'),Ai=n('<li class="flex items-center gap-2 text-start"><img class="h-6 w-6" loading="lazy"/> </li>'),Li=n("<li> </li>"),Di=n('<span class="font-bold">Unlocks:</span> <ul class="ml-4 list-disc"></ul>',1),Mi=n("<li> </li>"),ji=n("<li> </li>"),Oi=n('<span class="font-bold">Unlocks:</span> <ul class="ml-4 list-disc"></ul>',1),Ti=n('<div class="flex min-w-96 max-w-3xl flex-col items-start justify-items-start space-y-2"><div class="flex w-full text-start"><span class="grow text-xl font-bold"> </span> <div class="flex items-center"><img alt="Tech Point Icon" class="mr-2 h-6 w-6" loading="lazy"/> <span> </span></div></div> <!> <!> <!></div>'),Bi=n('<img class="mb-2 h-16 w-16 2xl:h-24 2xl:w-24"/>'),zi=n('<div class="absolute bottom-6 right-8 2xl:bottom-12 2xl:right-14"><h2 class="h2"> </h2></div>'),Ni=n('<div><div class="absolute top-0 h-auto w-full bg-[#091f35] py-0.5 text-xs"> </div> <!> <div class="bg-surface-800/50 absolute bottom-0 h-auto w-full py-2 text-xs"> </div></div> <!>',1),Ui=n("<button><!></button>"),qi=(u,r)=>r("tech"),Ki=(u,r)=>r("ancient"),Fi=n('<div class="w-24 2xl:w-32"></div>'),Hi=n('<div class="w-24 bg-[#220022] 2xl:w-32"></div>'),Gi=n('<div class="mb-12 grid grid-cols-[auto_1fr] gap-4"><div class="mb-4 flex items-center px-10"><div class="border-surface-500 flex h-12 w-12 items-center justify-center rounded border-2 text-xl font-bold"> </div> <div class="ml-4 h-0.5 flex-1"></div></div> <div class="flex gap-4"><div class="flex gap-4"><!> <!></div> <div class="bg-ancient-tech-500 w-px"></div> <!></div></div>'),Ri=n('<main class=" h-full min-h-screen overflow-y-auto p-8"><div class="mx-auto max-w-7xl"><div class="mb-8 flex items-center justify-between"><div class="flex gap-8"><button class="border-surface-400 hover:ring-tech-500 cursor-pointer rounded-lg border hover:ring-2"><div class="px-6 py-3"><div class="text-surface-400 text-xs">Technology Points</div> <div class="text-tech-500 text-2xl font-bold"> </div></div></button> <button class="border-surface-400 hover:ring-ancient-tech-500 cursor-pointer rounded-lg border hover:ring-2"><div class="px-6 py-3"><div class="text-surface-400 text-xs">Ancient Technology Points</div> <div class="text-ancient-tech-500 text-2xl font-bold"> </div></div></button></div> <div class="flex gap-4"><button class="btn preset-filled-primary-500 hover:ring-secondary-500 hover:preset-filled-secondary-500 rounded-lg bg-opacity-20 px-6 py-2 font-medium hover:ring-2"><!> Lock All</button> <button class="btn preset-filled-primary-500 hover:ring-secondary-500 hover:preset-filled-secondary-500 rounded-lg bg-opacity-20 px-6 py-2 font-medium hover:ring-2"><!> Unlock All</button></div></div> <!></div></main>'),Vi=n('<div class="flex w-full items-center justify-center"><h2 class="h2">Select a Player to view technologies ðŸŒ</h2></div>');function Wi(u,r){ga(r,!1);const o=(C,H=Aa,I=Aa,N=Aa,ye=Aa)=>{const Ye=ma(()=>ye()==="tech"?"border-tech-500":"border-ancient-tech-500"),Oe=ma(()=>ye()==="tech"?"bg-linear-to-tl from-tech-500/100 to-tech-500/25":"bg-linear-to-tl from-ancient-tech-500/100 to-ancient-tech-500/25"),dt=ma(()=>N().details.unlock_build_objects.length>0?"Structures":"Items"),lt=ma(()=>I()?"":ye()==="tech"?"hover:ring-2 hover:ring-tech-500":"hover:ring-2 hover:ring-ancient-tech-500");var Ke=Ui();Ke.__click=[Ii,V,H];var Fe=a(Ke);W(Fe,{popupClass:"bg-surface-800 p-4",popup:it=>{var ft=Ti(),G=a(ft),D=a(G),b=a(D,!0);t(D);var O=l(D,2),R=a(O),ee=l(R,2),te=a(ee,!0);t(ee),t(O),t(G);var y=l(G,2);{var P=Ue=>{var Pe=Ei(),je=a(Pe,!0);t(Pe),q(()=>ne(je,N().description)),s(Ue,Pe)};le(y,Ue=>{N().description&&Ue(P)})}var X=l(y,2);{var ie=Ue=>{var Pe=Di(),je=l(Z(Pe),2);Et(je,5,()=>N().details.unlock_build_objects,Nt,($,F)=>{const J=ma(()=>Ba.getByKey(e(F)));var ve=Ne(),be=Z(ve);{var $e=Ze=>{const qe=ma(()=>sa.loadImage(`${ca}/img/${e(J).icon}.webp`));var Ge=Ai(),de=a(Ge),Re=l(de);t(Ge),q(()=>{B(de,"src",e(qe)||he.unknownIcon),B(de,"alt",e(J).localized_name),ne(Re,` ${e(J).localized_name??""}`)}),s(Ze,Ge)},rt=Ze=>{var qe=Li(),Ge=a(qe,!0);t(qe),q(()=>ne(Ge,e(F))),s(Ze,qe)};le(be,Ze=>{e(J)?Ze($e):Ze(rt,!1)})}s($,ve)}),t(je),s(Ue,Pe)};le(X,Ue=>{N().details.unlock_build_objects.length>1&&Ue(ie)})}var Je=l(X,2);{var We=Ue=>{var Pe=Oi(),je=l(Z(Pe),2);Et(je,5,()=>N().details.unlock_item_recipes,Nt,($,F)=>{const J=ma(()=>ia.getByKey(e(F)));var ve=Ne(),be=Z(ve);{var $e=Ze=>{var qe=Mi(),Ge=a(qe,!0);t(qe),q(()=>ne(Ge,e(J).info.localized_name)),s(Ze,qe)},rt=Ze=>{var qe=ji(),Ge=a(qe,!0);t(qe),q(()=>ne(Ge,e(F))),s(Ze,qe)};le(be,Ze=>{e(J)?Ze($e):Ze(rt,!1)})}s($,ve)}),t(je),s(Ue,Pe)};le(Je,Ue=>{N().details.unlock_item_recipes.length>1&&Ue(We)})}t(ft),q(()=>{ne(b,N().localized_name),B(R,"src",ye()==="tech"?g:i),ne(te,N().details.cost)}),s(it,ft)},children:(it,ft)=>{var G=Ni(),D=Z(G),b=a(D),O=a(b,!0);t(b);var R=l(b,2);ml(R,()=>v(H()),null,(X,ie)=>{var Je=Bi();q(We=>{B(Je,"src",e(ie)||he.unknownIcon),B(Je,"alt",We)},[()=>Ya.getByKey(H())?.localized_name]),s(X,Je)});var ee=l(R,2),te=a(ee,!0);t(ee),t(D);var y=l(D,2);{var P=X=>{var ie=zi(),Je=a(ie),We=a(Je,!0);t(Je),t(ie),q(()=>ne(We,N().details.cost)),s(X,ie)};le(y,X=>{I()||X(P)})}q(()=>{st(D,1,`mb-2 flex aspect-square items-center justify-center ${e(Oe)??""} ${I()?"":"opacity-25"}`),ne(O,e(dt)),ne(te,N().localized_name)}),s(it,G)},$$slots:{popup:!0,default:!0}}),t(Ke),q(()=>st(Ke,1,`relative h-24 w-24 cursor-pointer border transition-all duration-200 2xl:h-32 2xl:w-32 ${e(Ye)??""} ${e(lt)??""}`)),s(C,Ke)},_=ns(Sa()),M=Oa(),g=sa.loadImage(`${ca}/img/t_icon_tech_point.webp`),i=sa.loadImage(`${ca}/img/t_icon_ancient_tech_point.webp`),L=Object.entries(Ya.technologies).reduce((C,[H,I])=>{const N=I.details.level_cap;return C[N]||(C[N]={regular:[],ancient:null}),I.details.is_boss_technology?C[N].ancient=H:C[N].regular.push(H),C},{});function V(C){e(_).selectedPlayer&&(e(_).selectedPlayer.technologies.includes(C)?ja(_,e(_).selectedPlayer.technologies=e(_).selectedPlayer.technologies.filter(H=>H!==C)):e(_).selectedPlayer.technologies.push(C),ja(_,e(_).selectedPlayer.state=xt.MODIFIED))}async function v(C){let H=Ya.getByKey(C)?.details.icon;return H?sa.loadImage(`${ca}/img/${H}.webp`):he.unknownIcon}async function se(C){if(!e(_).selectedPlayer)return;const H=C==="tech"?"Technology Points":"Ancient Technology Points",I=await M.showModal(il,{title:H,value:C==="tech"?e(_).selectedPlayer.technology_points:e(_).selectedPlayer.boss_technology_points,min:0,max:99999});I&&(C==="tech"?ja(_,e(_).selectedPlayer.technology_points=I):ja(_,e(_).selectedPlayer.boss_technology_points=I),ja(_,e(_).selectedPlayer.state=xt.MODIFIED))}Ms();var A=Ne(),Q=Z(A);{var ae=C=>{var H=Ri(),I=a(H),N=a(I),ye=a(N),Ye=a(ye);Ye.__click=[qi,se];var Oe=a(Ye),dt=l(a(Oe),2),lt=a(dt,!0);t(dt),t(Oe),t(Ye);var Ke=l(Ye,2);Ke.__click=[Ki,se];var Fe=a(Ke),St=l(a(Fe),2),it=a(St,!0);t(St),t(Fe),t(Ke),t(ye);var ft=l(ye,2),G=a(ft);G.__click=[Ci,_];var D=a(G);js(D,{class:"inline h-4 w-4"}),Qt(),t(G);var b=l(G,2);b.__click=[Si,_];var O=a(b);Os(O,{class:"inline h-4 w-4"}),Qt(),t(b),t(ft),t(N);var R=l(N,2);Et(R,1,()=>Object.entries(L),Nt,(ee,te)=>{var y=m(()=>Al(e(te),2));let P=()=>e(y)[0],X=()=>e(y)[1];const ie=ma(()=>X().regular),Je=ma(()=>8-e(ie).length),We=ma(()=>X().ancient);var Ue=Gi(),Pe=a(Ue),je=a(Pe),$=a(je,!0);t(je),Qt(2),t(Pe);var F=l(Pe,2),J=a(F),ve=a(J);Et(ve,1,()=>e(ie),Nt,(qe,Ge)=>{const de=ma(()=>Ya.getByKey(e(Ge))),Re=ma(()=>Number(P())===1?!0:e(_).selectedPlayer.technologies.includes(e(Ge)));var Pt=Ne(),vt=Z(Pt);{var Ut=Rt=>{o(Rt,()=>e(Ge),()=>e(Re),()=>e(de),()=>"tech")};le(vt,Rt=>{e(de)&&!e(de)?.details.is_boss_technology&&Rt(Ut)})}s(qe,Pt)});var be=l(ve,2);Et(be,1,()=>Array(e(Je)),Nt,(qe,Ge)=>{var de=Fi();s(qe,de)}),t(J);var $e=l(J,4);{var rt=qe=>{const Ge=ma(()=>Ya.getByKey(e(We))),de=ma(()=>e(_).selectedPlayer.technologies.includes(e(We)));o(qe,()=>e(We),()=>e(de),()=>e(Ge),()=>"ancient")},Ze=qe=>{var Ge=Hi();s(qe,Ge)};le($e,qe=>{e(We)?qe(rt):qe(Ze,!1)})}t(F),t(Ue),q(()=>ne($,P())),s(ee,Ue)}),t(I),t(H),q(()=>{ne(lt,e(_).selectedPlayer.technology_points),ne(it,e(_).selectedPlayer.boss_technology_points)}),s(C,H)},k=C=>{var H=Vi();s(C,H)};le(Q,C=>{e(_).selectedPlayer?C(ae):C(k,!1)})}s(u,A),ha()}Ga(["click"]);function Xi(u,r,o){e(r).length===e(o).length?d(r,[],!0):d(r,e(o).map(_=>_.id),!0)}var Qi=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Ji=n('<div class="flex flex-col"><span>Select all in</span> <div class="grid grid-cols-[auto_1fr] gap-1"><img alt="Left Click" class="h-6 w-6"/> <span class="text-sm">pal box</span> <div class="flex"><img alt="Ctrl" class="h-6 w-6"/> <img alt="Left Click" class="h-6 w-6"/></div> <span class="text-sm">pal box + party</span></div></div>'),Yi=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Zi=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),ec=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),tc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),ac=(u,r)=>d(r,[],!0),lc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),sc=n("<!> <!> <!> <!>",1),rc=n('<span class="font-bold">Filter & Sort</span>'),oc=(u,r)=>r("level"),nc=n('<button type="button"><!></button>'),ic=(u,r)=>r("name"),cc=n('<button type="button"><!></button>'),dc=(u,r)=>r("paldeck-index"),vc=n('<button type="button"><!></button>'),uc=(u,r)=>d(r,"All"),_c=n("<button><!></button>"),pc=(u,r,o)=>d(r,e(o),!0),fc=n('<button><img class="pal-element-badge svelte-olzjqy"/></button>'),mc=(u,r)=>d(r,"alpha"),gc=n('<button type="button"><img alt="Alpha" class="pal-element-badge svelte-olzjqy"/></button>'),hc=(u,r)=>d(r,"lucky"),yc=n('<button type="button"><img alt="Alpha" class="pal-element-badge svelte-olzjqy"/></button>'),bc=(u,r)=>d(r,"human"),$c=n('<button type="button"><!></button>'),xc=(u,r)=>d(r,"predator"),Pc=n('<button type="button"><img alt="Predator" class="pal-element-badge svelte-olzjqy"/></button>'),kc=(u,r)=>d(r,"oilrig"),wc=n('<button type="button"><img alt="Oil Rig" class="pal-element-badge svelte-olzjqy"/></button>'),Cc=(u,r)=>d(r,"summon"),Sc=n('<button type="button"><img alt="Summoned" class="pal-element-badge svelte-olzjqy"/></button>'),Ic=n('<!> <div><legend class="font-bold">Sort</legend> <hr/> <div class="grid grid-cols-6"><!> <!> <!></div></div> <div><legend class="font-bold">Element & Type</legend> <hr/> <div class="mt-2 grid grid-cols-4 2xl:grid-cols-6"><!> <!> <!> <!> <!> <!> <!> <!></div></div>',1),Ec=n('<span class="font-bold">Stats</span>'),Ac=n("<div>No pals data available</div>"),Lc=n("<!> <!>",1),Dc=n("<div>No pals data available</div>"),Mc=n('<div><div class="shrink-0 p-4"><div class="btn-group bg-surface-900 mb-2 w-full items-center rounded-sm p-1"><!> <!> <!></div> <!></div> <div><div class="mb-4 flex items-center justify-center space-x-4"><button class="rounded-sm px-4 py-2 font-bold"><img alt="Previous" class="h-10 w-10"/></button> <div class="flex space-x-2"></div> <button class="rounded-sm px-4 py-2 font-bold"><img alt="Next" class="h-10 w-10"/></button></div> <div class="overflow-hidden"><div class="grid grid-cols-6 place-items-center gap-4 p-4"></div></div></div> <!></div>'),jc=n('<div class="flex w-full items-center justify-center"><h2 class="h2">Select a Player to view Pal Box</h2></div>');function Oc(u,r){ga(r,!0);const o=30,_=9600,M=16,g=Sa(),i=Oa(),L=nl(),V=Dl();let v=hl(r,["$$slots","$$events","$$legacy"]),se=Be(""),A=Be("All"),Q=Be(1),ae=Be(Mt([])),k=Be(Mt([])),C=Be("slot-index"),H=Be("asc"),I=Be(Mt([""]));const N=m(()=>Math.ceil(e(se)||e(A)!=="All"||e(C)!=="slot-index"?e(ae).length:_)/o),ye=m(()=>Math.max(1,Math.min(e(Q)-Math.floor(M/2),e(N)-M+1))),Ye=m(()=>Math.min(e(ye)+M-1,e(N))),Oe=m(()=>Array.from({length:e(Ye)-e(ye)+1},(c,f)=>e(ye)+f)),dt=m(()=>{const c=(e(Q)-1)*o,f=c+o;return e(se)||e(A)!=="All"||e(C)!=="slot-index"?e(ae).slice(c,f):Array(_).fill(void 0).map((Y,Le)=>{const mt=e(ae).find(ta=>ta.index==Le);return mt||{id:`empty-${Le}`,index:Le,pal:{character_id:"None",character_key:"None",storage_slot:Le,instance_id:`empty-${Le}`,storage_id:g.selectedPlayer?.pal_box_id}}}).slice(c,f)}),lt=m(()=>Bt("btn",e(A)==="lucky"?"bg-secondary-500/25":"")),Ke=m(()=>Bt("btn",e(A)==="alpha"?"bg-secondary-500/25":"")),Fe=m(()=>Bt("btn",e(A)==="human"?"bg-secondary-500/25":"")),St=m(()=>Bt("btn",e(A)==="predator"?"bg-secondary-500/25":"")),it=m(()=>Bt("btn",e(A)==="oilrig"?"bg-secondary-500/25":"")),ft=m(()=>Bt("btn",e(A)==="summon"?"bg-secondary-500/25":"")),G=c=>Bt("btn",e(C)===c?"bg-secondary-500/25":""),D=c=>Bt("btn",e(A)===c?"bg-secondary-500/25":"");let b=m(()=>!g.selectedPlayer||!g.selectedPlayer.dps?void 0:Object.entries(g.selectedPlayer.dps).filter(([f,E])=>E&&E.character_id!=="None").map(([f,E])=>{const Y=da.getByKey(E.character_key);return{id:E.instance_id,index:f,pal:E,palData:Y}})),O=m(()=>Object.keys(ba.elements)),R=m(()=>{let c={};for(const f of e(O)){const E=ba.getByKey(f);E&&(c[f]=sa.loadImage(`${ca}/img/${E.icon}.webp`))}return c}),ee=m(()=>e(C)!=="level"?ll:e(H)==="asc"?ll:Ol),te=m(()=>e(C)!=="name"?sl:e(H)==="asc"?sl:Tl),y=m(()=>e(C)!=="paldeck-index"?rl:e(H)==="asc"?rl:zl);function P(c){c.target instanceof HTMLInputElement||(c.key==="ArrowLeft"||c.key==="q"||c.key==="Q"?X():(c.key==="ArrowRight"||c.key==="e"||c.key==="E")&&ie())}function X(){e(Q)>1?Fa(Q,-1):d(Q,e(N),!0)}function ie(){e(Q)<e(N)?Fa(Q):d(Q,1)}const Je=bl(We,300);async function We(){e(b)&&(d(ae,e(b).filter(({pal:c,palData:f})=>{if(!f)return!1;const E=f.localized_name.toLowerCase().includes(e(se).toLowerCase())||c.nickname?.toLowerCase().includes(e(se).toLowerCase())||c.character_id.toLowerCase().includes(e(se).toLowerCase()),Y=e(O).includes(e(A))?f.element_types.map(K=>K.toString().toLowerCase()).includes(e(A).toLowerCase()):!0,Le=e(A)==="alpha"?c.is_boss:!0,mt=e(A)==="lucky"?c.is_lucky:!0,ta=e(A)==="human"?!f?.is_pal:!0,ua=e(A)==="predator"?c.character_id.toLowerCase().includes("predator_"):!0,gt=e(A)==="oilrig"?c.character_id.toLowerCase().includes("_oilrig"):!0,h=e(A)==="summon"?c.character_id.toLowerCase().includes("summon_"):!0;return E&&Y&&Le&&mt&&ta&&ua&&gt&&h}),!0),je())}async function Ue(){const c=e(k).map(Y=>{const Le=e(b)?.find(mt=>mt.id===Y);return{character_id:Le?.pal.character_id,character_key:Le?.pal.character_key}}),f=await i.showModal(Cl,{title:"Select preset",selectedPals:c});if(!f)return;const E=Ka.presetProfiles[f];e(k).forEach(Y=>{const Le=e(b)?.find(mt=>mt.id===Y);Le&&gl(Le.pal,E,g.selectedPlayer)})}function Pe(c){e(C)===c?e(H)==="desc"?(d(C,"slot-index"),d(H,"asc")):d(H,e(H)==="asc"?"desc":"asc",!0):(d(C,c,!0),d(H,"asc")),je()}function je(){switch(e(C)){case"name":$e();break;case"level":rt();break;case"paldeck-index":qe();break;default:Ze();break}}async function $(c){if(!g.selectedPlayer)return;const f=await i.showModal(Pl,{title:"Add a new Pal to your DPS"});if(!f)return;const[E,Y]=f,Le=da.getByKey(E);Ht(Gt.ADD_DPS_PAL,{player_id:g.selectedPlayer.uid,character_id:E,nickname:Y||Ha(Le?.localized_name||E,g.settings.new_pal_prefix),storage_slot:c})}async function F(c){const f=g.selectedPlayer.dps?9600-Object.values(g.selectedPlayer.dps).length:0;if(f===0){L.add("There are no slots available in your Dimensional Pal Storage.","Error","error");return}const E=await i.showModal(il,{title:"How many clones?",message:`There are ${f} slots available in your Dimensional Pal Storage.`,value:1,min:0,max:f});if(E)for(let Y=0;Y<E;Y++){const Le=Qa(c);Le.nickname=Ha(Le.nickname||Le.name||Le.character_id,g.settings.clone_prefix),Ht(Gt.CLONE_DPS_PAL,{pal:Le})}}async function J(c){await F(c)}async function ve(c){const f=await i.showModal(al,{title:"Clone to UPS",message:"Clone this Pal to your Universal Pal Storage.",pals:[c]});if(!f)return;const{collectionId:E,tags:Y,notes:Le}=f;try{await V.cloneToUps([c.instance_id],"dps",g.selectedPlayer?.uid,E,Y.length>0?Y:void 0,Le||void 0),L.add(`Successfully cloned ${c.nickname||c.name} to UPS`,"Success","success")}catch(mt){console.error("Clone to UPS failed:",mt),L.add("Clone to UPS failed. Please try again.","Error","error")}}async function be(){if(e(k).length===0)return;const c=e(k).map(mt=>e(b)?.find(ta=>ta.id===mt)?.pal).filter(Boolean);if(c.length===0)return;const f=await i.showModal(al,{title:"Clone to UPS",message:`Clone ${c.length} selected Pals to your Universal Pal Storage.`,pals:c});if(!f)return;const{collectionId:E,tags:Y,notes:Le}=f;try{await V.cloneToUps(e(k),"dps",g.selectedPlayer?.uid,E,Y.length>0?Y:void 0,Le||void 0),L.add(`Successfully cloned ${c.length} Pals to UPS`,"Success","success"),d(k,[],!0)}catch(mt){console.error("Bulk clone to UPS failed:",mt),L.add("Bulk clone to UPS failed. Please try again.","Error","error")}}function $e(){d(ae,e(ae).sort((c,f)=>e(H)==="asc"?c.pal.name.localeCompare(f.pal.name):f.pal.name.localeCompare(c.pal.name)),!0)}function rt(){d(ae,e(ae).sort((c,f)=>e(H)==="asc"?c.pal.level-f.pal.level:f.pal.level-c.pal.level),!0)}function Ze(){d(ae,e(ae).sort((c,f)=>e(H)==="asc"?c.pal.storage_slot-f.pal.storage_slot:f.pal.storage_slot-c.pal.storage_slot),!0)}async function qe(){const c=e(ae).map(E=>da.getByKey(E.pal.character_key)),f=e(ae).map((E,Y)=>[E,c[Y]]);f.sort((E,Y)=>{const Le=E[1]?.pal_deck_index??1/0,mt=Y[1]?.pal_deck_index??1/0;return e(H)==="asc"?Le-mt:mt-Le}),d(ae,f.map(E=>E[0]),!0)}function Ge(c,f){!c||c.character_id==="None"||(f.ctrlKey||f.metaKey)&&(e(k).includes(c.instance_id)?d(k,e(k).filter(E=>E!==c.instance_id),!0):d(k,[...e(k),c.instance_id],!0))}async function de(){if(e(k).length===0)return;const c=await i.showConfirmModal({title:`Delete Pal${e(k).length>1?"s":""}`,message:`Are you sure you want to delete the ${e(k).length} selected pal${e(k).length==1?"":"s"}?`,confirmText:"Delete",cancelText:"Cancel"});if(g.selectedPlayer&&g.selectedPlayer.dps&&c){const f=Object.entries(g.selectedPlayer.dps).filter(([E,Y])=>e(k).includes(Y.instance_id)).map(([E])=>E);Ht(Gt.DELETE_DPS_PALS,{player_id:g.selectedPlayer.uid,pal_indexes:f}),g.selectedPlayer.dps=Object.fromEntries(Object.entries(g.selectedPlayer.dps).filter(([E,Y])=>!f.includes(E)))}d(k,[],!0)}async function Re(c){const f=await i.showConfirmModal({title:"Delete Pal",message:`Are you sure you want to delete ${c.nickname||c.name}?`,confirmText:"Delete",cancelText:"Cancel"});if(g.selectedPlayer&&g.selectedPlayer.dps&&f){const E=Object.entries(g.selectedPlayer.dps).find(([Y,Le])=>Le.instance_id===c.instance_id);Ht(Gt.DELETE_DPS_PALS,{player_id:g.selectedPlayer.uid,pal_indexes:[E[0]]}),g.selectedPlayer.dps=Object.fromEntries(Object.entries(g.selectedPlayer.dps).filter(([Y,Le])=>Le.instance_id!==c.instance_id))}}zt(()=>{g.selectedPlayer&&g.selectedPlayer.dps&&Je()}),zt(()=>{(e(se)||e(A))&&Je()}),zt(()=>{(g.selectedPal&&g.selectedPal.level||g.selectedPal&&g.selectedPal.nickname)&&Je()}),zt(()=>(window.addEventListener("keydown",P),()=>{window.removeEventListener("keydown",P)})),zt(()=>{e(Q)>e(N)&&d(Q,1)}),zt(()=>{e(b)&&Je()});async function Pt(){g.selectedPlayer&&await i.showModal(Ll,{title:"Fill Dimensional Pal Storage",player:g.selectedPlayer,target:"dps"})}var vt=Ne(),Ut=Z(vt);{var Rt=c=>{var f=Mc();yl(f,()=>({class:"grid h-full w-full grid-cols-[25%_1fr] 2xl:grid-cols-[25%_1fr_20%]",...v}),void 0,void 0,"svelte-olzjqy");var E=a(f),Y=a(E),Le=a(Y);W(Le,{position:"right",label:"Add all pals to your Pal Box",children:(et,ue)=>{var ze=Qi();ze.__click=Pt;var ut=a(ze);Nl(ut,{class:"h-4 w-4"}),t(ze),s(et,ze)},$$slots:{default:!0}});var mt=l(Le,2);W(mt,{popup:ue=>{var ze=Ji(),ut=l(a(ze),2),jt=a(ut),Vt=l(jt,4),yt=a(Vt),Ft=l(yt,2);t(Vt),Qt(2),t(ut),t(ze),q(()=>{B(jt,"src",he.leftClickIcon),B(yt,"src",he.ctrlIcon),B(Ft,"src",he.leftClickIcon)}),s(ue,ze)},children:(ue,ze)=>{var ut=Yi();ut.__click=[Xi,k,ae];var jt=a(ut);xl(jt,{class:"h-4 w-4"}),t(ut),s(ue,ut)},$$slots:{popup:!0,default:!0}});var ta=l(mt,2);{var ua=et=>{var ue=sc(),ze=Z(ue);W(ze,{label:"Apply preset to selected pal(s)",children:(yt,Ft)=>{var tt=Zi();tt.__click=Ue;var ke=a(tt);el(ke,{class:"h-4 w-4"}),t(tt),s(yt,tt)},$$slots:{default:!0}});var ut=l(ze,2);W(ut,{label:"Clone selected pal(s) to UPS",children:(yt,Ft)=>{var tt=ec();tt.__click=be;var ke=a(tt);Ml(ke,{class:"h-4 w-4"}),t(tt),s(yt,tt)},$$slots:{default:!0}});var jt=l(ut,2);W(jt,{label:"Delete selected pal(s)",children:(yt,Ft)=>{var tt=tc();tt.__click=de;var ke=a(tt);tl(ke,{class:"h-4 w-4"}),t(tt),s(yt,tt)},$$slots:{default:!0}});var Vt=l(jt,2);W(Vt,{label:"Clear selected pal(s)",children:(yt,Ft)=>{var tt=lc();tt.__click=[ac,k];var ke=a(tt);kl(ke,{class:"h-4 w-4"}),t(tt),s(yt,tt)},$$slots:{default:!0}}),s(et,ue)};le(ta,et=>{e(k).length>=1&&et(ua)})}t(Y);var gt=l(Y,2);Jt(gt,{get value(){return e(I)},onValueChange:et=>d(I,et.value,!0),collapsible:!0,children:(et,ue)=>{var ze=Lc(),ut=Z(ze);{const Vt=tt=>{jl(tt,{})},yt=tt=>{var ke=rc();s(tt,ke)},Ft=tt=>{var ke=Ic(),_t=Z(ke);za(_t,{type:"text",inputClass:"w-full",placeholder:"Search by name or nickname",get value(){return e(se)},set value(Me){d(se,Me,!0)}});var ct=l(_t,2),Lt=l(a(ct),4),wt=a(Lt);W(wt,{label:"Sort by level",children:(Me,Xe)=>{var z=nc();z.__click=[oc,Pe];var xe=a(z);at(xe,()=>e(ee),(Qe,bt)=>{bt(Qe,{})}),t(z),q(Qe=>st(z,1,Qe,"svelte-olzjqy"),[()=>pt(G("level"))]),s(Me,z)},$$slots:{default:!0}});var Ee=l(wt,2);W(Ee,{label:"Sort by name",children:(Me,Xe)=>{var z=cc();z.__click=[ic,Pe];var xe=a(z);at(xe,()=>e(te),(Qe,bt)=>{bt(Qe,{})}),t(z),q(Qe=>st(z,1,Qe,"svelte-olzjqy"),[()=>pt(G("name"))]),s(Me,z)},$$slots:{default:!0}});var He=l(Ee,2);W(He,{label:"Sort by Paldeck #",children:(Me,Xe)=>{var z=vc();z.__click=[dc,Pe];var xe=a(z);at(xe,()=>e(y),(Qe,bt)=>{bt(Qe,{})}),t(z),q(Qe=>st(z,1,Qe,"svelte-olzjqy"),[()=>pt(G("paldeck-index"))]),s(Me,z)},$$slots:{default:!0}}),t(Lt),t(ct);var we=l(ct,2),Ae=l(a(we),4),Ve=a(Ae);W(Ve,{popup:Xe=>{Qt();var z=va("All pals");s(Xe,z)},children:(Xe,z)=>{var xe=_c();xe.__click=[uc,A];var Qe=a(xe);Ul(Qe,{}),t(xe),q(bt=>st(xe,1,bt,"svelte-olzjqy"),[()=>pt(D("All"))]),s(Xe,xe)},$$slots:{popup:!0,default:!0}});var oe=l(Ve,2);Et(oe,17,()=>[...e(O)],Nt,(Me,Xe)=>{const z=m(()=>ba.getByKey(e(Xe))?.localized_name);W(Me,{get label(){return e(z)},children:(xe,Qe)=>{var bt=fc();bt.__click=[pc,A,Xe];var Zt=a(bt);t(bt),q(Wt=>{st(bt,1,Wt,"svelte-olzjqy"),B(bt,"aria-label",e(z)),B(Zt,"src",e(R)[e(Xe)]),B(Zt,"alt",e(z))},[()=>pt(D(e(Xe)))]),s(xe,bt)},$$slots:{default:!0}})});var _e=l(oe,2);W(_e,{label:"Alpha Pals",children:(Me,Xe)=>{var z=gc();z.__click=[mc,A];var xe=a(z);t(z),q(()=>{st(z,1,pt(e(Ke)),"svelte-olzjqy"),B(xe,"src",he.alphaIcon)}),s(Me,z)},$$slots:{default:!0}});var U=l(_e,2);W(U,{label:"Lucky Pals",children:(Me,Xe)=>{var z=yc();z.__click=[hc,A];var xe=a(z);t(z),q(()=>{st(z,1,pt(e(lt)),"svelte-olzjqy"),B(xe,"src",he.luckyIcon)}),s(Me,z)},$$slots:{default:!0}});var re=l(U,2);W(re,{label:"Humans",children:(Me,Xe)=>{var z=$c();z.__click=[bc,A];var xe=a(z);dl(xe,{}),t(z),q(()=>st(z,1,pt(e(Fe)),"svelte-olzjqy")),s(Me,z)},$$slots:{default:!0}});var pe=l(re,2);W(pe,{label:"Predator Pals",children:(Me,Xe)=>{var z=Pc();z.__click=[xc,A];var xe=a(z);t(z),q(Qe=>{st(z,1,pt(e(St)),"svelte-olzjqy"),B(xe,"src",he.predatorIcon),Xa(xe,`filter: ${Qe??""};`)},[()=>qa("#FF0000")]),s(Me,z)},$$slots:{default:!0}});var T=l(pe,2);W(T,{label:"Oil Rig Pals",children:(Me,Xe)=>{var z=wc();z.__click=[kc,A];var xe=a(z);t(z),q(()=>{st(z,1,pt(e(it)),"svelte-olzjqy"),B(xe,"src",he.oilrigIcon)}),s(Me,z)},$$slots:{default:!0}});var ot=l(T,2);W(ot,{label:"Summoned Pals",children:(Me,Xe)=>{var z=Sc();z.__click=[Cc,A];var xe=a(z);t(z),q(()=>{st(z,1,pt(e(ft)),"svelte-olzjqy"),B(xe,"src",he.altarIcon)}),s(Me,z)},$$slots:{default:!0}}),t(Ae),t(we),s(tt,ke)};at(ut,()=>Jt.Item,(tt,ke)=>{ke(tt,{value:"filter",base:"rounded-sm bg-surface-900",controlHover:"hover:bg-secondary-500/25",lead:Vt,control:yt,panel:Ft,$$slots:{lead:!0,control:!0,panel:!0}})})}var jt=l(ut,2);{const Vt=tt=>{Bl(tt,{})},yt=tt=>{var ke=Ec();s(tt,ke)},Ft=tt=>{var ke=Ne(),_t=Z(ke);{var ct=wt=>{ol(wt,{get pals(){return e(b)},get elementTypes(){return e(O)}})},Lt=wt=>{var Ee=Ac();s(wt,Ee)};le(_t,wt=>{e(b)&&e(b).length>0?wt(ct):wt(Lt,!1)})}s(tt,ke)};at(jt,()=>Jt.Item,(tt,ke)=>{ke(tt,{value:"stats",base:"block 2xl:hidden rounded-sm bg-surface-900",controlHover:"hover:bg-secondary-500/25",lead:Vt,control:yt,panel:Ft,$$slots:{lead:!0,control:!0,panel:!0}})})}s(et,ze)},$$slots:{default:!0}}),t(E);var h=l(E,2),K=a(h),ce=a(K);ce.__click=X;var De=a(ce);t(ce);var Te=l(ce,2);Et(Te,21,()=>e(Oe),Nt,(et,ue)=>{{let ze=m(()=>e(ue)===e(Q)?"bg-primary-500 text-white":"bg-surface-800 hover:bg-gray-300"),ut=m(()=>`Box ${e(ue)}`);Na(et,{get class(){return`h-8 w-8 rounded-full ${e(ze)??""}`},onclick:()=>d(Q,e(ue),!0),get popupLabel(){return e(ut)},children:(jt,Vt)=>{Qt();var yt=va();q(Ft=>ne(yt,Ft),[()=>Math.floor(e(ue))]),s(jt,yt)},$$slots:{default:!0}})}}),t(Te);var p=l(Te,2);p.__click=ie;var w=a(p);t(p),t(K);var S=l(K,2),j=a(S);Et(j,21,()=>e(dt),et=>et.pal.instance_id,(et,ue)=>{var ze=Ne(),ut=Z(ze);{var jt=Vt=>{wl(Vt,{get pal(){return e(ue).pal},onSelect:Ge,onMove:()=>{},onDelete:()=>Re(e(ue).pal),onAdd:()=>$(e(ue).index),onClone:()=>J(e(ue).pal),onCloneToUps:()=>ve(e(ue).pal),get selected(){return e(k)},set selected(yt){d(k,yt,!0)}})};le(ut,Vt=>{(e(ue).pal.character_id!=="None"||!e(se)&&e(A)==="All"&&e(C)==="slot-index")&&Vt(jt)})}s(et,ze)}),t(j),t(S),t(h);var Ie=l(h,2);{var ht=et=>{Ua(et,{class:"mr-2 hidden h-[430px] 2xl:block",children:(ue,ze)=>{ol(ue,{get pals(){return e(b)},get elementTypes(){return e(O)}})},$$slots:{default:!0}})},kt=et=>{Ua(et,{class:"mr-2 hidden h-[430px] 2xl:block",children:(ue,ze)=>{var ut=Dc();s(ue,ut)},$$slots:{default:!0}})};le(Ie,et=>{e(b)&&e(b).length>0?et(ht):et(kt,!1)})}t(f),q(()=>{B(De,"src",he.qIcon),B(w,"src",he.eIcon)}),s(c,f)},x=c=>{var f=jc();s(c,f)};le(Ut,c=>{g.selectedPlayer?c(Rt):c(x,!1)})}s(u,vt),ha()}Ga(["click"]);async function Tc(u,r,o,_){const M=e(r).map(L=>{const V=e(o)?.find(v=>v.id===L);return{character_id:V?.pal.character_id,character_key:V?.pal.character_key}}),g=await _.showModal(Cl,{title:"Select preset",selectedPals:M});if(!g)return;const i=Ka.presetProfiles[g];e(r).forEach(L=>{const V=e(o)?.find(v=>v.id===L);V&&gl(V.pal,i,void 0)})}function Bc(u,r,o){e(r).length===e(o).length?d(r,[],!0):d(r,e(o).map(_=>_.id),!0)}async function zc(u,r,o,_,M,g){if(e(r).length===0)return;const i=e(r).map(A=>e(o)?.find(Q=>Q.id===A)?.pal).filter(Boolean);if(i.length===0)return;const L=await _.showModal(al,{title:"Clone to UPS",message:`Clone ${i.length} selected Pals to your Universal Pal Storage.`,pals:i});if(!L)return;const{collectionId:V,tags:v,notes:se}=L;try{await M.cloneToUps(e(r),"gps",void 0,V,v.length>0?v:void 0,se||void 0),g.add(`Successfully cloned ${i.length} Pals to UPS`,"Success","success"),d(r,[],!0)}catch(A){console.error("Bulk clone to UPS failed:",A),g.add("Bulk clone to UPS failed. Please try again.","Error","error")}}var Nc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Uc=n('<div class="flex flex-col"><span>Select all in</span> <div class="grid grid-cols-[auto_1fr] gap-1"><img alt="Left Click" class="h-6 w-6"/> <span class="text-sm">pal box</span> <div class="flex"><img alt="Ctrl" class="h-6 w-6"/> <img alt="Left Click" class="h-6 w-6"/></div> <span class="text-sm">pal box + party</span></div></div>'),qc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Kc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Fc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Hc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Gc=(u,r)=>d(r,[],!0),Rc=n('<button class="btn hover:preset-tonal-secondary p-2"><!></button>'),Vc=n("<!> <!> <!> <!>",1),Wc=n('<span class="font-bold">Filter & Sort</span>'),Xc=(u,r)=>r("level"),Qc=n('<button type="button"><!></button>'),Jc=(u,r)=>r("name"),Yc=n('<button type="button"><!></button>'),Zc=(u,r)=>r("paldeck-index"),ed=n('<button type="button"><!></button>'),td=(u,r)=>d(r,"All"),ad=n("<button><!></button>"),ld=(u,r,o)=>d(r,e(o),!0),sd=n('<button><img class="pal-element-badge svelte-olzjqy"/></button>'),rd=(u,r)=>d(r,"alpha"),od=n('<button type="button"><img alt="Alpha" class="pal-element-badge svelte-olzjqy"/></button>'),nd=(u,r)=>d(r,"lucky"),id=n('<button type="button"><img alt="Alpha" class="pal-element-badge svelte-olzjqy"/></button>'),cd=(u,r)=>d(r,"human"),dd=n('<button type="button"><!></button>'),vd=(u,r)=>d(r,"predator"),ud=n('<button type="button"><img alt="Predator" class="pal-element-badge svelte-olzjqy"/></button>'),_d=(u,r)=>d(r,"oilrig"),pd=n('<button type="button"><img alt="Oil Rig" class="pal-element-badge svelte-olzjqy"/></button>'),fd=(u,r)=>d(r,"summon"),md=n('<button type="button"><img alt="Summoned" class="pal-element-badge svelte-olzjqy"/></button>'),gd=n('<!> <div><legend class="font-bold">Sort</legend> <hr/> <div class="grid grid-cols-6"><!> <!> <!></div></div> <div><legend class="font-bold">Element & Type</legend> <hr/> <div class="mt-2 grid grid-cols-4 2xl:grid-cols-6"><!> <!> <!> <!> <!> <!> <!> <!></div></div>',1),hd=n('<span class="font-bold">Stats</span>'),yd=n("<div>No pals data available</div>"),bd=n("<!> <!>",1),$d=n("<div>No pals data available</div>"),xd=n('<div><div class="shrink-0 p-4"><div class="btn-group bg-surface-900 mb-2 w-full items-center rounded-sm p-1"><!> <!> <!></div> <!></div> <div><div class="mb-4 flex items-center justify-center space-x-4"><button class="rounded-sm px-4 py-2 font-bold"><img alt="Previous" class="h-10 w-10"/></button> <div class="flex space-x-2"></div> <button class="rounded-sm px-4 py-2 font-bold"><img alt="Next" class="h-10 w-10"/></button></div> <div class="overflow-hidden"><div class="grid grid-cols-6 place-items-center gap-4 p-4"></div></div></div> <!></div>');function Pd(u,r){ga(r,!0);const o=30,_=960,M=16,g=Sa(),i=Oa(),L=nl(),V=Dl();let v=hl(r,["$$slots","$$events","$$legacy"]),se=Be(""),A=Be("All"),Q=Be(1),ae=Be(Mt([])),k=Be(Mt([])),C=Be("slot-index"),H=Be("asc"),I=Be(Mt([""]));const N=m(()=>Math.ceil(e(se)||e(A)!=="All"||e(C)!=="slot-index"?e(ae).length:_)/o),ye=m(()=>Math.max(1,Math.min(e(Q)-Math.floor(M/2),e(N)-M+1))),Ye=m(()=>Math.min(e(ye)+M-1,e(N))),Oe=m(()=>Array.from({length:e(Ye)-e(ye)+1},(p,w)=>e(ye)+w)),dt=m(()=>{const p=(e(Q)-1)*o,w=p+o;return e(se)||e(A)!=="All"||e(C)!=="slot-index"?e(ae).slice(p,w):Array(_).fill(void 0).map((j,Ie)=>{const ht=e(ae).find(kt=>kt.index==Ie);return ht||{id:`empty-${Ie}`,index:Ie,pal:{character_id:"None",character_key:"None",storage_slot:Ie,instance_id:`empty-${Ie}`,storage_id:"00000000-0000-0000-0000-000000000000"}}}).slice(p,w)}),lt=m(()=>Bt("btn",e(A)==="lucky"?"bg-secondary-500/25":"")),Ke=m(()=>Bt("btn",e(A)==="alpha"?"bg-secondary-500/25":"")),Fe=m(()=>Bt("btn",e(A)==="human"?"bg-secondary-500/25":"")),St=m(()=>Bt("btn",e(A)==="predator"?"bg-secondary-500/25":"")),it=m(()=>Bt("btn",e(A)==="oilrig"?"bg-secondary-500/25":"")),ft=m(()=>Bt("btn",e(A)==="summon"?"bg-secondary-500/25":"")),G=p=>Bt("btn",e(C)===p?"bg-secondary-500/25":""),D=p=>Bt("btn",e(A)===p?"bg-secondary-500/25":"");let b=m(()=>g.gps?Object.entries(g.gps).filter(([w,S])=>S&&S.character_id!=="None").map(([w,S])=>{const j=da.getByKey(S.character_key);return{id:S.instance_id,index:w,pal:S,palData:j}}):void 0),O=m(()=>Object.keys(ba.elements)),R=m(()=>{let p={};for(const w of e(O)){const S=ba.elements[w];S&&(p[w]=sa.loadImage(`${ca}/img/${S.icon}.webp`))}return p}),ee=m(()=>e(C)!=="level"?ll:e(H)==="asc"?ll:Ol),te=m(()=>e(C)!=="name"?sl:e(H)==="asc"?sl:Tl),y=m(()=>e(C)!=="paldeck-index"?rl:e(H)==="asc"?rl:zl);function P(p){p.target instanceof HTMLInputElement||(p.key==="ArrowLeft"||p.key==="q"||p.key==="Q"?X():(p.key==="ArrowRight"||p.key==="e"||p.key==="E")&&ie())}function X(){e(Q)>1?Fa(Q,-1):d(Q,e(N),!0)}function ie(){e(Q)<e(N)?Fa(Q):d(Q,1)}const Je=bl(We,300);async function We(){e(b)&&(d(ae,e(b).filter(({pal:p,palData:w})=>{if(!w)return!1;const S=w.localized_name.toLowerCase().includes(e(se).toLowerCase())||p.nickname?.toLowerCase().includes(e(se).toLowerCase())||p.character_id.toLowerCase().includes(e(se).toLowerCase()),j=e(O).includes(e(A))?w.element_types.map(ut=>ut.toString().toLowerCase()).includes(e(A).toLowerCase()):!0,Ie=e(A)==="alpha"?p.is_boss:!0,ht=e(A)==="lucky"?p.is_lucky:!0,kt=e(A)==="human"?!w?.is_pal:!0,et=e(A)==="predator"?p.character_id.toLowerCase().includes("predator_"):!0,ue=e(A)==="oilrig"?p.character_id.toLowerCase().includes("_oilrig"):!0,ze=e(A)==="summon"?p.character_id.toLowerCase().includes("summon_"):!0;return S&&j&&Ie&&ht&&kt&&et&&ue&&ze}),!0),Pe())}function Ue(p){e(C)===p?e(H)==="desc"?(d(C,"slot-index"),d(H,"asc")):d(H,e(H)==="asc"?"desc":"asc",!0):(d(C,p,!0),d(H,"asc")),Pe()}function Pe(){switch(e(C)){case"name":J();break;case"level":ve();break;case"paldeck-index":$e();break;default:be();break}}async function je(p){if(!g.gps)return;const w=await i.showModal(Pl,{title:"Add a new Pal to your GPS"});if(!w)return;const[S,j]=w,Ie=da.getByKey(S);Ht(Gt.ADD_GPS_PAL,{character_id:S,nickname:j||Ha(Ie?.localized_name||S,g.settings.new_pal_prefix),storage_slot:p})}async function $(p){const w=g.gps?_-Object.values(g.gps).length:0;if(w===0){L.add("There are no slots available in your Dimensional Pal Storage.","Error","error");return}const S=await i.showModal(il,{title:"How many clones?",message:`There are ${w} slots available in your Dimensional Pal Storage.`,value:1,min:0,max:w});if(S)for(let j=0;j<S;j++){const Ie=Qa(p);Ie.nickname=Ha(Ie.nickname||Ie.name||Ie.character_id,g.settings.clone_prefix),Ht(Gt.CLONE_DPS_PAL,{pal:Ie})}}async function F(p){await $(p)}function J(){d(ae,e(ae).sort((p,w)=>e(H)==="asc"?p.pal.name.localeCompare(w.pal.name):w.pal.name.localeCompare(p.pal.name)),!0)}function ve(){d(ae,e(ae).sort((p,w)=>e(H)==="asc"?p.pal.level-w.pal.level:w.pal.level-p.pal.level),!0)}function be(){d(ae,e(ae).sort((p,w)=>e(H)==="asc"?p.pal.storage_slot-w.pal.storage_slot:w.pal.storage_slot-p.pal.storage_slot),!0)}async function $e(){const p=e(ae).map(S=>da.pals[S.pal.character_key]),w=e(ae).map((S,j)=>[S,p[j]]);w.sort((S,j)=>{const Ie=S[1]?.pal_deck_index??1/0,ht=j[1]?.pal_deck_index??1/0;return e(H)==="asc"?Ie-ht:ht-Ie}),d(ae,w.map(S=>S[0]),!0)}function rt(p,w){!p||p.character_id==="None"||(w.ctrlKey||w.metaKey)&&(e(k).includes(p.instance_id)?d(k,e(k).filter(S=>S!==p.instance_id),!0):d(k,[...e(k),p.instance_id],!0))}async function Ze(){if(e(k).length===0)return;const p=await i.showConfirmModal({title:`Delete Pal${e(k).length>1?"s":""}`,message:`Are you sure you want to delete the ${e(k).length} selected pal${e(k).length==1?"":"s"}?`,confirmText:"Delete",cancelText:"Cancel"});if(g.gps&&p){const w=Object.entries(g.gps).filter(([S,j])=>e(k).includes(j.instance_id)).map(([S])=>S);Ht(Gt.DELETE_GPS_PALS,{pal_indexes:w}),g.gps=Object.fromEntries(Object.entries(g.gps).filter(([S,j])=>!w.includes(S)))}d(k,[],!0)}async function qe(p){const w=await i.showConfirmModal({title:"Delete Pal",message:`Are you sure you want to delete ${p.nickname||p.name}?`,confirmText:"Delete",cancelText:"Cancel"});if(g.gps&&w){const S=Object.entries(g.gps).find(([j,Ie])=>Ie.instance_id===p.instance_id);Ht(Gt.DELETE_GPS_PALS,{pal_indexes:[S[0]]}),g.gps=Object.fromEntries(Object.entries(g.gps).filter(([j,Ie])=>Ie.instance_id!==p.instance_id))}}zt(()=>{g.gps&&Je()}),zt(()=>{(e(se)||e(A))&&Je()}),zt(()=>(window.addEventListener("keydown",P),()=>{window.removeEventListener("keydown",P)})),zt(()=>{e(Q)>e(N)&&d(Q,1)}),zt(()=>{e(b)&&Je()});async function Ge(p){const w=await i.showModal(al,{title:"Clone to UPS",message:"Clone this Pal to your Universal Pal Storage.",pals:[p]});if(!w)return;const{collectionId:S,tags:j,notes:Ie}=w;try{await V.cloneToUps([p.instance_id],"gps",void 0,S,j.length>0?j:void 0,Ie||void 0),L.add(`Successfully cloned ${p.nickname||p.name} to UPS`,"Success","success")}catch(ht){console.error("Clone to UPS failed:",ht),L.add("Clone to UPS failed. Please try again.","Error","error")}}async function de(){g.gps&&await i.showModal(Ll,{title:"Fill Global Pal Storage",player:g.selectedPlayer,target:"gps"})}var Re=xd();yl(Re,()=>({class:"grid h-full w-full grid-cols-[25%_1fr] 2xl:grid-cols-[25%_1fr_20%]",...v}),void 0,void 0,"svelte-olzjqy");var Pt=a(Re),vt=a(Pt),Ut=a(vt);W(Ut,{position:"right",label:"Add all pals to your Pal Box",children:(p,w)=>{var S=Nc();S.__click=de;var j=a(S);Nl(j,{}),t(S),s(p,S)},$$slots:{default:!0}});var Rt=l(Ut,2);W(Rt,{popup:w=>{var S=Uc(),j=l(a(S),2),Ie=a(j),ht=l(Ie,4),kt=a(ht),et=l(kt,2);t(ht),Qt(2),t(j),t(S),q(()=>{B(Ie,"src",he.leftClickIcon),B(kt,"src",he.ctrlIcon),B(et,"src",he.leftClickIcon)}),s(w,S)},children:(w,S)=>{var j=qc();j.__click=[Bc,k,ae];var Ie=a(j);xl(Ie,{}),t(j),s(w,j)},$$slots:{popup:!0,default:!0}});var x=l(Rt,2);{var c=p=>{var w=Vc(),S=Z(w);W(S,{label:"Apply preset to selected pal(s)",children:(kt,et)=>{var ue=Kc();ue.__click=[Tc,k,b,i];var ze=a(ue);el(ze,{}),t(ue),s(kt,ue)},$$slots:{default:!0}});var j=l(S,2);W(j,{label:"Clone selected pal(s) to UPS",children:(kt,et)=>{var ue=Fc();ue.__click=[zc,k,b,i,V,L];var ze=a(ue);Ml(ze,{}),t(ue),s(kt,ue)},$$slots:{default:!0}});var Ie=l(j,2);W(Ie,{label:"Delete selected pal(s)",children:(kt,et)=>{var ue=Hc();ue.__click=Ze;var ze=a(ue);tl(ze,{}),t(ue),s(kt,ue)},$$slots:{default:!0}});var ht=l(Ie,2);W(ht,{label:"Clear selected pal(s)",children:(kt,et)=>{var ue=Rc();ue.__click=[Gc,k];var ze=a(ue);kl(ze,{}),t(ue),s(kt,ue)},$$slots:{default:!0}}),s(p,w)};le(x,p=>{e(k).length>=1&&p(c)})}t(vt);var f=l(vt,2);Jt(f,{get value(){return e(I)},onValueChange:p=>d(I,p.value,!0),collapsible:!0,children:(p,w)=>{var S=bd(),j=Z(S);{const ht=ue=>{jl(ue,{})},kt=ue=>{var ze=Wc();s(ue,ze)},et=ue=>{var ze=gd(),ut=Z(ze);za(ut,{type:"text",inputClass:"w-full",placeholder:"Search by name or nickname",get value(){return e(se)},set value(oe){d(se,oe,!0)}});var jt=l(ut,2),Vt=l(a(jt),4),yt=a(Vt);W(yt,{label:"Sort by level",children:(oe,_e)=>{var U=Qc();U.__click=[Xc,Ue];var re=a(U);at(re,()=>e(ee),(pe,T)=>{T(pe,{})}),t(U),q(pe=>st(U,1,pe,"svelte-olzjqy"),[()=>pt(G("level"))]),s(oe,U)},$$slots:{default:!0}});var Ft=l(yt,2);W(Ft,{label:"Sort by name",children:(oe,_e)=>{var U=Yc();U.__click=[Jc,Ue];var re=a(U);at(re,()=>e(te),(pe,T)=>{T(pe,{})}),t(U),q(pe=>st(U,1,pe,"svelte-olzjqy"),[()=>pt(G("name"))]),s(oe,U)},$$slots:{default:!0}});var tt=l(Ft,2);W(tt,{label:"Sort by Paldeck #",children:(oe,_e)=>{var U=ed();U.__click=[Zc,Ue];var re=a(U);at(re,()=>e(y),(pe,T)=>{T(pe,{})}),t(U),q(pe=>st(U,1,pe,"svelte-olzjqy"),[()=>pt(G("paldeck-index"))]),s(oe,U)},$$slots:{default:!0}}),t(Vt),t(jt);var ke=l(jt,2),_t=l(a(ke),4),ct=a(_t);W(ct,{popup:_e=>{Qt();var U=va("All pals");s(_e,U)},children:(_e,U)=>{var re=ad();re.__click=[td,A];var pe=a(re);Ul(pe,{}),t(re),q(T=>st(re,1,T,"svelte-olzjqy"),[()=>pt(D("All"))]),s(_e,re)},$$slots:{popup:!0,default:!0}});var Lt=l(ct,2);Et(Lt,17,()=>[...e(O)],Nt,(oe,_e)=>{const U=m(()=>ba.elements[e(_e)].localized_name);W(oe,{get label(){return e(U)},children:(re,pe)=>{var T=sd();T.__click=[ld,A,_e];var ot=a(T);t(T),q(Me=>{st(T,1,Me,"svelte-olzjqy"),B(T,"aria-label",e(U)),B(ot,"src",e(R)[e(_e)]),B(ot,"alt",e(U))},[()=>pt(D(e(_e)))]),s(re,T)},$$slots:{default:!0}})});var wt=l(Lt,2);W(wt,{label:"Alpha Pals",children:(oe,_e)=>{var U=od();U.__click=[rd,A];var re=a(U);t(U),q(()=>{st(U,1,pt(e(Ke)),"svelte-olzjqy"),B(re,"src",he.alphaIcon)}),s(oe,U)},$$slots:{default:!0}});var Ee=l(wt,2);W(Ee,{label:"Lucky Pals",children:(oe,_e)=>{var U=id();U.__click=[nd,A];var re=a(U);t(U),q(()=>{st(U,1,pt(e(lt)),"svelte-olzjqy"),B(re,"src",he.luckyIcon)}),s(oe,U)},$$slots:{default:!0}});var He=l(Ee,2);W(He,{label:"Humans",children:(oe,_e)=>{var U=dd();U.__click=[cd,A];var re=a(U);dl(re,{}),t(U),q(()=>st(U,1,pt(e(Fe)),"svelte-olzjqy")),s(oe,U)},$$slots:{default:!0}});var we=l(He,2);W(we,{label:"Predator Pals",children:(oe,_e)=>{var U=ud();U.__click=[vd,A];var re=a(U);t(U),q(pe=>{st(U,1,pt(e(St)),"svelte-olzjqy"),B(re,"src",he.predatorIcon),Xa(re,`filter: ${pe??""};`)},[()=>qa("#FF0000")]),s(oe,U)},$$slots:{default:!0}});var Ae=l(we,2);W(Ae,{label:"Oil Rig Pals",children:(oe,_e)=>{var U=pd();U.__click=[_d,A];var re=a(U);t(U),q(()=>{st(U,1,pt(e(it)),"svelte-olzjqy"),B(re,"src",he.oilrigIcon)}),s(oe,U)},$$slots:{default:!0}});var Ve=l(Ae,2);W(Ve,{label:"Summoned Pals",children:(oe,_e)=>{var U=md();U.__click=[fd,A];var re=a(U);t(U),q(()=>{st(U,1,pt(e(ft)),"svelte-olzjqy"),B(re,"src",he.altarIcon)}),s(oe,U)},$$slots:{default:!0}}),t(_t),t(ke),s(ue,ze)};at(j,()=>Jt.Item,(ue,ze)=>{ze(ue,{value:"filter",base:"rounded-sm bg-surface-900",controlHover:"hover:bg-secondary-500/25",lead:ht,control:kt,panel:et,$$slots:{lead:!0,control:!0,panel:!0}})})}var Ie=l(j,2);{const ht=ue=>{Bl(ue,{})},kt=ue=>{var ze=hd();s(ue,ze)},et=ue=>{var ze=Ne(),ut=Z(ze);{var jt=yt=>{ol(yt,{get pals(){return e(b)},get elementTypes(){return e(O)}})},Vt=yt=>{var Ft=yd();s(yt,Ft)};le(ut,yt=>{e(b)&&e(b).length>0?yt(jt):yt(Vt,!1)})}s(ue,ze)};at(Ie,()=>Jt.Item,(ue,ze)=>{ze(ue,{value:"stats",base:"block 2xl:hidden rounded-sm bg-surface-900",controlHover:"hover:bg-secondary-500/25",lead:ht,control:kt,panel:et,$$slots:{lead:!0,control:!0,panel:!0}})})}s(p,S)},$$slots:{default:!0}}),t(Pt);var E=l(Pt,2),Y=a(E),Le=a(Y);Le.__click=X;var mt=a(Le);t(Le);var ta=l(Le,2);Et(ta,21,()=>e(Oe),Nt,(p,w)=>{{let S=m(()=>e(w)===e(Q)?"bg-primary-500 text-white":"bg-surface-800 hover:bg-gray-300"),j=m(()=>`Box ${e(w)}`);Na(p,{get class(){return`h-8 w-8 rounded-full ${e(S)??""}`},onclick:()=>d(Q,e(w),!0),get popupLabel(){return e(j)},children:(Ie,ht)=>{Qt();var kt=va();q(et=>ne(kt,et),[()=>Math.floor(e(w))]),s(Ie,kt)},$$slots:{default:!0}})}}),t(ta);var ua=l(ta,2);ua.__click=ie;var gt=a(ua);t(ua),t(Y);var h=l(Y,2),K=a(h);Et(K,21,()=>e(dt),p=>p.pal.instance_id,(p,w)=>{var S=Ne(),j=Z(S);{var Ie=ht=>{wl(ht,{get pal(){return e(w).pal},onSelect:rt,onMove:()=>{},onDelete:()=>qe(e(w).pal),onAdd:()=>je(e(w).index),onClone:()=>F(e(w).pal),onCloneToUps:()=>Ge(e(w).pal),get selected(){return e(k)},set selected(kt){d(k,kt,!0)}})};le(j,ht=>{(e(w).pal.character_id!=="None"||!e(se)&&e(A)==="All"&&e(C)==="slot-index")&&ht(Ie)})}s(p,S)}),t(K),t(h),t(E);var ce=l(E,2);{var De=p=>{Ua(p,{class:"mr-2 hidden h-[430px] 2xl:block",children:(w,S)=>{ol(w,{get pals(){return e(b)},get elementTypes(){return e(O)}})},$$slots:{default:!0}})},Te=p=>{Ua(p,{class:"mr-2 hidden h-[430px] 2xl:block",children:(w,S)=>{var j=$d();s(w,j)},$$slots:{default:!0}})};le(ce,p=>{e(b)&&e(b).length>0?p(De):p(Te,!1)})}t(Re),q(()=>{B(mt,"src",he.qIcon),B(gt,"src",he.eIcon)}),s(u,Re),ha()}Ga(["click"]);var kd=n('<button class="btn ml-4 h-8 w-8 p-2 hover:bg-red-500/50"><!></button>'),wd=n('<div class="flex items-center"><!> <!> <!></div>'),Cd=n("<div></div>"),Sd=n("<!> <!> <!>",1),Id=n("<!> <!> <!> <!> <!>",1),Ed=n('<div class="grow overflow-hidden"><!> <!> <!> <!> <!> <!> <!></div>'),Ad=n('<div class="flex h-full w-full overflow-hidden"><div class="relative h-full w-full"><div class="absolute left-2 right-2 top-0 flex min-w-72 flex-row items-center justify-between"><!> <a href="https://discord.gg/YWZFPy9G8J" target="_blank" rel="noopener noreferrer"><svg class="mr-2 h-5 w-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"></path></svg> Support</a></div> <!></div></div>');function Fd(u,r){ga(r,!0);const o=Sa(),_=Ts(),M=Oa(),g={KeyC:"player",KeyT:"technologies",KeyB:"pal-box",KeyD:"dps",KeyG:"guilds",KeyP:"pal",KeyS:"gps"};function i(I){switch(I){case"dps":return!!o.selectedPlayer?.dps;case"gps":return!!o.gps;default:return!0}}function L(I){if(I.target instanceof HTMLInputElement||I.target instanceof HTMLTextAreaElement||I.ctrlKey||I.altKey||I.metaKey||I.shiftKey||M.isOpen)return;const N=g[I.code];N&&i(N)&&(I.preventDefault(),_.activeTab=N)}zt(()=>(document.addEventListener("keydown",L),()=>{document.removeEventListener("keydown",L)}));async function V(){await M.showConfirmModal({title:"Delete Player",message:"Are you sure you want to delete this player? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel"})&&(Ht(Gt.DELETE_PLAYER,{player_id:o.selectedPlayer?.uid,origin:"edit"}),Zl("/loading"))}var v=Ad(),se=a(v),A=a(se),Q=a(A);{var ae=I=>{var N=wd(),ye=a(N);{let Ke=m(()=>o.selectedPlayer?.uid||void 0);ir(ye,{get selected(){return e(Ke)},onselect:Fe=>o.selectedPlayer=Fe})}var Ye=l(ye,2);{var Oe=Ke=>{{let Fe=m(()=>`/debug?guildId=${o.selectedPlayer?.guild_id}&playerId=${o.selectedPlayer.uid}`);El(Ke,{get href(){return e(Fe)}})}};le(Ye,Ke=>{o.selectedPlayer&&o.settings.debug_mode&&Ke(Oe)})}var dt=l(Ye,2);{var lt=Ke=>{W(Ke,{label:"Delete player",children:(Fe,St)=>{var it=kd();it.__click=V;var ft=a(it);ts(ft,{size:24}),t(it),s(Fe,it)},$$slots:{default:!0}})};le(dt,Ke=>{o.selectedPlayer&&Ke(lt)})}t(N),s(I,N)},k=I=>{var N=Cd();s(I,N)};le(Q,I=>{o.saveFile?I(ae):I(k,!1)})}var C=l(Q,2);t(A);var H=l(A,2);la(H,{listJustify:"justify-center",get value(){return _.activeTab},classes:"flex h-full flex-col mt-4",onValueChange:ye=>{_.activeTab=ye.value},list:ye=>{var Ye=Id(),Oe=Z(Ye);{var dt=D=>{var b=Sd(),O=Z(b);at(O,()=>la.Control,(te,y)=>{y(te,{value:"player",children:(P,X)=>{Wa(P,{text:"Player",key:"C"})},$$slots:{default:!0}})});var R=l(O,2);at(R,()=>la.Control,(te,y)=>{y(te,{value:"technologies",children:(P,X)=>{Wa(P,{text:"Technologies",key:"T"})},$$slots:{default:!0}})});var ee=l(R,2);at(ee,()=>la.Control,(te,y)=>{y(te,{value:"pal-box",children:(P,X)=>{Wa(P,{text:"Pal Box",key:"B"})},$$slots:{default:!0}})}),s(D,b)};le(Oe,D=>{o.saveFile&&D(dt)})}var lt=l(Oe,2);{var Ke=D=>{var b=Ne(),O=Z(b);at(O,()=>la.Control,(R,ee)=>{ee(R,{value:"dps",children:(te,y)=>{Wa(te,{text:"DPS",key:"D"})},$$slots:{default:!0}})}),s(D,b)};le(lt,D=>{o.selectedPlayer?.dps&&D(Ke)})}var Fe=l(lt,2);{var St=D=>{var b=Ne(),O=Z(b);at(O,()=>la.Control,(R,ee)=>{ee(R,{value:"gps",children:(te,y)=>{Wa(te,{text:"GPS",key:"S"})},$$slots:{default:!0}})}),s(D,b)};le(Fe,D=>{o.gps&&D(St)})}var it=l(Fe,2);{var ft=D=>{var b=Ne(),O=Z(b);at(O,()=>la.Control,(R,ee)=>{ee(R,{value:"guilds",children:(te,y)=>{Wa(te,{text:"Guild",key:"G"})},$$slots:{default:!0}})}),s(D,b)};le(it,D=>{o.saveFile&&D(ft)})}var G=l(it,2);at(G,()=>la.Control,(D,b)=>{b(D,{value:"pal",children:(O,R)=>{Wa(O,{text:"Pal",key:"P"})},$$slots:{default:!0}})}),s(ye,Ye)},content:ye=>{var Ye=Ed(),Oe=a(Ye);at(Oe,()=>la.Panel,(D,b)=>{b(D,{value:"player",classes:"h-screen",children:(O,R)=>{Lo(O,{})},$$slots:{default:!0}})});var dt=l(Oe,2);at(dt,()=>la.Panel,(D,b)=>{b(D,{value:"technologies",classes:"h-screen",children:(O,R)=>{Wi(O,{})},$$slots:{default:!0}})});var lt=l(dt,2);at(lt,()=>la.Panel,(D,b)=>{b(D,{value:"pal-box",classes:"h-screen",children:(O,R)=>{En(O,{})},$$slots:{default:!0}})});var Ke=l(lt,2);{var Fe=D=>{var b=Ne(),O=Z(b);at(O,()=>la.Panel,(R,ee)=>{ee(R,{value:"dps",classes:"h-screen",children:(te,y)=>{Oc(te,{})},$$slots:{default:!0}})}),s(D,b)};le(Ke,D=>{o.selectedPlayer?.dps&&D(Fe)})}var St=l(Ke,2);{var it=D=>{var b=Ne(),O=Z(b);at(O,()=>la.Panel,(R,ee)=>{ee(R,{value:"gps",classes:"h-screen",children:(te,y)=>{Pd(te,{})},$$slots:{default:!0}})}),s(D,b)};le(St,D=>{o.gps&&D(it)})}var ft=l(St,2);at(ft,()=>la.Panel,(D,b)=>{b(D,{value:"guilds",classes:"h-screen",children:(O,R)=>{wi(O,{})},$$slots:{default:!0}})});var G=l(ft,2);at(G,()=>la.Panel,(D,b)=>{b(D,{value:"pal",classes:"h-screen",children:(O,R)=>{Vr(O,{})},$$slots:{default:!0}})}),t(Ye),s(ye,Ye)},$$slots:{list:!0,content:!0}}),t(se),t(v),q(()=>st(C,1,`mr-2 inline-flex rounded-md bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700 ${o.saveFile?"":"mt-3"}`)),s(u,v),ha()}Ga(["click"]);export{Fd as component};
