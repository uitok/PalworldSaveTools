import{l as Je,b as Qe,i as y,c as Bt}from"../chunks/woX702LQ.js";import{e as De,g as he,h as n,l as pt,p as at,f as d,c as a,i as t,u as I,r as e,j as rt,b as r,t as C,k as m,n as vt,d as ut,s as It,z as va}from"../chunks/B9aKyTE9.js";import{I as Ye,b as et,Z as ua,_ as pa,C as fa,W as xt,$ as it,X as Wt,a0 as st,g as Ht,a1 as _a,l as $t,a2 as Xt,a as Zt,a3 as qt,a4 as Jt,i as Qt,h as Ge,t as K,a5 as yt,a6 as wt,a7 as ga,T as kt,a8 as Mt,a9 as Yt,aa as ma,ab as ea,j as nt,s as Xe,K as ct,f as ta,A as aa,V as ha,ac as ba,w as xa,E as ya,z as wa,c as Ze,ad as ka,ae as $a}from"../chunks/FTlQNedl.js";import{r as ra,b as Ee,d as At,s as ze,A as Kt,c as qe}from"../chunks/DPqr1Em3.js";import{g as Pa}from"../chunks/B7z-6CDi.js";import{D as sa}from"../chunks/CYFWRQLF.js";import{U as Lt,S as Sa,A as Ot,a as Ta,b as Ca,c as Vt,d as Ma}from"../chunks/CF87TII9.js";import{N as Aa}from"../chunks/BVdvzYUS.js";function La(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8"}],["path",{d:"M10 12h4"}]];Ye(u,Qe({name:"archive"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function Ia(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["path",{d:"M8 2v4"}],["path",{d:"M16 2v4"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M3 10h18"}]];Ye(u,Qe({name:"calendar"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function la(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16"}],["path",{d:"M18 17V9"}],["path",{d:"M13 17V5"}],["path",{d:"M8 17v-3"}]];Ye(u,Qe({name:"chart-column"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function Fa(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}]];Ye(u,Qe({name:"filter"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function Ea(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["path",{d:"M12 10v6"}],["path",{d:"M9 13h6"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"}]];Ye(u,Qe({name:"folder-plus"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function za(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}],["path",{d:"M3 9h18"}],["path",{d:"M3 15h18"}],["path",{d:"M9 3v18"}],["path",{d:"M15 3v18"}]];Ye(u,Qe({name:"grid-3x3"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function Da(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["path",{d:"M3 12h.01"}],["path",{d:"M3 18h.01"}],["path",{d:"M3 6h.01"}],["path",{d:"M8 12h13"}],["path",{d:"M8 18h13"}],["path",{d:"M8 6h13"}]];Ye(u,Qe({name:"list"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function Rt(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"}]];Ye(u,Qe({name:"star"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function Na(u,l){const i=Je(l,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17"}],["polyline",{points:"16 7 22 7 22 13"}]];Ye(u,Qe({name:"trending-up"},()=>i,{get iconNode(){return s},children:(w,b)=>{var v=De(),g=he(v);et(g,l,"default",{},null),n(w,v)},$$slots:{default:!0}}))}function Ua(u,l,i){u.ctrlKey||u.metaKey?l.onSelect&&l.onSelect(l.upsPal,u):i()}function ja(u,l){(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),l())}var Ba=d('<div role="button" tabindex="0"><!></div>');function oa(u,l){at(l,!0);const i=st(),s=$t(),w=Ht(),b=_a(),v=Zt(),g=I(()=>{let $={...l.upsPal.pal_data,id:l.upsPal.id};return!$.character_key&&l.upsPal.character_key&&($.character_key=l.upsPal.character_key),$}),x=I(()=>[{label:"Clone Pal",onClick:()=>W(),icon:fa},{label:"Export",onClick:()=>ke(),icon:xt},{label:"Add to Collection",onClick:()=>fe(),icon:Ea},{label:"Manage Tags",onClick:()=>oe(),icon:it},{label:"Delete from UPS",onClick:()=>ce(),icon:Wt}]),ne=I(()=>i.selectedPals.size>0?Array.from(i.selectedPals).map($=>$.toString()):[]);function Y(){const $={...t(g),__ups_source:!0,__ups_id:l.upsPal.id};w.selectedPal=$,b.activeTab="pal",Pa("/edit")}async function W(){await s.showConfirmModal({title:"Clone Pal",message:`Are you sure you want to clone ${l.upsPal.nickname||l.upsPal.character_id}?`,confirmText:"Clone",cancelText:"Cancel"})&&await i.clonePal(l.upsPal.id)}async function ke(){const $=await s.showModal(Xt,{title:"Export Pal",pals:[l.upsPal]});if($){const q=$.target;try{await i.exportPal(l.upsPal.id,q,$.playerId),v.add(`Successfully exported ${l.upsPal.nickname||l.upsPal.character_id} to ${$.target.toUpperCase()}`,"Success","success")}catch(D){console.error("Export failed:",D),v.add("Export failed. Please try again.","Error","error")}}}async function fe(){const $=await s.showModal(qt,{title:"Add to Collection",pals:[l.upsPal]});if($){const q=$.removeFromCollection?void 0:$.collectionId;try{await i.updatePal(l.upsPal.id,{collection_id:q}),await i.loadAll(),$.removeFromCollection?v.add("Removed pal from collection","Success","success"):v.add("Added pal to collection","Success","success")}catch(D){console.error("Collection update failed:",D),v.add("Failed to update collection. Please try again.","Error","error")}}}async function oe(){const $=await s.showModal(Jt,{title:"Manage Tags",pals:[l.upsPal]});if($)try{await i.updatePal(l.upsPal.id,{tags:$}),await i.loadAll(),v.add("Updated pal tags","Success","success")}catch(q){console.error("Tag update failed:",q),v.add("Failed to update tags. Please try again.","Error","error")}}async function ce(){await s.showConfirmModal({title:"Delete from UPS",message:`Are you sure you want to delete ${l.upsPal.nickname||l.upsPal.character_id} from Universal Pal Storage? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel"})&&await i.deletePals([l.upsPal.id])}function _e(){}ua(u,{get items(){return t(x)},menuClass:"bg-surface-700",xOffset:-32,children:($,q)=>{var D=Ba();D.__click=[Ua,l,Y],D.__keydown=[ja,Y];var Me=a(D);pa(Me,{get pal(){return t(g)},get selected(){return t(ne)},onSelect:(ie,Ne)=>{l.onSelect&&l.onSelect(ie,Ne)},onMove:_e,onAdd:_e,onClone:_e,onDelete:_e}),e(D),n($,D)},$$slots:{default:!0}}),rt()}pt(["click","keydown"]);var Ka=d('<div class="rounded bg-black/70 px-2 py-1 text-xs text-white"> </div>'),Oa=d('<div title="Transfer count"> </div>'),Va=d('<div title="Clone count"> </div>'),Ra=d('<div class="space-y-1 rounded bg-black/70 px-2 py-1 text-xs text-white"><!> <!></div>'),Ga=d('<div class="relative"><div class="relative"><!></div> <div class="absolute bottom-2 right-2"><!></div> <div class="absolute right-2 top-2 text-right"><!></div></div>'),Wa=d('<div class="p-6"><div class="grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8"></div></div>');function Ha(u,l){at(l,!1);const i=st();function s(v,g){(g.ctrlKey||g.metaKey)&&i.togglePalSelection(v.id)}Qt();var w=Wa(),b=a(w);Ge(b,5,()=>i.pals,v=>v.id,(v,g)=>{var x=Ga(),ne=a(x),Y=a(ne);oa(Y,{get upsPal(){return t(g)},onSelect:s}),e(ne);var W=r(ne,2),ke=a(W);{var fe=$=>{var q=Ka(),D=a(q);e(q),C(()=>m(D,`${t(g).tags.length??""}üè∑Ô∏è`)),n($,q)};y(ke,$=>{t(g).tags&&t(g).tags.length>0&&$(fe)})}e(W);var oe=r(W,2),ce=a(oe);{var _e=$=>{var q=Ra(),D=a(q);{var Me=ee=>{var $e=Oa(),Fe=a($e);e($e),C(()=>m(Fe,`üì§${t(g).transfer_count??""}`)),n(ee,$e)};y(D,ee=>{t(g).transfer_count>0&&ee(Me)})}var ie=r(D,2);{var Ne=ee=>{var $e=Va(),Fe=a($e);e($e),C(()=>m(Fe,`üîÑ${t(g).clone_count??""}`)),n(ee,$e)};y(ie,ee=>{t(g).clone_count>0&&ee(Ne)})}e(q),n($,q)};y(ce,$=>{(t(g).transfer_count>0||t(g).clone_count>0)&&$(_e)})}e(oe),e(x),n(v,x)}),e(b),e(w),n(u,w),rt()}var Xa=(u,l)=>l(null),Za=(u,l,i)=>l(t(i)),qa=d('<div class="group relative"><button><div class="h-4 w-4 flex-shrink-0 rounded"></div> <span class="flex-1 truncate"> </span> <span class="text-surface-200 text-xs"> </span></button> <div class="absolute right-1 top-1 flex items-center gap-1 opacity-0 transition-opacity group-hover:opacity-100"><!> <!></div></div>'),Ja=d('<div class="mb-4"><h3 class="text-surface-600 dark:text-surface-400 mb-2 text-sm font-medium uppercase tracking-wide">Favorites</h3> <div class="space-y-1"></div></div>'),Qa=d('<h3 class="text-surface-600 dark:text-surface-400 mb-2 text-sm font-medium uppercase tracking-wide">Collections</h3>'),Ya=(u,l,i)=>l(t(i)),er=d('<div class="group relative"><button><div class="h-4 w-4 flex-shrink-0 rounded"></div> <span class="flex-1 truncate"> </span> <span class="text-surface-200 text-xs"> </span></button> <div class="absolute right-1 top-1 flex items-center gap-1 opacity-0 transition-opacity group-hover:opacity-100"><!> <!> <!> <!></div></div>'),tr=d('<div class="mb-4"><!> <div class="space-y-1"></div></div>'),ar=d('<button class="text-primary-600 hover:text-primary-700 mt-2 text-sm">Create your first collection</button>'),rr=d('<div class="py-8 text-center"><!> <p class="text-surface-500 text-sm"> </p> <!></div>'),sr=d('<div class="flex h-full flex-col transition-all duration-300 ease-in-out"><div class="border-surface-300 dark:border-surface-700 border-b p-4"><div class="mb-3 flex items-center justify-between"><h2 class="text-lg font-semibold">Collections</h2> <!></div> <button><!> <span class="flex-1">All Pals</span> <span class="text-surface-200 text-xs"> </span></button></div> <div class="flex-1 space-y-1 overflow-auto p-4"><!> <!> <!></div> <div class="border-surface-300 dark:border-surface-700 border-t p-4"><label class="flex items-center gap-2 text-sm"><input type="checkbox" class="border-surface-300 rounded"/> Show archived</label></div></div>');function lr(u,l){at(l,!0);const i=st(),s=$t();let w=It(!1);const b=I(()=>i.collections.filter(p=>t(w)||!p.is_archived)),v=I(()=>t(b).filter(p=>p.is_favorite)),g=I(()=>t(b).filter(p=>!p.is_favorite));async function x(){const p=await s.showModal(kt,{title:"Create Collection",value:"",inputLabel:"Enter a name for the new collection:"});p&&await i.createCollection(p)}async function ne(p){const L=await s.showModal(kt,{title:"Edit Collection",value:p.name,inputLabel:"Enter new name for the collection:"});L&&L!==p.name&&await i.updateCollection(p.id,{name:L})}async function Y(p){await i.updateCollection(p.id,{is_favorite:!p.is_favorite})}async function W(p){await i.updateCollection(p.id,{is_archived:!p.is_archived})}async function ke(p){await s.showConfirmModal({title:"Delete Collection",message:`Are you sure you want to delete "${p.name}"? Pals in this collection will not be deleted, but they will no longer be associated with this collection.`,confirmText:"Delete",cancelText:"Cancel"})&&await i.deleteCollection(p.id)}function fe(p){i.updateCollectionFilter(p?.id),i.loadPals(!0)}function oe(p){return i.filters.collectionId===p}var ce=sr(),_e=a(ce),$=a(_e),q=r(a($),2);K(q,{onclick:x,class:"bg-primary-500 hover:bg-primary-600 rounded-md p-2 text-white",popupLabel:"Create Collection",children:(p,L)=>{yt(p,{class:"h-4 w-4"})},$$slots:{default:!0}}),e($);var D=r($,2);D.__click=[Xa,fe];var Me=a(D);wt(Me,{class:"h-4 w-4"});var ie=r(Me,4),Ne=a(ie,!0);e(ie),e(D),e(_e);var ee=r(_e,2),$e=a(ee);{var Fe=p=>{var L=Ja(),R=r(a(L),2);Ge(R,21,()=>t(v),U=>U.id,(U,O)=>{var H=qa(),G=a(H);G.__click=[Za,fe,O];var ve=a(G),f=r(ve,2),M=a(f,!0);e(f);var B=r(f,2),Ae=a(B,!0);e(B),e(G);var Te=r(G,2),be=a(Te);K(be,{onclick:X=>{X.stopPropagation(),Y(t(O))},class:"rounded bg-black/20 p-1 text-white hover:bg-black/40",popupLabel:"Remove from favorites",size:"sm",children:(X,xe)=>{Rt(X,{class:"h-3 w-3 fill-current"})},$$slots:{default:!0}});var Pe=r(be,2);K(Pe,{onclick:X=>{X.stopPropagation(),ne(t(O))},class:"rounded bg-black/20 p-1 text-white hover:bg-black/40",popupLabel:"Edit collection",size:"sm",children:(X,xe)=>{Mt(X,{class:"h-3 w-3"})},$$slots:{default:!0}}),e(Te),e(H),C(X=>{Ee(G,1,`hover:bg-surface-200 dark:hover:bg-surface-700 flex w-full items-center gap-2 rounded-md p-2 text-left ${X??""}`),At(ve,`background-color: ${t(O).color||"#6366f1"}`),m(M,t(O).name),m(Ae,t(O).pal_count)},[()=>oe(t(O).id)?"bg-primary-500 text-white":""]),n(U,H)}),e(R),e(L),n(p,L)};y($e,p=>{t(v).length>0&&p(Fe)})}var T=r($e,2);{var P=p=>{var L=tr(),R=a(L);{var U=H=>{var G=Qa();n(H,G)};y(R,H=>{t(v).length>0&&H(U)})}var O=r(R,2);Ge(O,21,()=>t(g),H=>H.id,(H,G)=>{var ve=er(),f=a(ve);f.__click=[Ya,fe,G];var M=a(f),B=r(M,2),Ae=a(B,!0);e(B);var Te=r(B,2),be=a(Te,!0);e(Te),e(f);var Pe=r(f,2),X=a(Pe);K(X,{onclick:Q=>{Q.stopPropagation(),Y(t(G))},class:"rounded bg-black/20 p-1 text-white hover:bg-black/40",popupLabel:"Add to favorites",size:"sm",children:(Q,tt)=>{Rt(Q,{class:"h-3 w-3"})},$$slots:{default:!0}});var xe=r(X,2);K(xe,{onclick:Q=>{Q.stopPropagation(),ne(t(G))},class:"rounded bg-black/20 p-1 text-white hover:bg-black/40",popupLabel:"Edit collection",size:"sm",children:(Q,tt)=>{Mt(Q,{class:"h-3 w-3"})},$$slots:{default:!0}});var Ue=r(xe,2);K(Ue,{onclick:Q=>{Q.stopPropagation(),W(t(G))},class:"rounded bg-black/20 p-1 text-white hover:bg-black/40",popupLabel:"Archive collection",size:"sm",children:(Q,tt)=>{La(Q,{class:"h-3 w-3"})},$$slots:{default:!0}});var je=r(Ue,2);K(je,{onclick:Q=>{Q.stopPropagation(),ke(t(G))},class:"rounded bg-red-500/80 p-1 text-white hover:bg-red-600/80",popupLabel:"Delete collection",size:"sm",children:(Q,tt)=>{Yt(Q,{class:"h-3 w-3"})},$$slots:{default:!0}}),e(Pe),e(ve),C(Q=>{Ee(f,1,`hover:bg-surface-200 dark:hover:bg-surface-700 flex w-full items-center gap-2 rounded-md p-2 text-left ${Q??""}`),At(M,`background-color: ${t(G).color||"#6366f1"}`),m(Ae,t(G).name),m(be,t(G).pal_count)},[()=>oe(t(G).id)?"bg-primary-500 text-white":""]),n(H,ve)}),e(O),e(L),n(p,L)};y(T,p=>{t(g).length>0&&p(P)})}var N=r(T,2);{var j=p=>{var L=rr(),R=a(L);wt(R,{class:"text-surface-400 mx-auto mb-3 h-12 w-12"});var U=r(R,2),O=a(U,!0);e(U);var H=r(U,2);{var G=ve=>{var f=ar();f.__click=x,n(ve,f)};y(H,ve=>{t(w)||ve(G)})}e(L),C(()=>m(O,t(w)?"No archived collections":"No collections yet")),n(p,L)};y(N,p=>{t(b).length===0&&p(j)})}e(ee);var de=r(ee,2),te=a(de),J=a(te);ra(J),vt(),e(te),e(de),e(ce),C(()=>{Ee(D,1,`hover:bg-surface-200 dark:hover:bg-surface-700 flex w-full items-center gap-2 rounded-md p-2 text-left ${i.filters.collectionId===void 0?"bg-primary-500 text-white":""}`),m(Ne,i.stats?.total_pals||0)}),ga(J,()=>t(w),p=>ut(w,p)),n(u,ce),rt()}pt(["click"]);function or(u,l){l.updateTagFilter([]),l.loadPals(!0)}var ir=(u,l,i)=>l(t(i)),nr=d('<span class="bg-primary-100 text-primary-800 dark:bg-primary-900/30 dark:text-primary-300 inline-flex items-center gap-1 rounded px-2 py-1 text-xs"> <button class="hover:text-primary-600"><!></button></span>'),cr=d('<div class="mt-3"><div class="mb-2 flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-xs font-medium uppercase tracking-wide"> </span> <button class="text-primary-600 hover:text-primary-700 text-xs">Clear All</button></div> <div class="flex flex-wrap gap-1"></div></div>'),dr=(u,l,i)=>l(t(i).name),vr=d('<div class="group relative"><button><div class="h-3 w-3 flex-shrink-0 rounded-full"></div> <span class="flex-1 truncate font-medium"> </span> <span> </span></button> <div class="absolute right-1 top-1 flex items-center gap-1 opacity-0 transition-opacity group-hover:opacity-100"><!> <!></div></div>'),ur=d('<div class="space-y-1"></div>'),pr=d('<div class="py-8 text-center"><!> <p class="text-surface-500 mb-2 text-sm"> </p> <button class="text-primary-600 hover:text-primary-700 text-sm"> </button></div>'),fr=d('<div class="py-8 text-center"><!> <p class="text-surface-500 mb-2 text-sm">No tags yet</p> <button class="text-primary-600 hover:text-primary-700 text-sm">Create your first tag</button></div>'),_r=d('<div class="border-surface-300 dark:border-surface-700 border-t p-4"><p class="text-surface-500 text-center text-xs"> </p></div>'),gr=d('<div class="flex h-full flex-col"><div class="border-surface-300 dark:border-surface-700 border-b p-4"><div class="mb-3 flex items-center justify-between"><h2 class="text-lg font-semibold">Tags</h2> <!></div> <div class="relative"><input type="text" placeholder="Search tags..." class="border-surface-300 dark:border-surface-600 dark:bg-surface-800 w-full rounded-md border bg-white py-2 pl-8 pr-3 text-sm"/> <!></div> <!></div> <div class="flex-1 overflow-auto p-4"><!></div> <!></div>');function mr(u,l){at(l,!0);const i=st(),s=$t();let w=It("");const b=I(()=>i.availableTags.filter(T=>T.name.toLowerCase().includes(t(w).toLowerCase())));async function v(){const T=await s.showModal(kt,{title:"Create Tag",value:"",inputLabel:"Enter a name for the new tag:"});T&&await i.createTag(T)}async function g(T){const P=await s.showModal(kt,{title:"Edit Tag",value:T.name,inputLabel:"Enter new name for the tag:"});P&&P!==T.name&&await i.updateTag(T.id,{name:P})}async function x(T){await s.showConfirmModal({title:"Delete Tag",message:`Are you sure you want to delete "${T.name}"? This tag will be removed from all Pals that have it.`,confirmText:"Delete",cancelText:"Cancel"})&&await i.deleteTag(T.id)}function ne(T){const P=[...i.filters.tags],N=P.indexOf(T);N>=0?P.splice(N,1):P.push(T),i.updateTagFilter(P),i.loadPals(!0)}function Y(T){return i.filters.tags.includes(T)}var W=gr(),ke=a(W),fe=a(ke),oe=r(a(fe),2);K(oe,{onclick:v,class:"bg-primary-500 hover:bg-primary-600 rounded-md p-2 text-white",popupLabel:"Create Tag",children:(T,P)=>{yt(T,{class:"h-4 w-4"})},$$slots:{default:!0}}),e(fe);var ce=r(fe,2),_e=a(ce);ra(_e);var $=r(_e,2);it($,{class:"text-surface-500 absolute left-2.5 top-1/2 h-3 w-3 -translate-y-1/2"}),e(ce);var q=r(ce,2);{var D=T=>{var P=cr(),N=a(P),j=a(N),de=a(j);e(j);var te=r(j,2);te.__click=[or,i],e(N);var J=r(N,2);Ge(J,21,()=>i.filters.tags,nt,(p,L)=>{var R=nr(),U=a(R),O=r(U);O.__click=[ir,ne,L];var H=a(O);ea(H,{class:"h-3 w-3"}),e(O),e(R),C(()=>m(U,`${t(L)??""} `)),n(p,R)}),e(J),e(P),C(()=>m(de,`Active Filters (${i.filters.tags.length??""})`)),n(T,P)};y(q,T=>{i.filters.tags.length>0&&T(D)})}e(ke);var Me=r(ke,2),ie=a(Me);{var Ne=T=>{var P=ur();Ge(P,21,()=>t(b),N=>N.id,(N,j)=>{const de=I(()=>Y(t(j).name));var te=vr(),J=a(te);J.__click=[dr,ne,j];var p=a(J),L=r(p,2),R=a(L,!0);e(L);var U=r(L,2),O=a(U,!0);e(U),e(J);var H=r(J,2),G=a(H);K(G,{onclick:f=>{f.stopPropagation(),g(t(j))},class:"rounded bg-black/20 p-1 text-white hover:bg-black/40",popupLabel:"Edit tag",size:"sm",children:(f,M)=>{Mt(f,{class:"h-3 w-3"})},$$slots:{default:!0}});var ve=r(G,2);K(ve,{onclick:f=>{f.stopPropagation(),x(t(j))},class:"rounded bg-red-500/80 p-1 text-white hover:bg-red-600/80",popupLabel:"Delete tag",size:"sm",children:(f,M)=>{Yt(f,{class:"h-3 w-3"})},$$slots:{default:!0}}),e(H),e(te),C(()=>{Ee(J,1,`hover:bg-surface-200 dark:hover:bg-surface-700 flex w-full items-center gap-3 rounded-md p-2 text-left transition-colors ${t(de)?"bg-primary-500 text-white":""}`),At(p,`background-color: ${t(j).color||"#6366f1"}`),m(R,t(j).name),Ee(U,1,`flex-shrink-0 text-xs ${t(de)?"text-primary-100":"text-surface-500"}`),m(O,t(j).usage_count)}),n(N,te)}),e(P),n(T,P)},ee=T=>{var P=De(),N=he(P);{var j=te=>{var J=pr(),p=a(J);it(p,{class:"text-surface-400 mx-auto mb-3 h-12 w-12"});var L=r(p,2),R=a(L);e(L);var U=r(L,2);U.__click=v;var O=a(U);e(U),e(J),C(()=>{m(R,`No tags found matching "${t(w)??""}"`),m(O,`Create "${t(w)??""}" tag`)}),n(te,J)},de=te=>{var J=De(),p=he(J);{var L=R=>{var U=fr(),O=a(U);it(O,{class:"text-surface-400 mx-auto mb-3 h-12 w-12"});var H=r(O,4);H.__click=v,e(U),n(R,U)};y(p,R=>{i.availableTags.length===0&&R(L)},!0)}n(te,J)};y(N,te=>{t(w)?te(j):te(de,!1)},!0)}n(T,P)};y(ie,T=>{t(b).length>0?T(Ne):T(ee,!1)})}e(Me);var $e=r(Me,2);{var Fe=T=>{var P=_r(),N=a(P),j=a(N);e(N),e(P),C(()=>m(j,`${i.availableTags.length??""} tag${i.availableTags.length>1?"s":""} available`)),n(T,P)};y($e,T=>{i.availableTags.length>0&&T(Fe)})}e(W),ma(_e,()=>t(w),T=>ut(w,T)),n(u,W),rt()}pt(["click"]);var hr=d('<div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-4"><h3 class="text-surface-900 dark:text-surface-100 mb-3 text-sm font-medium">Most Popular</h3> <div class="space-y-2"><div><span class="text-surface-600 dark:text-surface-400 text-sm">Character:</span> <span class="ml-2 font-medium"> </span></div></div></div>'),br=d('<div class="flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-sm">Avg. Pals per collection:</span> <span class="font-medium"> </span></div>'),xr=d('<div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-4"><h3 class="text-surface-900 dark:text-surface-100 mb-3 text-sm font-medium">Distribution</h3> <div class="space-y-2"><div class="flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-sm">Avg. transfers per Pal:</span> <span class="font-medium"> </span></div> <div class="flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-sm">Avg. clones per Pal:</span> <span class="font-medium"> </span></div> <!></div></div>'),yr=d('<div class="flex items-center"><img class="mr-2 h-5 w-5"/> <div class="grow"><span class="text-xs"> </span></div> <span class="font-medium"> </span></div>'),wr=d('<div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-4"><h3 class="text-surface-900 dark:text-surface-100 mb-3 text-sm font-medium">Elemental Distribution</h3> <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm"></div></div>'),kr=d('<div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-4"><h3 class="text-surface-900 dark:text-surface-100 mb-3 text-sm font-medium">Special Categories</h3> <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm"><div class="flex items-center"><img alt="Alpha" class="mr-2 h-5 w-5"/> <div class="grow"><span class="text-xs">Alpha</span></div> <span class="font-medium"> </span></div> <div class="flex items-center"><img alt="Lucky" class="mr-2 h-5 w-5"/> <div class="grow"><span class="text-xs">Lucky</span></div> <span class="font-medium"> </span></div> <div class="flex items-center"><!> <div class="grow"><span class="text-xs">Human</span></div> <span class="font-medium"> </span></div> <div class="flex items-center"><img alt="Predator" class="mr-2 h-5 w-5"/> <div class="grow"><span class="text-xs">Predator</span></div> <span class="font-medium"> </span></div> <div class="flex items-center"><img alt="Oil Rig" class="mr-2 h-5 w-5"/> <div class="grow"><span class="text-xs">Oil Rig</span></div> <span class="font-medium"> </span></div> <div class="flex items-center"><img alt="Summoned" class="mr-2 h-5 w-5"/> <div class="grow"><span class="text-xs">Summoned</span></div> <span class="font-medium"> </span></div></div></div>'),$r=d('<div class="bg-surface-100 dark:bg-surface-700 rounded-lg p-3"><div class="text-surface-600 dark:text-surface-400 flex items-center gap-2 text-xs"><!> <span> </span></div></div>'),Pr=d('<div class="grid grid-cols-2 gap-3"><div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-3"><div class="mb-1 flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-sm">Pals</span> <!></div> <div class="text-surface-900 dark:text-surface-100 text-2xl font-bold"> </div></div> <div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-3"><div class="mb-1 flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-sm">Collections</span> <!></div> <div class="text-surface-900 dark:text-surface-100 text-2xl font-bold"> </div></div> <div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-3"><div class="mb-1 flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-sm">Tags</span> <span class="text-xl">üè∑Ô∏è</span></div> <div class="text-surface-900 dark:text-surface-100 text-2xl font-bold"> </div></div> <div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-3"><div class="mb-1 flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-sm">Storage</span> <span class="text-xl">üíæ</span></div> <div class="text-surface-900 dark:text-surface-100 text-lg font-bold"> </div></div></div> <div class="dark:bg-surface-800 border-surface-300 dark:border-surface-700 rounded-lg border bg-white p-4"><h3 class="text-surface-900 dark:text-surface-100 mb-3 text-sm font-medium">Activity</h3> <div class="space-y-3"><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-xl">üì§</span> <span class="text-surface-600 dark:text-surface-400 text-sm">Total Exports</span></div> <span class="font-medium"> </span></div> <div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-xl">üîÑ</span> <span class="text-surface-600 dark:text-surface-400 text-sm">Total Clones</span></div> <span class="font-medium"> </span></div></div></div> <!> <!> <!> <!> <!>',1),Sr=d('<div class="flex h-32 items-center justify-center"><div class="border-primary-500 h-8 w-8 animate-spin rounded-full border-b-2"></div></div>'),Tr=(u,l)=>l.loadStats(),Cr=d('<div class="flex h-full flex-col"><div class="border-surface-300 dark:border-surface-700 border-b p-4"><div class="flex items-center gap-2"><!> <h2 class="text-lg font-semibold">Statistics</h2></div></div> <div class="flex-1 space-y-4 overflow-auto p-4"><!></div> <div class="border-surface-300 dark:border-surface-700 border-t p-4"><button class="bg-primary-500 hover:bg-primary-600 w-full rounded-md px-3 py-2 text-sm text-white transition-colors">Refresh Stats</button></div></div>');function Mr(u,l){at(l,!0);const i=st();function s(P){if(P===0)return"0 B";const N=1024,j=["B","KB","MB","GB"],de=Math.floor(Math.log(P)/Math.log(N));return parseFloat((P/Math.pow(N,de)).toFixed(0))+" "+j[de]}function w(P){return new Date(P).toLocaleString()}const b=I(()=>i.stats),v=I(()=>t(b)?.total_pals||0),g=I(()=>t(b)?.total_collections||0),x=I(()=>t(b)?.total_tags||0),ne=I(()=>t(b)?.total_transfers||0),Y=I(()=>t(b)?.total_clones||0),W=I(()=>t(b)?.storage_size_mb||0),ke=I(()=>t(b)?.last_updated),fe=I(()=>{if(!t(b)?.element_distribution)return console.warn("No element distribution data available",t(b)),{};try{return JSON.parse(t(b).element_distribution)}catch{return{}}}),oe=I(()=>({alpha:t(b)?.alpha_count||0,lucky:t(b)?.lucky_count||0,human:t(b)?.human_count||0,predator:t(b)?.predator_count||0,oilrig:t(b)?.oilrig_count||0,summon:t(b)?.summon_count||0})),ce=I(()=>Object.keys(ct.elements)),_e=I(()=>{let P={};for(const N of t(ce)){const j=ct.elements[N];j&&(P[N]=ta.loadImage(`${aa}/img/${j.icon}.webp`))}return P});var $=Cr(),q=a($),D=a(q),Me=a(D);la(Me,{class:"text-primary-500 h-5 w-5"}),vt(2),e(D),e(q);var ie=r(q,2),Ne=a(ie);{var ee=P=>{var N=Pr(),j=he(N),de=a(j),te=a(de),J=r(a(te),2);sa(J,{class:"text-surface-400 h-4 w-4"}),e(te);var p=r(te,2),L=a(p,!0);e(p),e(de);var R=r(de,2),U=a(R),O=r(a(U),2);Na(O,{class:"text-surface-400 h-4 w-4"}),e(U);var H=r(U,2),G=a(H,!0);e(H),e(R);var ve=r(R,2),f=r(a(ve),2),M=a(f,!0);e(f),e(ve);var B=r(ve,2),Ae=r(a(B),2),Te=a(Ae,!0);e(Ae),e(B),e(j);var be=r(j,2),Pe=r(a(be),2),X=a(Pe),xe=r(a(X),2),Ue=a(xe,!0);e(xe),e(X);var je=r(X,2),Q=r(a(je),2),tt=a(Q,!0);e(Q),e(je),e(Pe),e(be);var lt=r(be,2);{var dt=ae=>{var se=hr(),ge=r(a(se),2),ye=a(ge),we=r(a(ye),2),Ke=a(we,!0);e(we),e(ye),e(ge),e(se),C(()=>m(Ke,t(b).most_popular_character_id)),n(ae,se)};y(lt,ae=>{t(b).most_popular_character_id&&ae(dt)})}var ot=r(lt,2);{var ft=ae=>{var se=xr(),ge=r(a(se),2),ye=a(ge),we=r(a(ye),2),Ke=a(we,!0);e(we),e(ye);var Ve=r(ye,2),We=r(a(Ve),2),o=a(We,!0);e(We),e(Ve);var c=r(Ve,2);{var h=_=>{var k=br(),F=r(a(k),2),A=a(F,!0);e(F),e(k),C(E=>m(A,E),[()=>(t(v)/t(g)).toFixed(1)]),n(_,k)};y(c,_=>{t(g)>0&&_(h)})}e(ge),e(se),C((_,k)=>{m(Ke,_),m(o,k)},[()=>(t(ne)/t(v)).toFixed(1),()=>(t(Y)/t(v)).toFixed(1)]),n(ae,se)};y(ot,ae=>{t(v)>0&&ae(ft)})}var _t=r(ot,2);{var gt=ae=>{var se=wr(),ge=r(a(se),2);Ge(ge,21,()=>t(ce),nt,(ye,we)=>{const Ke=I(()=>t(fe)[t(we)]||0),Ve=I(()=>ct.getByKey(t(we))),We=I(()=>t(Ve)?.localized_name||t(we));var o=yr(),c=a(o),h=r(c,2),_=a(h),k=a(_,!0);e(_),e(h);var F=r(h,2),A=a(F,!0);e(F),e(o),C(()=>{ze(c,"src",t(_e)[t(we)]),ze(c,"alt",t(we)),m(k,t(We)),m(A,t(Ke))}),n(ye,o)}),e(ge),e(se),n(ae,se)};y(_t,ae=>{Object.keys(t(fe)).length>0&&ae(gt)})}var mt=r(_t,2);{var Pt=ae=>{var se=kr(),ge=r(a(se),2),ye=a(ge),we=a(ye),Ke=r(we,4),Ve=a(Ke,!0);e(Ke),e(ye);var We=r(ye,2),o=a(We),c=r(o,4),h=a(c,!0);e(c),e(We);var _=r(We,2),k=a(_);Lt(k,{class:"mr-2 h-5 w-5"});var F=r(k,4),A=a(F,!0);e(F),e(_);var E=r(_,2),z=a(E),me=r(z,4),ue=a(me,!0);e(me),e(E);var pe=r(E,2),Oe=a(pe),Le=r(Oe,4),Be=a(Le,!0);e(Le),e(pe);var re=r(pe,2),Se=a(re),Ce=r(Se,4),Re=a(Ce,!0);e(Ce),e(re),e(ge),e(se),C(()=>{ze(we,"src",Xe.alphaIcon),m(Ve,t(oe).alpha),ze(o,"src",Xe.luckyIcon),m(h,t(oe).lucky),m(A,t(oe).human),ze(z,"src",Xe.predatorIcon),m(ue,t(oe).predator),ze(Oe,"src",Xe.oilrigIcon),m(Be,t(oe).oilrig),ze(Se,"src",Xe.altarIcon),m(Re,t(oe).summon)}),n(ae,se)};y(mt,ae=>{t(v)>0&&ae(Pt)})}var St=r(mt,2);{var Tt=ae=>{var se=$r(),ge=a(se),ye=a(ge);Ia(ye,{class:"h-3 w-3"});var we=r(ye,2),Ke=a(we);e(we),e(ge),e(se),C(Ve=>m(Ke,`Last updated: ${Ve??""}`),[()=>w(t(ke))]),n(ae,se)};y(St,ae=>{t(ke)&&ae(Tt)})}C((ae,se,ge,ye)=>{m(L,ae),m(G,t(g)),m(M,t(x)),m(Te,se),m(Ue,ge),m(tt,ye)},[()=>t(v).toLocaleString(),()=>s(t(W)*1024*1024),()=>t(ne).toLocaleString(),()=>t(Y).toLocaleString()]),n(P,N)},$e=P=>{var N=Sr();n(P,N)};y(Ne,P=>{t(b)?P(ee):P($e,!1)})}e(ie);var Fe=r(ie,2),T=a(Fe);T.__click=[Tr,i],e(Fe),e($),n(u,$),rt()}pt(["click"]);var Ar=d('<span class="text-surface-500 dark:text-surface-400 truncate text-sm"> </span>'),Lr=d('<span class="bg-primary-100 text-primary-800 dark:bg-primary-900/30 dark:text-primary-300 inline-flex items-center rounded px-2 py-0.5 text-xs font-medium"> </span>'),Ir=d('<span class="text-surface-500 text-xs"> </span>'),Fr=d('<div class="mb-2 flex flex-wrap gap-1"><!> <!></div>'),Er=d('<p class="text-surface-600 dark:text-surface-400 mb-1 line-clamp-2 text-sm svelte-1t45kdx"> </p>'),zr=d('‚Ä¢ Player: <span class="font-medium"> </span>',1),Dr=d('‚Ä¢ From: <span class="font-medium uppercase"> </span>',1),Nr=d('<div>Source: <span class="font-medium"> </span> <!> <!></div>'),Ur=d('‚Ä¢ Modified: <span class="font-medium"> </span>',1),jr=d('<div title="Transfer count"> </div>'),Br=d('<div title="Clone count"> </div>'),Kr=d('<div title="Last accessed"> </div>'),Or=d('<div><div class="flex-shrink-0"><div class="h-16 w-16"><!></div></div> <div class="min-w-0 flex-1"><div class="mb-1 flex items-center gap-2"><h3 class="text-surface-900 dark:text-surface-100 truncate text-base font-medium"> </h3> <!> <span class="text-surface-600 dark:text-surface-300 text-sm"> </span></div> <!> <!> <div class="text-surface-500 dark:text-surface-400 space-y-1 text-xs"><!> <div>Added: <span class="font-medium"> </span> <!></div></div></div> <div class="flex-shrink-0 text-right"><div class="text-surface-500 dark:text-surface-400 space-y-1 text-xs"><!> <!> <!></div></div></div>'),Vr=d('<div class="space-y-2 p-4"></div>');function Rr(u,l){at(l,!1);const i=st();function s(g,x){(x.ctrlKey||x.metaKey)&&i.togglePalSelection(g.id)}function w(g){return i.selectedPals.has(g)}function b(g){return new Date(g).toLocaleString()}Qt();var v=Vr();Ge(v,5,()=>i.pals,g=>g.id,(g,x)=>{var ne=Or(),Y=a(ne),W=a(Y),ke=a(W);oa(ke,{get upsPal(){return t(x)},onSelect:s}),e(W),e(Y);var fe=r(Y,2),oe=a(fe),ce=a(oe),_e=a(ce,!0);e(ce);var $=r(ce,2);{var q=f=>{var M=Ar(),B=a(M);e(M),C(()=>m(B,`(${t(x).character_id??""})`)),n(f,M)};y($,f=>{t(x).nickname&&t(x).nickname!==t(x).character_id&&f(q)})}var D=r($,2),Me=a(D);e(D),e(oe);var ie=r(oe,2);{var Ne=f=>{var M=Fr(),B=a(M);Ge(B,1,()=>t(x).tags.slice(0,3),nt,(be,Pe)=>{var X=Lr(),xe=a(X,!0);e(X),C(()=>m(xe,t(Pe))),n(be,X)});var Ae=r(B,2);{var Te=be=>{var Pe=Ir(),X=a(Pe);e(Pe),C(()=>m(X,`+${t(x).tags.length-3} more`)),n(be,Pe)};y(Ae,be=>{t(x).tags.length>3&&be(Te)})}e(M),n(f,M)};y(ie,f=>{t(x).tags&&t(x).tags.length>0&&f(Ne)})}var ee=r(ie,2);{var $e=f=>{var M=Er(),B=a(M,!0);e(M),C(()=>m(B,t(x).notes)),n(f,M)};y(ee,f=>{t(x).notes&&f($e)})}var Fe=r(ee,2),T=a(Fe);{var P=f=>{var M=Nr(),B=r(a(M)),Ae=a(B,!0);e(B);var Te=r(B,2);{var be=xe=>{var Ue=zr(),je=r(he(Ue)),Q=a(je,!0);e(je),C(()=>m(Q,t(x).source_player_name)),n(xe,Ue)};y(Te,xe=>{t(x).source_player_name&&xe(be)})}var Pe=r(Te,2);{var X=xe=>{var Ue=Dr(),je=r(he(Ue)),Q=a(je,!0);e(je),C(()=>m(Q,t(x).source_storage_type)),n(xe,Ue)};y(Pe,xe=>{t(x).source_storage_type&&xe(X)})}e(M),C(()=>m(Ae,t(x).source_save_file)),n(f,M)};y(T,f=>{t(x).source_save_file&&f(P)})}var N=r(T,2),j=r(a(N)),de=a(j,!0);e(j);var te=r(j,2);{var J=f=>{var M=Ur(),B=r(he(M)),Ae=a(B,!0);e(B),C(Te=>m(Ae,Te),[()=>b(t(x).updated_at)]),n(f,M)};y(te,f=>{t(x).updated_at!==t(x).created_at&&f(J)})}e(N),e(Fe),e(fe);var p=r(fe,2),L=a(p),R=a(L);{var U=f=>{var M=jr(),B=a(M);e(M),C(()=>m(B,`üì§ ${t(x).transfer_count??""}`)),n(f,M)};y(R,f=>{t(x).transfer_count>0&&f(U)})}var O=r(R,2);{var H=f=>{var M=Br(),B=a(M);e(M),C(()=>m(B,`üîÑ ${t(x).clone_count??""}`)),n(f,M)};y(O,f=>{t(x).clone_count>0&&f(H)})}var G=r(O,2);{var ve=f=>{var M=Kr(),B=a(M);e(M),C(Ae=>m(B,`üëÅÔ∏è ${Ae??""}`),[()=>new Date(t(x).last_accessed_at).toLocaleDateString()]),n(f,M)};y(G,f=>{t(x).last_accessed_at&&f(ve)})}e(L),e(p),e(ne),C((f,M)=>{Ee(ne,1,`border-surface-300 dark:border-surface-700 hover:border-primary-500 dark:hover:border-primary-400 flex cursor-pointer items-center gap-4 rounded-lg border p-3 transition-colors ${f??""}`),m(_e,t(x).nickname||t(x).character_id),m(Me,`Lv. ${t(x).level??""}`),m(de,M)},[()=>w(t(x).id)?"bg-primary-50 dark:bg-primary-900/20 border-primary-500 ring-secondary-500 ring-4":"dark:bg-surface-800 bg-white",()=>b(t(x).created_at)]),n(g,ne)}),e(v),n(u,v),rt()}function Gr(u,l,i){ut(l,""),i.clearFilters(),i.loadPals(!0)}function Wr(u,l){l.updateElementTypesFilter([]),l.loadPals(!0)}function Hr(u,l){l.updatePalTypesFilter([]),l.loadPals(!0)}function Xr(u,l){l.selectAllPals()}async function Gt(u,l){await l.selectAllFilteredPals()}function Zr(u,l){l.clearSelection()}async function qr(u,l,i,s){try{if(!await l.showModal($a,{totalPals:i.pagination.totalCount}))return;const b=await i.nukeAllPals();b.success?b.deletedCount>0?s.add(`Successfully deleted ${b.deletedCount.toLocaleString()} pals from UPS`,"Success","success"):s.add("UPS was already empty","Info","info"):s.add("Failed to nuke UPS. Please try again.","Error","error")}catch(w){console.error("Error during nuke operation:",w),s.add("An error occurred during the nuke operation. Please try again.","Error","error")}}var Jr=d('<div class="bg-surface-300 dark:bg-surface-700 h-6 w-px"></div>'),Qr=d('<div class="border-surface-300 dark:border-surface-700 bg-surface-50 dark:bg-surface-900 w-80 border-r"><!> <!> <!></div>'),Yr=d('<button class="text-error-500 hover:bg-error-500/20 hover:text-error-600 h-8 w-8 rounded-md p-2 transition-colors"><!></button>'),es=d("<!> <!> <!> <!>",1),ts=d('<span class="bg-primary-500 rounded-full px-2 py-0.5 text-xs text-white">Active</span>'),as=d('<div class="flex items-center gap-2"><!> <span>Filters & Sorting</span> <!></div>'),rs=d('<button class="text-primary-600 hover:text-primary-700 text-xs"> </button>'),ss=(u,l,i)=>l(t(i)),ls=d('<button><img class="h-6 w-6"/></button>'),os=d('<button class="text-primary-600 hover:text-primary-700 text-xs"> </button>'),is=(u,l)=>l("alpha"),ns=d('<button><img alt="Alpha" class="h-6 w-6"/></button>'),cs=(u,l)=>l("lucky"),ds=d('<button><img alt="Lucky" class="h-6 w-6"/></button>'),vs=(u,l)=>l("human"),us=d("<button><!></button>"),ps=(u,l)=>l("predator"),fs=d('<button><img alt="Predator" class="h-6 w-6"/></button>'),_s=(u,l)=>l("oilrig"),gs=d('<button><img alt="Oil Rig" class="h-6 w-6"/></button>'),ms=(u,l)=>l("summon"),hs=d('<button><img alt="Summoned" class="h-6 w-6"/></button>'),bs=(u,l,i)=>l(i.key),xs=d("<button> <!></button>"),ys=d('<div class="border-surface-300 dark:border-surface-700 col-span-2 border-t pt-2"><button class="text-primary-600 hover:text-primary-700 flex items-center gap-1 text-sm"><!> Clear All Filters</button></div>'),ws=d('<div class="grid grid-cols-2 gap-4 p-4"><div class="space-y-4"><span class="block text-sm font-medium">Elements & Types</span> <div class="space-y-3"><div><div class="mb-1 flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-xs font-medium">Element Types</span> <!></div> <div class="grid grid-cols-6 gap-1"></div></div> <div><div class="mb-1 flex items-center justify-between"><span class="text-surface-600 dark:text-surface-400 text-xs font-medium">Pal Types</span> <!></div> <div class="grid grid-cols-6 gap-1"><!> <!> <!> <!> <!> <!></div></div></div></div> <div><span class="mb-2 block text-sm font-medium">Sort By</span> <div class="flex flex-wrap gap-2"></div></div> <!></div>'),ks=d('<button type="button" class="btn hover:preset-tonal px-2 text-xs">Page</button>'),$s=d('<button type="button" class="btn hover:preset-tonal px-2 text-xs">Filtered</button>'),Ps=d('<button type="button" class="btn hover:preset-tonal px-2 text-xs">All UPS</button>'),Ss=d('<span class="text-surface-400">‚Ä¢</span> <button class="text-primary-600 hover:text-primary-700">Clear Selection</button>',1),Ts=d('<div class="bg-surface-100 dark:bg-surface-800 flex items-center justify-between px-4 text-sm"><div class="flex items-center gap-4"><span> </span> <div class="flex items-center"><nav class="btn-group flex-row p-0"><!> <!></nav> <!></div></div> <div class="text-surface-600 dark:text-surface-400"> </div></div>'),Cs=d('<div class="flex h-32 items-center justify-center"><div class="border-primary-500 h-8 w-8 animate-spin rounded-full border-b-2"></div></div>'),Ms=d('<button class="flex items-center gap-2 rounded-md bg-blue-500 px-4 py-2 text-white hover:bg-blue-600"><!> Import from Save</button>'),As=d('<div class="flex h-64 flex-col items-center justify-center text-center"><!> <h3 class="text-surface-600 dark:text-surface-400 mb-2 text-lg font-medium">No Pals in Storage</h3> <p class="text-surface-500 mb-4 max-w-md">Create new Pals or import them from your save files to get started.</p> <div class="flex gap-3"><button class="flex items-center gap-2 rounded-md bg-green-500 px-4 py-2 text-white hover:bg-green-600"><!> Add New Pal</button> <!></div></div>'),Ls=(u,l)=>l(1),Is=(u,l,i)=>l(t(i)-1),Fs=(u,l,i)=>l(t(i)),Es=d("<button> </button>"),zs=(u,l,i)=>l(t(i)+1),Ds=(u,l,i)=>l(t(i)),Ns=d('<div class="border-surface-300 dark:border-surface-700 border-t p-4"><div class="flex items-center justify-between"><div class="text-surface-600 dark:text-surface-400 text-sm"> </div> <div class="flex items-center gap-1"><button class="hover:bg-surface-200 dark:hover:bg-surface-800 rounded p-2 disabled:cursor-not-allowed disabled:opacity-50"><!></button> <button class="hover:bg-surface-200 dark:hover:bg-surface-800 rounded p-2 disabled:cursor-not-allowed disabled:opacity-50"><!></button> <!> <button class="hover:bg-surface-200 dark:hover:bg-surface-800 rounded p-2 disabled:cursor-not-allowed disabled:opacity-50"><!></button> <button class="hover:bg-surface-200 dark:hover:bg-surface-800 rounded p-2 disabled:cursor-not-allowed disabled:opacity-50"><!></button></div></div></div>'),Us=d('<div class="ups-container flex h-full flex-col svelte-16lfksc"><div class="border-surface-300 dark:border-surface-700 flex items-center justify-between border-b p-4"><div class="flex items-center gap-3"><div class="bg-primary-500 flex h-8 w-8 items-center justify-center rounded-lg"><!></div> <div><h1 class="text-xl font-semibold">Universal Pal Storage</h1> <p class="text-surface-600 dark:text-surface-400 text-sm"> </p></div></div> <div class="flex items-center gap-2"><!> <!> <!> <!> <!> <!> <div class="bg-surface-300 dark:bg-surface-700 h-6 w-px"></div> <!> <!></div></div> <div class="flex flex-1 overflow-hidden"><!> <div class="flex flex-1 flex-col"><div class="border-surface-700 space-y-3 border-b p-4"><div class="flex items-center gap-2"><div class="relative flex-1"><!> <!></div> <!> <!></div> <!></div> <!> <div class="flex-1 overflow-auto"><!></div> <!></div></div></div>');function Hs(u,l){at(l,!0);const i=16,s=st(),w=$t(),b=Ht(),v=Zt();let g=It(""),x;function ne(){x&&clearTimeout(x),x=setTimeout(()=>{s.updateSearch(t(g)),s.loadPals(!0)},300)}const Y=I(()=>s.pagination.totalPages),W=I(()=>s.pagination.page),ke=I(()=>Math.max(1,Math.min(t(W)-Math.floor(i/2),t(Y)-i+1))),fe=I(()=>Math.min(t(ke)+i-1,t(Y))),oe=I(()=>Array.from({length:t(fe)-t(ke)+1},(o,c)=>t(ke)+c)),ce=I(()=>Object.keys(ct.elements)),_e=I(()=>{let o={};for(const c of t(ce)){const h=ct.elements[c];h&&(o[c]=ta.loadImage(`${aa}/img/${h.icon}.webp`))}return o});function $(o){const c=s.filters.sortBy===o&&s.filters.sortOrder==="asc"?"desc":"asc";s.updateSort(o,c),s.loadPals(!0)}function q(o){return s.filters.sortBy!==o?Ma:s.filters.sortOrder==="asc"?Ot:Vt}function D(o){o>=1&&o<=t(Y)&&(s.setPage(o),s.loadPals())}function Me(o){const c=[...s.filters.elementTypes];if(c.includes(o)){const h=c.filter(_=>_!==o);s.updateElementTypesFilter(h)}else c.push(o),s.updateElementTypesFilter(c);s.loadPals(!0)}function ie(o){const c=[...s.filters.palTypes];if(c.includes(o)){const h=c.filter(_=>_!==o);s.updatePalTypesFilter(h)}else c.push(o),s.updatePalTypesFilter(c);s.loadPals(!0)}function Ne(o){return Ze("btn",s.filters.elementTypes.includes(o)?"bg-secondary-500/25":"")}function ee(o){return Ze("btn",s.filters.palTypes.includes(o)?"bg-secondary-500/25":"")}function $e(){return!!s.filters.search||!!s.filters.collectionId||s.filters.tags.length>0||s.filters.elementTypes.length>0||s.filters.palTypes.length>0}async function Fe(){if(s.selectedPals.size===0)return;await w.showConfirmModal({title:"Delete Selected Pals",message:`Are you sure you want to delete ${s.selectedPals.size} selected pal${s.selectedPals.size>1?"s":""}? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel"})&&await s.deleteSelectedPals()}async function T(){if(!b.saveFile){v.add("No save file loaded","Error","error");return}const o=await w.showModal(ka,{title:"Save File ü°Ü UPS",message:"Select the source and options for importing Pals to UPS."});if(o)for(const c of o){const{sourceType:h,sourceSlot:_,collectionId:k,tags:F,notes:A,palId:E,playerId:z}=c;try{await s.importFromSave(h,E,_,z,k,F.length>0?F:void 0,A||void 0),await s.loadAll()}catch(me){console.error("Import failed:",me),v.add("Import failed. Please try again.","Error","error")}}}async function P(){if(s.selectedPals.size===0)return;const o=Array.from(s.selectedPals),c=s.pals.filter(_=>o.includes(_.id)),h=await w.showModal(Jt,{title:`Edit Tags for ${c.length} Pals`,pals:c});if(h){for(const _ of o)await s.updatePal(_,{tags:h});await s.loadPals(),v.add(`Updated tags for ${o.length} pals`,"Success","success")}}async function N(){if(s.selectedPals.size===0)return;const o=Array.from(s.selectedPals),c=s.pals.filter(_=>o.includes(_.id)),h=await w.showModal(qt,{title:`Manage Collection for ${c.length} Pals`,pals:c});if(h){const _=h.removeFromCollection?void 0:h.collectionId;for(const k of o)await s.updatePal(k,{collection_id:_});await s.loadAll(),h.removeFromCollection?v.add(`Removed ${o.length} pals from collections`,"Success","success"):v.add(`Moved ${o.length} pals to collection`,"Success","success")}}async function j(){if(s.selectedPals.size===0)return;const o=Array.from(s.selectedPals),c=s.pals.filter(_=>o.includes(_.id)),h=await w.showModal(Xt,{title:`Export ${c.length} Pals`,pals:c});if(h){let _=0;const k=[];for(const F of o){const A=h.target;try{await s.exportPal(F,A,h.playerId),_++}catch(E){console.error(`Failed to export pal ${F}:`,E),k.push(`Pal ${F}: ${E}`)}}_>0&&v.add(`Successfully exported ${_} of ${o.length} pals`,"Success","success"),k.length>0&&(console.error("Export errors:",k),v.add(`Failed to export ${k.length} pals`,"Warning","warning"))}}async function de(){const o=await w.showModal(ba,{title:"Add a new Pal to UPS"});if(!o)return;const[c,h]=o,_=xa.getByKey(c);if(!_){v.add("Failed to get pal data","Error","error");return}try{let k=c.toLowerCase();k.startsWith("boss_")?k=k.slice(5):k.startsWith("predator_")?k=k.slice(9):k.endsWith("_avatar")&&(k=k.slice(0,-7));const F={instance_id:"00000000-0000-0000-0000-000000000000",character_id:c,character_key:k,nickname:h||_.localized_name,name:_.localized_name,level:1,exp:0,rank:1,rank_hp:0,rank_attack:0,rank_defense:0,rank_craftspeed:0,talent_hp:50,talent_shot:50,talent_defense:50,hp:100,max_hp:100,sanity:100,stomach:100,is_lucky:!1,is_boss:!1,is_predator:!1,is_tower:!1,is_sick:!1,gender:wa.MALE,friendship_point:0,owner_uid:"",storage_id:"00000000-0000-0000-0000-000000000000",storage_slot:0,group_id:null,learned_skills:[],active_skills:[],passive_skills:[],work_suitability:{},elements:_.element_types||[],state:ya.MODIFIED,__ups_source:!0,__ups_new:!0};b.addNewUpspal(F)}catch(k){console.error("Failed to create new pal:",k),v.add("Failed to create new pal. Please try again.","Error","error")}}va(()=>{ut(g,s.filters.search,!0)});var te=Us(),J=a(te),p=a(J),L=a(p),R=a(L);sa(R,{class:"h-5 w-5 text-white"}),e(L);var U=r(L,2),O=r(a(U),2),H=a(O);e(O),e(U),e(p);var G=r(p,2),ve=a(G);K(ve,{onclick:de,class:"rounded-md bg-green-500 p-2 text-white hover:bg-green-600",popupLabel:"Add New Pal",children:(o,c)=>{yt(o,{class:"h-4 w-4"})},$$slots:{default:!0}});var f=r(ve,2);{var M=o=>{K(o,{onclick:T,class:"rounded-md bg-blue-500 p-2 text-white hover:bg-blue-600",popupLabel:"Import from Save",children:(c,h)=>{xt(c,{class:"h-4 w-4"})},$$slots:{default:!0}})};y(f,o=>{b.saveFile&&o(M)})}var B=r(f,2);{var Ae=o=>{var c=Jr();n(o,c)};y(B,o=>{(s.pagination.totalCount>0||b.saveFile)&&o(Ae)})}var Te=r(B,2);{let o=I(()=>Ze("rounded-md p-2",s.showCollectionsPanel?"bg-primary-500 text-white":"hover:bg-surface-200 dark:hover:bg-surface-800"));K(Te,{onclick:()=>s.toggleCollectionsPanel(),get class(){return t(o)},popupLabel:"Toggle Collections",children:(c,h)=>{wt(c,{class:"h-4 w-4"})},$$slots:{default:!0}})}var be=r(Te,2);{let o=I(()=>Ze("rounded-md p-2",s.showTagsPanel?"bg-primary-500 text-white":"hover:bg-surface-200 dark:hover:bg-surface-800"));K(be,{onclick:()=>s.toggleTagsPanel(),get class(){return t(o)},popupLabel:"Toggle Tags",children:(c,h)=>{it(c,{class:"h-4 w-4"})},$$slots:{default:!0}})}var Pe=r(be,2);{let o=I(()=>Ze("rounded-md p-2",s.showStatsPanel?"bg-primary-500 text-white":"hover:bg-surface-200 dark:hover:bg-surface-800"));K(Pe,{onclick:()=>s.toggleStatsPanel(),get class(){return t(o)},popupLabel:"Toggle Statistics",children:(c,h)=>{la(c,{class:"h-4 w-4"})},$$slots:{default:!0}})}var X=r(Pe,4);{let o=I(()=>Ze("rounded-md p-2",s.viewMode==="grid"?"bg-primary-500 text-white":"hover:bg-surface-200 dark:hover:bg-surface-800"));K(X,{onclick:()=>s.setViewMode("grid"),get class(){return t(o)},popupLabel:"Grid View",children:(c,h)=>{za(c,{class:"h-4 w-4"})},$$slots:{default:!0}})}var xe=r(X,2);{let o=I(()=>Ze("rounded-md p-2",s.viewMode==="list"?"bg-primary-500 text-white":"hover:bg-surface-200 dark:hover:bg-surface-800"));K(xe,{onclick:()=>s.setViewMode("list"),get class(){return t(o)},popupLabel:"List View",children:(c,h)=>{Da(c,{class:"h-4 w-4"})},$$slots:{default:!0}})}e(G),e(J);var Ue=r(J,2),je=a(Ue);{var Q=o=>{var c=Qr(),h=a(c);{var _=z=>{lr(z,{})};y(h,z=>{s.showCollectionsPanel&&z(_)})}var k=r(h,2);{var F=z=>{mr(z,{})};y(k,z=>{s.showTagsPanel&&z(F)})}var A=r(k,2);{var E=z=>{Mr(z,{})};y(A,z=>{s.showStatsPanel&&z(E)})}e(c),n(o,c)};y(je,o=>{(s.showCollectionsPanel||s.showTagsPanel||s.showStatsPanel)&&o(Q)})}var tt=r(je,2),lt=a(tt),dt=a(lt),ot=a(dt),ft=a(ot);Sa(ft,{class:"text-surface-500 absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 focus:border-none"});var _t=r(ft,2);ha(_t,{oninput:ne,placeholder:"Search pals by name, character ID, or notes...",inputClass:"pl-10",get value(){return t(g)},set value(o){ut(g,o,!0)}}),e(ot);var gt=r(ot,2);{var mt=o=>{K(o,{popupLabel:"Nuke UPS - Delete ALL pals",children:(c,h)=>{var _=Yr();_.__click=[qr,w,s,v];var k=a(_);Aa(k,{size:16}),e(_),C(()=>_.disabled=s.loading),n(c,_)},$$slots:{default:!0}})};y(gt,o=>{s.pagination.totalCount>0&&o(mt)})}var Pt=r(gt,2);{var St=o=>{var c=es(),h=he(c);K(h,{onclick:P,class:"rounded-md bg-blue-500 p-2 text-white hover:bg-blue-600",popupLabel:"Edit Tags",children:(A,E)=>{it(A,{class:"h-4 w-4"})},$$slots:{default:!0}});var _=r(h,2);K(_,{onclick:N,class:"rounded-md bg-green-500 p-2 text-white hover:bg-green-600",popupLabel:"Add to Collection",children:(A,E)=>{wt(A,{class:"h-4 w-4"})},$$slots:{default:!0}});var k=r(_,2);K(k,{onclick:j,class:"rounded-md bg-purple-500 p-2 text-white hover:bg-purple-600",popupLabel:"Export Selected",children:(A,E)=>{xt(A,{class:"h-4 w-4"})},$$slots:{default:!0}});var F=r(k,2);K(F,{onclick:Fe,class:"rounded-md bg-red-500 p-2 text-white hover:bg-red-600",popupLabel:"Delete Selected",children:(A,E)=>{Wt(A,{class:"h-4 w-4"})},$$slots:{default:!0}}),n(o,c)};y(Pt,o=>{s.hasSelectedPals&&o(St)})}e(dt);var Tt=r(dt,2);Kt(Tt,{base:"w-full",collapsible:!0,children:(o,c)=>{var h=De(),_=he(h);{const k=A=>{var E=as(),z=a(E);Fa(z,{class:"h-4 w-4"});var me=r(z,4);{var ue=pe=>{var Oe=ts();n(pe,Oe)};y(me,pe=>{(s.filters.search||s.filters.collectionId||s.filters.tags.length>0||s.filters.elementTypes.length>0||s.filters.palTypes.length>0)&&pe(ue)})}e(E),n(A,E)},F=A=>{var E=ws(),z=a(E),me=r(a(z),2),ue=a(me),pe=a(ue),Oe=r(a(pe),2);{var Le=Z=>{var V=rs();V.__click=[Wr,s];var S=a(V);e(V),C(()=>m(S,`Clear (${s.filters.elementTypes.length??""})`)),n(Z,V)};y(Oe,Z=>{s.filters.elementTypes.length>0&&Z(Le)})}e(pe);var Be=r(pe,2);Ge(Be,21,()=>t(ce),nt,(Z,V)=>{const S=I(()=>ct.getByKey(t(V))),le=I(()=>t(S)?.localized_name||t(V));K(Z,{get popupLabel(){return t(le)},children:(Ie,jt)=>{var He=ls();He.__click=[ss,Me,V];var bt=a(He);e(He),C(da=>{Ee(He,1,da,"svelte-16lfksc"),ze(He,"aria-label",t(le)),ze(bt,"src",t(_e)[t(V)]),ze(bt,"alt",t(le))},[()=>qe(Ne(t(V)))]),n(Ie,He)},$$slots:{default:!0}})}),e(Be),e(ue);var re=r(ue,2),Se=a(re),Ce=r(a(Se),2);{var Re=Z=>{var V=os();V.__click=[Hr,s];var S=a(V);e(V),C(()=>m(S,`Clear (${s.filters.palTypes.length??""})`)),n(Z,V)};y(Ce,Z=>{s.filters.palTypes.length>0&&Z(Re)})}e(Se);var ht=r(Se,2),Ft=a(ht);K(Ft,{popupLabel:"Alpha Pals",children:(Z,V)=>{var S=ns();S.__click=[is,ie];var le=a(S);e(S),C(Ie=>{Ee(S,1,Ie,"svelte-16lfksc"),ze(le,"src",Xe.alphaIcon)},[()=>qe(ee("alpha"))]),n(Z,S)},$$slots:{default:!0}});var Et=r(Ft,2);K(Et,{popupLabel:"Lucky Pals",children:(Z,V)=>{var S=ds();S.__click=[cs,ie];var le=a(S);e(S),C(Ie=>{Ee(S,1,Ie,"svelte-16lfksc"),ze(le,"src",Xe.luckyIcon)},[()=>qe(ee("lucky"))]),n(Z,S)},$$slots:{default:!0}});var zt=r(Et,2);K(zt,{popupLabel:"Humans",children:(Z,V)=>{var S=us();S.__click=[vs,ie];var le=a(S);Lt(le,{class:"h-6 w-6"}),e(S),C(Ie=>Ee(S,1,Ie,"svelte-16lfksc"),[()=>qe(ee("human"))]),n(Z,S)},$$slots:{default:!0}});var Dt=r(zt,2);K(Dt,{popupLabel:"Predator Pals",children:(Z,V)=>{var S=fs();S.__click=[ps,ie];var le=a(S);e(S),C(Ie=>{Ee(S,1,Ie,"svelte-16lfksc"),ze(le,"src",Xe.predatorIcon)},[()=>qe(ee("predator"))]),n(Z,S)},$$slots:{default:!0}});var Nt=r(Dt,2);K(Nt,{popupLabel:"Oil Rig Pals",children:(Z,V)=>{var S=gs();S.__click=[_s,ie];var le=a(S);e(S),C(Ie=>{Ee(S,1,Ie,"svelte-16lfksc"),ze(le,"src",Xe.oilrigIcon)},[()=>qe(ee("oilrig"))]),n(Z,S)},$$slots:{default:!0}});var ia=r(Nt,2);K(ia,{popupLabel:"Summoned Pals",children:(Z,V)=>{var S=hs();S.__click=[ms,ie];var le=a(S);e(S),C(Ie=>{Ee(S,1,Ie,"svelte-16lfksc"),ze(le,"src",Xe.altarIcon)},[()=>qe(ee("summon"))]),n(Z,S)},$$slots:{default:!0}}),e(ht),e(re),e(me),e(z);var Ct=r(z,2),Ut=r(a(Ct),2);Ge(Ut,20,()=>[{key:"created_at",label:"Created"},{key:"updated_at",label:"Modified"},{key:"character_id",label:"Character"},{key:"nickname",label:"Name"},{key:"level",label:"Level"},{key:"transfer_count",label:"Transfers"},{key:"clone_count",label:"Clones"}],nt,(Z,V)=>{const S=I(()=>q(V.key));var le=xs();le.__click=[bs,$,V];var Ie=a(le),jt=r(Ie);Bt(jt,()=>t(S),(He,bt)=>{bt(He,{class:"h-3 w-3"})}),e(le),C(He=>{Ee(le,1,He,"svelte-16lfksc"),m(Ie,`${V.label??""} `)},[()=>qe(Ze("flex items-center gap-1 rounded-md border px-3 py-1 text-sm",s.filters.sortBy===V.key?"bg-primary-500 border-primary-500 text-white":"dark:bg-surface-800 border-surface-300 dark:border-surface-700 bg-white"))]),n(Z,le)}),e(Ut),e(Ct);var na=r(Ct,2);{var ca=Z=>{var V=ys(),S=a(V);S.__click=[Gr,g,s];var le=a(S);ea(le,{class:"h-3 w-3"}),vt(),e(S),e(V),n(Z,V)};y(na,Z=>{(s.filters.search||s.filters.collectionId||s.filters.tags.length>0||s.filters.elementTypes.length>0||s.filters.palTypes.length>0)&&Z(ca)})}e(E),n(A,E)};Bt(_,()=>Kt.Item,(A,E)=>{E(A,{value:"filters",control:k,panel:F,$$slots:{control:!0,panel:!0}})})}n(o,h)},$$slots:{default:!0}}),e(lt);var ae=r(lt,2);{var se=o=>{var c=Ts(),h=a(c),_=a(h),k=a(_);e(_);var F=r(_,2),A=a(F),E=a(A);K(E,{get popupLabel(){return`Select all pals on current page (${s.pals.length??""})`},children:(re,Se)=>{var Ce=ks();Ce.__click=[Xr,s],n(re,Ce)},$$slots:{default:!0}});var z=r(E,2);{var me=re=>{K(re,{get popupLabel(){return`Select all filtered pals (${s.pagination.totalCount??""})`},children:(Se,Ce)=>{var Re=$s();Re.__click=[Gt,s],n(Se,Re)},$$slots:{default:!0}})},ue=re=>{K(re,{get popupLabel(){return`Select all pals in UPS (${s.pagination.totalCount??""})`},children:(Se,Ce)=>{var Re=Ps();Re.__click=[Gt,s],n(Se,Re)},$$slots:{default:!0}})};y(z,re=>{$e()?re(me):re(ue,!1)})}e(A);var pe=r(A,2);{var Oe=re=>{var Se=Ss(),Ce=r(he(Se),2);Ce.__click=[Zr,s],n(re,Se)};y(pe,re=>{s.hasSelectedPals&&re(Oe)})}e(F),e(h);var Le=r(h,2),Be=a(Le);e(Le),e(c),C(()=>{m(k,`${s.selectedPals.size??""} of ${(s.selectedPals.size<=s.pals.length?s.pals.length:s.pagination.totalCount)??""} selected`),m(Be,`Page ${t(W)??""} of ${t(Y)??""}`)}),n(o,c)};y(ae,o=>{s.pals.length>0&&o(se)})}var ge=r(ae,2),ye=a(ge);{var we=o=>{var c=Cs();n(o,c)},Ke=o=>{var c=De(),h=he(c);{var _=F=>{var A=As(),E=a(A);Lt(E,{class:"text-surface-400 mb-4 h-16 w-16"});var z=r(E,6),me=a(z);me.__click=de;var ue=a(me);yt(ue,{class:"h-4 w-4"}),vt(),e(me);var pe=r(me,2);{var Oe=Le=>{var Be=Ms();Be.__click=T;var re=a(Be);xt(re,{class:"h-4 w-4"}),vt(),e(Be),n(Le,Be)};y(pe,Le=>{b.saveFile&&Le(Oe)})}e(z),e(A),n(F,A)},k=F=>{var A=De(),E=he(A);{var z=ue=>{Ha(ue,{})},me=ue=>{Rr(ue,{})};y(E,ue=>{s.viewMode==="grid"?ue(z):ue(me,!1)})}n(F,A)};y(h,F=>{s.pals.length===0?F(_):F(k,!1)},!0)}n(o,c)};y(ye,o=>{s.loading?o(we):o(Ke,!1)})}e(ge);var Ve=r(ge,2);{var We=o=>{var c=Ns(),h=a(c),_=a(h),k=a(_);e(_);var F=r(_,2),A=a(F);A.__click=[Ls,D];var E=a(A);Ot(E,{class:"h-4 w-4 rotate-90"}),e(A);var z=r(A,2);z.__click=[Is,D,W];var me=a(z);Ta(me,{class:"h-4 w-4 rotate-90"}),e(z);var ue=r(z,2);Ge(ue,17,()=>t(oe),nt,(re,Se)=>{var Ce=Es();Ce.__click=[Fs,D,Se];var Re=a(Ce,!0);e(Ce),C(ht=>{Ee(Ce,1,ht,"svelte-16lfksc"),m(Re,t(Se))},[()=>qe(Ze("rounded px-3 py-1 text-sm",t(Se)===t(W)?"bg-primary-500 text-white":"hover:bg-surface-200 dark:hover:bg-surface-800"))]),n(re,Ce)});var pe=r(ue,2);pe.__click=[zs,D,W];var Oe=a(pe);Ca(Oe,{class:"h-4 w-4 -rotate-90"}),e(pe);var Le=r(pe,2);Le.__click=[Ds,D,Y];var Be=a(Le);Vt(Be,{class:"h-4 w-4 -rotate-90"}),e(Le),e(F),e(h),e(c),C(re=>{m(k,`Showing ${(t(W)-1)*s.pagination.limit+1} to ${re??""} of ${s.pagination.totalCount??""} pals`),A.disabled=t(W)===1,z.disabled=t(W)===1,pe.disabled=t(W)===t(Y),Le.disabled=t(W)===t(Y)},[()=>Math.min(t(W)*s.pagination.limit,s.pagination.totalCount)]),n(o,c)};y(Ve,o=>{t(Y)>1&&o(We)})}e(tt),e(Ue),e(te),C(()=>m(H,`${s.pagination.totalCount??""} pals in storage`)),n(u,te),rt()}pt(["click"]);export{Hs as component};
